Profiling model_size=small context_size=128
device set to CUDA
MACHINE hpc
RUNNING SIZE small, CONTEXT_SIZE: 128
TRINING LOOP WITH:
vocab size 10000 context length 128
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x14ef60d29ee0>, {'FORWARD_PASS_TIME': [0.04581684500000449, 0.04533333999999911, 0.046175934000004304, 0.04540858000000014, 0.0459737899999908, 0.04618380600000194, 0.04670696699999155, 0.04652353499999151, 0.049201725000003194, 0.046931075000003375], 'BACKWARD_PASS_TIME': [0.05744339700000012, 0.05758525900000677, 0.060209331000010025, 0.057809172000006015, 0.05795125599999551, 0.05745711199999448, 0.05763360299999931, 0.057349554000012404, 0.05958554100000413, 0.057828538000009644]})
Collecting data...
Generating '/tmp/nsys-report-3981.qdstrm'
[1/7] [0%                          ] auto_small_128.nsys-rep[1/7] [0%                          ] auto_small_128.nsys-rep[1/7] [=15%                        ] auto_small_128.nsys-rep[1/7] [14%                         ] auto_small_128.nsys-rep[1/7] [13%                         ] auto_small_128.nsys-rep[1/7] [14%                         ] auto_small_128.nsys-rep[1/7] [==18%                       ] auto_small_128.nsys-rep[1/7] [==21%                       ] auto_small_128.nsys-rep[1/7] [====26%                     ] auto_small_128.nsys-rep[1/7] [=====31%                    ] auto_small_128.nsys-rep[1/7] [======35%                   ] auto_small_128.nsys-rep[1/7] [========40%                 ] auto_small_128.nsys-rep[1/7] [=========44%                ] auto_small_128.nsys-rep[1/7] [==========49%               ] auto_small_128.nsys-rep[1/7] [===========50%              ] auto_small_128.nsys-rep[1/7] [===========51%              ] auto_small_128.nsys-rep[1/7] [===========52%              ] auto_small_128.nsys-rep[1/7] [===========53%              ] auto_small_128.nsys-rep[1/7] [============54%             ] auto_small_128.nsys-rep[1/7] [============55%             ] auto_small_128.nsys-rep[1/7] [============57%             ] auto_small_128.nsys-rep[1/7] [=============58%            ] auto_small_128.nsys-rep[1/7] [=============59%            ] auto_small_128.nsys-rep[1/7] [=============60%            ] auto_small_128.nsys-rep[1/7] [==============61%           ] auto_small_128.nsys-rep[1/7] [==============63%           ] auto_small_128.nsys-rep[1/7] [==============64%           ] auto_small_128.nsys-rep[1/7] [========================100%] auto_small_128.nsys-rep[1/7] [========================100%] auto_small_128.nsys-rep
[2/7] [0%                          ] auto_small_128.sqlite[2/7] [1%                          ] auto_small_128.sqlite[2/7] [2%                          ] auto_small_128.sqlite[2/7] [3%                          ] auto_small_128.sqlite[2/7] [4%                          ] auto_small_128.sqlite[2/7] [5%                          ] auto_small_128.sqlite[2/7] [6%                          ] auto_small_128.sqlite[2/7] [7%                          ] auto_small_128.sqlite[2/7] [8%                          ] auto_small_128.sqlite[2/7] [9%                          ] auto_small_128.sqlite[2/7] [10%                         ] auto_small_128.sqlite[2/7] [11%                         ] auto_small_128.sqlite[2/7] [12%                         ] auto_small_128.sqlite[2/7] [13%                         ] auto_small_128.sqlite[2/7] [14%                         ] auto_small_128.sqlite[2/7] [=15%                        ] auto_small_128.sqlite[2/7] [=16%                        ] auto_small_128.sqlite[2/7] [=17%                        ] auto_small_128.sqlite[2/7] [==18%                       ] auto_small_128.sqlite[2/7] [==19%                       ] auto_small_128.sqlite[2/7] [==20%                       ] auto_small_128.sqlite[2/7] [==21%                       ] auto_small_128.sqlite[2/7] [===22%                      ] auto_small_128.sqlite[2/7] [===23%                      ] auto_small_128.sqlite[2/7] [===24%                      ] auto_small_128.sqlite[2/7] [====25%                     ] auto_small_128.sqlite[2/7] [====26%                     ] auto_small_128.sqlite[2/7] [====27%                     ] auto_small_128.sqlite[2/7] [====28%                     ] auto_small_128.sqlite[2/7] [=====29%                    ] auto_small_128.sqlite[2/7] [=====30%                    ] auto_small_128.sqlite[2/7] [=====31%                    ] auto_small_128.sqlite[2/7] [=====32%                    ] auto_small_128.sqlite[2/7] [======33%                   ] auto_small_128.sqlite[2/7] [======34%                   ] auto_small_128.sqlite[2/7] [======35%                   ] auto_small_128.sqlite[2/7] [=======36%                  ] auto_small_128.sqlite[2/7] [=======37%                  ] auto_small_128.sqlite[2/7] [=======38%                  ] auto_small_128.sqlite[2/7] [=======39%                  ] auto_small_128.sqlite[2/7] [========40%                 ] auto_small_128.sqlite[2/7] [========41%                 ] auto_small_128.sqlite[2/7] [========42%                 ] auto_small_128.sqlite[2/7] [=========43%                ] auto_small_128.sqlite[2/7] [=========44%                ] auto_small_128.sqlite[2/7] [=========45%                ] auto_small_128.sqlite[2/7] [=========46%                ] auto_small_128.sqlite[2/7] [==========47%               ] auto_small_128.sqlite[2/7] [==========48%               ] auto_small_128.sqlite[2/7] [==========49%               ] auto_small_128.sqlite[2/7] [===========50%              ] auto_small_128.sqlite[2/7] [===========51%              ] auto_small_128.sqlite[2/7] [===========52%              ] auto_small_128.sqlite[2/7] [===========53%              ] auto_small_128.sqlite[2/7] [============54%             ] auto_small_128.sqlite[2/7] [============55%             ] auto_small_128.sqlite[2/7] [============56%             ] auto_small_128.sqlite[2/7] [============57%             ] auto_small_128.sqlite[2/7] [=============58%            ] auto_small_128.sqlite[2/7] [=============59%            ] auto_small_128.sqlite[2/7] [=============60%            ] auto_small_128.sqlite[2/7] [==============61%           ] auto_small_128.sqlite[2/7] [==============62%           ] auto_small_128.sqlite[2/7] [==============63%           ] auto_small_128.sqlite[2/7] [==============64%           ] auto_small_128.sqlite[2/7] [===============65%          ] auto_small_128.sqlite[2/7] [===============66%          ] auto_small_128.sqlite[2/7] [===============67%          ] auto_small_128.sqlite[2/7] [================68%         ] auto_small_128.sqlite[2/7] [================69%         ] auto_small_128.sqlite[2/7] [================70%         ] auto_small_128.sqlite[2/7] [================71%         ] auto_small_128.sqlite[2/7] [=================72%        ] auto_small_128.sqlite[2/7] [=================73%        ] auto_small_128.sqlite[2/7] [=================74%        ] auto_small_128.sqlite[2/7] [==================75%       ] auto_small_128.sqlite[2/7] [==================76%       ] auto_small_128.sqlite[2/7] [==================77%       ] auto_small_128.sqlite[2/7] [==================78%       ] auto_small_128.sqlite[2/7] [===================79%      ] auto_small_128.sqlite[2/7] [===================80%      ] auto_small_128.sqlite[2/7] [===================81%      ] auto_small_128.sqlite[2/7] [===================82%      ] auto_small_128.sqlite[2/7] [====================83%     ] auto_small_128.sqlite[2/7] [====================84%     ] auto_small_128.sqlite[2/7] [====================85%     ] auto_small_128.sqlite[2/7] [=====================86%    ] auto_small_128.sqlite[2/7] [=====================87%    ] auto_small_128.sqlite[2/7] [=====================88%    ] auto_small_128.sqlite[2/7] [=====================89%    ] auto_small_128.sqlite[2/7] [======================90%   ] auto_small_128.sqlite[2/7] [======================91%   ] auto_small_128.sqlite[2/7] [======================92%   ] auto_small_128.sqlite[2/7] [=======================93%  ] auto_small_128.sqlite[2/7] [=======================94%  ] auto_small_128.sqlite[2/7] [=======================95%  ] auto_small_128.sqlite[2/7] [=======================96%  ] auto_small_128.sqlite[2/7] [========================97% ] auto_small_128.sqlite[2/7] [========================98% ] auto_small_128.sqlite[2/7] [========================99% ] auto_small_128.sqlite[2/7] [========================100%] auto_small_128.sqlite[2/7] [========================100%] auto_small_128.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     66.6       2779415875          1  2779415875.0  2779415875.0  2779415875  2779415875          0.0  PushPop  :WARM_UP       
     13.9        579977247         10    57997724.7    57626227.5    57274911    60125660     979163.7  PushPop  :BACKWARD_PASS 
     11.1        463134333         10    46313433.3    46070809.5    45220005    49090777    1105815.0  PushPop  :FORWARD_PASS  
      8.5        353583879         10    35358387.9    35329122.5    35128763    35680001     166358.0  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     85.4       1398823955      58140    24059.6     6177.0      4531  94994767     869193.2  cudaLaunchKernel        
      7.3        119761957        517   231647.9    16949.0      6210   6600973     656757.1  cudaMemcpyAsync         
      2.6         42566641       4905     8678.2     7883.0      5144    469672       7361.5  cuLaunchKernel          
      1.2         19250604        124   155246.8   147740.0      8422    348320      44668.7  cudaMalloc              
      0.9         15206748          4  3801687.0  4562735.5   1277274   4804003    1687844.7  cuLibraryLoadData       
      0.6         10574779       4905     2155.9      955.0       433   4592587      65728.6  cuKernelGetFunction     
      0.5          8195604          2  4097802.0  4097802.0      2341   8193263    5791856.5  cudaFree                
      0.4          6638360          1  6638360.0  6638360.0   6638360   6638360          0.0  cudaGetDeviceProperties 
      0.4          6325778        127    49809.3    54850.0      8115     96533      31397.8  cudaStreamSynchronize   
      0.3          5432523       1305     4162.9     3775.0      3175     36290       1939.0  cudaMemsetAsync         
      0.1          1707622        810     2108.2      212.0       136   1430719      50288.3  cuGetProcAddress_v2     
      0.1          1547461         36    42985.0      509.0       482   1505911     250791.5  cudaEventCreateWithFlags
      0.1          1206725          1  1206725.0  1206725.0   1206725   1206725          0.0  cudaHostAlloc           
      0.0           636806         20    31840.3    24723.0     12379     65091      19181.6  cudaDeviceSynchronize   
      0.0           338694        178     1902.8     1426.0       430     16938       1918.1  cudaStreamIsCapturing   
      0.0            37612         18     2089.6     1522.0       711     10743       2272.7  cuLibraryGetKernel      
      0.0            12021          3     4007.0      209.0       186     11626       6598.3  cuModuleGetLoadingMode  
      0.0             7586          3     2528.7     2463.0      2137      2986        428.3  cuInit                  
      0.0             1800          2      900.0      900.0       609      1191        411.5  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     14.1         76172676      10755    7082.5    5152.0      1887     49248       6787.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
     13.5         72572318      11775    6163.3    4320.0      1855     74815       7914.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      8.5         45972630       3435   13383.6    6144.0      5440    130048      14119.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      8.5         45572621       6060    7520.2    6368.0      3040     51808       4926.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.1         27313352       3705    7372.0    5088.0      1888     49728       6890.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      4.3         23030235       2625    8773.4    8672.0      3680     34528       3737.9  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.9         21074841       2940    7168.3    5056.0      1920     17472       4346.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.4         18067566       3945    4579.9    3584.0      1664     23232       3463.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      3.0         16218199        360   45050.6   45088.0     44479     45792        298.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nt_align4>(T1::Params)             
      2.8         14913058       1680    8876.8    4704.0      2144     76032      10317.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.7         14765983        375   39376.0   35040.0     33760    148991      22288.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      2.5         13673211        360   37981.1   38144.0     37184     39360        471.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_32x3_tn_align4>(T1::Params)              
      2.5         13479102        720   18721.0   18720.0     18272     19296        197.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_nt_align4>(T1::Params)              
      2.4         13065788        720   18146.9   18144.0     17728     18656        174.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_32x6_nn_align4>(T1::Params)               
      2.3         12386612        720   17203.6   17184.0     16672     17984        232.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_32x6_tn_align4>(T1::Params)               
      2.2         11710729       1680    6970.7    4128.0      2080     49248       6847.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      2.0         10849338       2070    5241.2    3872.0      1888     49184       5836.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.5          8220095        180   45667.2   45632.0     45024     46719        351.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      1.4          7685255        375   20494.0   20512.0     19264     20864        146.3  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      1.3          6910852        180   38393.6   38368.0     37920     39072        195.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x128_32x6_tn_align4>(T1::Params)              
      1.2          6649543        720    9235.5    9247.5      7392     11328       1126.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      1.2          6212801        180   34515.6   34495.5     33920     35456        328.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_32x3_nn_align4>(T1::Params)              
      0.7          3680472        390    9437.1    7392.0      7232     36544       7115.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.7          3564053        540    6600.1    6623.5      6240      7424        225.3  void cublasLt::splitKreduce_kernel<(int)32, (int)16, int, float, float, float, float, (bool)1, (boo…
      0.6          3176308        360    8823.1    8832.0      8384      9696        238.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.6          3148875        360    8746.9    8768.0      8415      9280        222.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_tn_align4>(T1::Params)               
      0.6          3132847        360    8702.4    8608.0      8256      9856        322.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.6          2997044        360    8325.1    8352.0      7935      9376        270.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.5          2961807        390    7594.4    7712.0      4704      7872        562.7  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.5          2932919        420    6983.1    4704.0      4320     24576       5792.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.5          2730006        195   14000.0   12640.0     11936     31168       4797.9  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.5          2687417        375    7166.4    7168.0      6464     10880        894.8  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.4          2040468        180   11335.9   11328.0     11168     11584         80.6  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.4          2031829        390    5209.8    5311.0      2752      5536        454.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          1777656         15  118510.4  118431.0    117440    119424        546.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      0.3          1744823         15  116321.5  116351.0    115680    116767        317.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_nt_align4>(T1::Params)              
      0.3          1708661        360    4746.3    4736.0      4544      5120        121.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.3          1684023        360    4677.8    4688.0      4544      4832         85.5  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          1584793        180    8804.4    8800.0      8288      9664        215.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.3          1474201        195    7560.0    7552.0      6176      8224        359.7  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.2          1310972        180    7283.2    7264.0      6976      7648        115.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.2          1233750        195    6326.9    4928.0      4736     23904       4873.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.2          1178296        180    6546.1    6528.0      6432      6816         61.5  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1           797468        375    2126.6    2144.0      1984      2176         46.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.1           782395        375    2086.4    2080.0      1920      2144         41.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.1           781471        180    4341.5    4352.0      4160      4448         66.3  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           717407        375    1913.1    1920.0      1791      2496         96.4  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           170335         15   11355.7   11360.0     11264     11424         48.2  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           118463         15    7897.5    7968.0      7391      8416        305.9  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           107744         15    7182.9    7104.0      6784      8384        426.7  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           101728         30    3390.9    3408.0      3168      3616        100.7  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            76766         15    5117.7    5056.0      4928      5376        137.6  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            55359         15    3690.6    3743.0      3488      3840        122.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            42912         15    2860.8    2848.0      2688      2976         72.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            41536         15    2769.1    2816.0      2528      3008        148.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            41216         15    2747.7    2752.0      2720      2848         31.7  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            39936         15    2662.4    2688.0      2464      2944        157.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            35232         15    2348.8    2368.0      2240      2400         35.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     96.2         96714825    112  863525.2  344014.5      1504   6376194    1083124.4  [CUDA memcpy Host-to-Device]  
      2.0          2047896    390    5251.0    3584.0      3456     47679       8388.1  [CUDA memcpy Device-to-Device]
      1.8          1774324   1305    1359.6    1344.0      1280      2816         69.1  [CUDA memset]                 
      0.0            37760     15    2517.3    2208.0      2144      4576        743.2  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   1050.624    390     2.694     1.573     1.573    30.720        5.612  [CUDA memcpy Device-to-Device]
    514.534    112     4.594     2.359     0.003    30.720        5.196  [CUDA memcpy Host-to-Device]  
      0.007   1305     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_128.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_128.sqlite
SUCCESS: small_128
Profiling model_size=small context_size=256
device set to CUDA
MACHINE hpc
RUNNING SIZE small, CONTEXT_SIZE: 256
TRINING LOOP WITH:
vocab size 10000 context length 256
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x14f11fd13240>, {'FORWARD_PASS_TIME': [0.04603853800000479, 0.04650149799999781, 0.04678012700000522, 0.04704284600001074, 0.04628890300000421, 0.04681272900000977, 0.04670832100001121, 0.04598459900000762, 0.049760072999987415, 0.04790519799999515], 'BACKWARD_PASS_TIME': [0.05811580499999991, 0.05893046599999252, 0.05874023800001282, 0.058141003999992336, 0.05834913099999994, 0.058166188000001284, 0.05826206200001138, 0.05819154299999241, 0.06018804299998237, 0.059272464000002856]})
Collecting data...
Generating '/tmp/nsys-report-6d40.qdstrm'
[1/7] [0%                          ] auto_small_256.nsys-rep[1/7] [0%                          ] auto_small_256.nsys-rep[1/7] [0%                          ] auto_small_256.nsys-rep[1/7] [13%                         ] auto_small_256.nsys-rep[1/7] [11%                         ] auto_small_256.nsys-rep[1/7] [10%                         ] auto_small_256.nsys-rep[1/7] [9%                          ] auto_small_256.nsys-rep[1/7] [14%                         ] auto_small_256.nsys-rep[1/7] [=17%                        ] auto_small_256.nsys-rep[1/7] [===23%                      ] auto_small_256.nsys-rep[1/7] [====28%                     ] auto_small_256.nsys-rep[1/7] [======33%                   ] auto_small_256.nsys-rep[1/7] [=======38%                  ] auto_small_256.nsys-rep[1/7] [=========43%                ] auto_small_256.nsys-rep[1/7] [==========48%               ] auto_small_256.nsys-rep[1/7] [===========50%              ] auto_small_256.nsys-rep[1/7] [===========51%              ] auto_small_256.nsys-rep[1/7] [===========52%              ] auto_small_256.nsys-rep[1/7] [===========53%              ] auto_small_256.nsys-rep[1/7] [============54%             ] auto_small_256.nsys-rep[1/7] [============55%             ] auto_small_256.nsys-rep[1/7] [============57%             ] auto_small_256.nsys-rep[1/7] [=============58%            ] auto_small_256.nsys-rep[1/7] [=============59%            ] auto_small_256.nsys-rep[1/7] [========================100%] auto_small_256.nsys-rep[1/7] [========================100%] auto_small_256.nsys-rep
[2/7] [0%                          ] auto_small_256.sqlite[2/7] [1%                          ] auto_small_256.sqlite[2/7] [2%                          ] auto_small_256.sqlite[2/7] [3%                          ] auto_small_256.sqlite[2/7] [4%                          ] auto_small_256.sqlite[2/7] [5%                          ] auto_small_256.sqlite[2/7] [6%                          ] auto_small_256.sqlite[2/7] [7%                          ] auto_small_256.sqlite[2/7] [8%                          ] auto_small_256.sqlite[2/7] [9%                          ] auto_small_256.sqlite[2/7] [10%                         ] auto_small_256.sqlite[2/7] [11%                         ] auto_small_256.sqlite[2/7] [12%                         ] auto_small_256.sqlite[2/7] [13%                         ] auto_small_256.sqlite[2/7] [14%                         ] auto_small_256.sqlite[2/7] [=15%                        ] auto_small_256.sqlite[2/7] [=16%                        ] auto_small_256.sqlite[2/7] [=17%                        ] auto_small_256.sqlite[2/7] [==18%                       ] auto_small_256.sqlite[2/7] [==19%                       ] auto_small_256.sqlite[2/7] [==20%                       ] auto_small_256.sqlite[2/7] [==21%                       ] auto_small_256.sqlite[2/7] [===22%                      ] auto_small_256.sqlite[2/7] [===23%                      ] auto_small_256.sqlite[2/7] [===24%                      ] auto_small_256.sqlite[2/7] [====25%                     ] auto_small_256.sqlite[2/7] [====26%                     ] auto_small_256.sqlite[2/7] [====27%                     ] auto_small_256.sqlite[2/7] [====28%                     ] auto_small_256.sqlite[2/7] [=====29%                    ] auto_small_256.sqlite[2/7] [=====30%                    ] auto_small_256.sqlite[2/7] [=====31%                    ] auto_small_256.sqlite[2/7] [=====32%                    ] auto_small_256.sqlite[2/7] [======33%                   ] auto_small_256.sqlite[2/7] [======34%                   ] auto_small_256.sqlite[2/7] [======35%                   ] auto_small_256.sqlite[2/7] [=======36%                  ] auto_small_256.sqlite[2/7] [=======37%                  ] auto_small_256.sqlite[2/7] [=======38%                  ] auto_small_256.sqlite[2/7] [=======39%                  ] auto_small_256.sqlite[2/7] [========40%                 ] auto_small_256.sqlite[2/7] [========41%                 ] auto_small_256.sqlite[2/7] [========42%                 ] auto_small_256.sqlite[2/7] [=========43%                ] auto_small_256.sqlite[2/7] [=========44%                ] auto_small_256.sqlite[2/7] [=========45%                ] auto_small_256.sqlite[2/7] [=========46%                ] auto_small_256.sqlite[2/7] [==========47%               ] auto_small_256.sqlite[2/7] [==========48%               ] auto_small_256.sqlite[2/7] [==========49%               ] auto_small_256.sqlite[2/7] [===========50%              ] auto_small_256.sqlite[2/7] [===========51%              ] auto_small_256.sqlite[2/7] [===========52%              ] auto_small_256.sqlite[2/7] [===========53%              ] auto_small_256.sqlite[2/7] [============54%             ] auto_small_256.sqlite[2/7] [============55%             ] auto_small_256.sqlite[2/7] [============56%             ] auto_small_256.sqlite[2/7] [============57%             ] auto_small_256.sqlite[2/7] [=============58%            ] auto_small_256.sqlite[2/7] [=============59%            ] auto_small_256.sqlite[2/7] [=============60%            ] auto_small_256.sqlite[2/7] [==============61%           ] auto_small_256.sqlite[2/7] [==============62%           ] auto_small_256.sqlite[2/7] [==============63%           ] auto_small_256.sqlite[2/7] [==============64%           ] auto_small_256.sqlite[2/7] [===============65%          ] auto_small_256.sqlite[2/7] [===============66%          ] auto_small_256.sqlite[2/7] [===============67%          ] auto_small_256.sqlite[2/7] [================68%         ] auto_small_256.sqlite[2/7] [================69%         ] auto_small_256.sqlite[2/7] [================70%         ] auto_small_256.sqlite[2/7] [================71%         ] auto_small_256.sqlite[2/7] [=================72%        ] auto_small_256.sqlite[2/7] [=================73%        ] auto_small_256.sqlite[2/7] [=================74%        ] auto_small_256.sqlite[2/7] [==================75%       ] auto_small_256.sqlite[2/7] [==================76%       ] auto_small_256.sqlite[2/7] [==================77%       ] auto_small_256.sqlite[2/7] [==================78%       ] auto_small_256.sqlite[2/7] [===================79%      ] auto_small_256.sqlite[2/7] [===================80%      ] auto_small_256.sqlite[2/7] [===================81%      ] auto_small_256.sqlite[2/7] [===================82%      ] auto_small_256.sqlite[2/7] [====================83%     ] auto_small_256.sqlite[2/7] [====================84%     ] auto_small_256.sqlite[2/7] [====================85%     ] auto_small_256.sqlite[2/7] [=====================86%    ] auto_small_256.sqlite[2/7] [=====================87%    ] auto_small_256.sqlite[2/7] [=====================88%    ] auto_small_256.sqlite[2/7] [=====================89%    ] auto_small_256.sqlite[2/7] [======================90%   ] auto_small_256.sqlite[2/7] [======================91%   ] auto_small_256.sqlite[2/7] [======================92%   ] auto_small_256.sqlite[2/7] [=======================93%  ] auto_small_256.sqlite[2/7] [=======================94%  ] auto_small_256.sqlite[2/7] [=======================95%  ] auto_small_256.sqlite[2/7] [=======================96%  ] auto_small_256.sqlite[2/7] [========================97% ] auto_small_256.sqlite[2/7] [========================98% ] auto_small_256.sqlite[2/7] [========================99% ] auto_small_256.sqlite[2/7] [========================100%] auto_small_256.sqlite[2/7] [========================100%] auto_small_256.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     52.5       1549253118          1  1549253118.0  1549253118.0  1549253118  1549253118          0.0  PushPop  :WARM_UP       
     19.8        585488131         10    58548813.1    58229351.0    58019297    60068561     662467.3  PushPop  :BACKWARD_PASS 
     15.9        468115041         10    46811504.1    46572180.5    45816716    49592275    1120846.8  PushPop  :FORWARD_PASS  
     11.8        348152475         10    34815247.5    34851711.5    34512538    35004153     166383.0  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     74.4        715712508      57600    12425.6     6057.0      4624  61962899     349173.8  cudaLaunchKernel        
     12.5        120032960        517   232172.1    16309.0      6188   6614258     660690.6  cudaMemcpyAsync         
      4.5         43027626       4905     8772.2     7656.0      5282     43336       3545.2  cuLaunchKernel          
      2.9         28245688        215   131375.3   130797.0      5875    277090      30248.4  cudaMalloc              
      1.7         16234551       2760     5882.1     6133.5      3231     30307       2612.8  cudaMemsetAsync         
      1.6         15063706          4  3765926.5  4538298.0   1237449   4749661    1691019.4  cuLibraryLoadData       
      1.1         10451791       4905     2130.8      935.0       433   4500837      64435.9  cuKernelGetFunction     
      0.7          6281061        127    49457.2    54642.0      8170     92377      31423.4  cudaStreamSynchronize   
      0.3          2662195          2  1331097.5  1331097.5      2514   2659681    1878900.8  cudaFree                
      0.2          1449637          1  1449637.0  1449637.0   1449637   1449637          0.0  cudaGetDeviceProperties 
      0.1          1249529          1  1249529.0  1249529.0   1249529   1249529          0.0  cudaHostAlloc           
      0.1          1204879         20    60243.9    39155.5     12785    120065      48992.5  cudaDeviceSynchronize   
      0.1           533619        269     1983.7     1771.0       465     47399       2985.3  cudaStreamIsCapturing   
      0.0           207533        810      256.2      214.0       136     10508        375.8  cuGetProcAddress_v2     
      0.0            55490         36     1541.4      505.0       464     12993       2571.8  cudaEventCreateWithFlags
      0.0            52806         19     2779.3     1404.0       606     11401       3786.0  cuLibraryGetKernel      
      0.0             7312          3     2437.3     2414.0      1773      3125        676.3  cuInit                  
      0.0             4645          3     1548.3      251.0       224      4170       2270.5  cuModuleGetLoadingMode  
      0.0             1547          2      773.5      773.5       582       965        270.8  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     11.3         81417817      11775    6914.5    4384.0      1824     95072       8967.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     10.6         76925387      10755    7152.5    5152.0      1888     48576       6812.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      7.7         55609149       6060    9176.4    8032.0      3008     65344       5242.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      7.1         51206927       3435   14907.4    8512.0      7104    131391      13488.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.9         42465340       2940   14444.0    7040.0      1920     30400      10236.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      5.0         36082167        720   50114.1   50015.5     48416     52960        703.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_nt_align4>(T1::Params)              
      3.9         28125663        360   78126.8   78144.0     77535     79136        279.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nt_align4>(T1::Params)             
      3.9         28109176       2625   10708.3    9344.0      3680     50815       6738.1  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.8         27761466       3705    7493.0    5088.0      1887     49088       6849.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      3.7         26953440        360   74870.7   74815.0     73759     76352        367.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      3.1         22066247        360   61295.1   61215.0     60159     63231        451.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_tn_align4>(T1::Params)             
      2.7         19474655       3945    4936.5    3552.0      1664     28448       3972.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      2.6         18869535        720   26207.7   25696.0     24192     29471       1670.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.5         17762758        720   24670.5   24704.0     24032     25216        184.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_nn_align4>(T1::Params)              
      2.4         17093334        720   23740.7   23776.0     23072     24928        380.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_tn_align4>(T1::Params)              
      2.1         14867777       1680    8849.9    4672.0      2240     76256      10297.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      1.9         13943223        180   77462.4   77440.0     76863     78143        234.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nt_align4>(T1::Params)             
      1.7         12111141        180   67284.1   67215.5     66815     68127        292.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x128_32x6_tn_align4>(T1::Params)              
      1.6         11710092       1680    6970.3    4128.0      2080     50240       6858.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      1.5         10873330       2070    5252.8    3872.0      1888     48704       5849.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.5         10746064        180   59700.4   59712.0     58912     60672        329.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nn_align4>(T1::Params)             
      1.3          9420081        420   22428.8   20032.0     11168     62656      16118.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      1.3          9040053        390   23179.6   20928.0     17536     66911      12261.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      1.0          7568252        360   21022.9   21056.0     19935     22080        426.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_tn_align4>(T1::Params)              
      1.0          7437790        360   20660.5   20608.0     20256     21408        215.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.9          6270180        360   17417.2   17135.5     14528     21280       2534.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.7          5374691        180   29859.4   29856.0     29343     30400        199.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.7          5224107        360   14511.4   14528.0     13888     15232        280.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.7          4988037        195   25579.7   23264.0     22464     54719       8018.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.7          4899853        375   13066.3   13024.0     12256     13760        234.9  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.6          4105897        360   11405.3   11392.0     10880     12192        269.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.4          3089745         15  205983.0  205951.0    205311    207295        558.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x256_32x4_nn_align4>(T1::Params)              
      0.4          3012823        195   15450.4   11872.0     11296     59392      12378.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.4          2978224        390    7636.5    7680.0      4832      8032        557.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.4          2967734        375    7914.0    8000.0      6783     16896       1888.5  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.4          2911249         15  194083.3  193983.0    193663    194655        314.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      0.4          2767732        180   15376.3   15360.0     15168     15776        102.7  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.4          2667474         15  177831.6  177823.0    177439    178431        303.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      0.4          2542353        390    6518.9    6624.0      3392      6752        606.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          2222683        180   12348.2   12320.0     11840     13568        292.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.3          2045338        360    5681.5    5616.0      5216      6368        402.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          1581690        195    8111.2    8096.0      7487      9056        203.8  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.2          1571033        180    8728.0    8704.0      8608      8960         63.9  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1           921627        180    5120.1    5103.5      4864      5280         76.5  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           839960        375    2239.9    2240.0      2144      2496         41.3  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.1           802299        375    2139.5    2144.0      1984      2176         30.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.1           790879        375    2109.0    2112.0      1952      2208         40.9  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0           179391         15   11959.4   11967.0     11872     12064         54.7  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           157632         15   10508.8   10400.0     10048     11104        306.6  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           135392         15    9026.1    8992.0      8128      9728        441.3  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           114400         15    7626.7    7552.0      7008      8352        420.8  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           106239         30    3541.3    3520.0      3328      3744         97.7  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            55646         15    3709.7    3680.0      3616      3840         77.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            44063         15    2937.5    2912.0      2720      3360        152.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            43486         15    2899.1    2912.0      2688      2976         75.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            41120         15    2741.3    2752.0      2624      2848         52.3  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            40800         15    2720.0    2688.0      2464      2880        105.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            35200         15    2346.7    2368.0      2208      2400         55.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     93.9         97375863    112  869427.3  341214.5      1504   6420194    1091485.1  [CUDA memcpy Host-to-Device]  
      3.7          3794252   2760    1374.7    1376.0      1280      2720         81.5  [CUDA memset]                 
      2.4          2473141    390    6341.4    4704.0      4352     48160       8175.2  [CUDA memcpy Device-to-Device]
      0.0            40128     15    2675.2    2208.0      2144      4608        990.7  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   1640.448    390     4.206     3.146     3.146    30.720        5.310  [CUDA memcpy Device-to-Device]
    514.567    112     4.594     2.359     0.003    30.720        5.196  [CUDA memcpy Host-to-Device]  
      0.190   2760     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_256.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_256.sqlite
SUCCESS: small_256
Profiling model_size=small context_size=512
device set to CUDA
MACHINE hpc
RUNNING SIZE small, CONTEXT_SIZE: 512
TRINING LOOP WITH:
vocab size 10000 context length 512
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x14cf6cd3b240>, {'FORWARD_PASS_TIME': [0.045586167999999816, 0.04554390300000932, 0.04624640199997998, 0.04604424100000415, 0.045839545000006865, 0.04531241299997646, 0.04543116800002167, 0.04535322300000644, 0.04926605999997946, 0.04651624800001741], 'BACKWARD_PASS_TIME': [0.059022542000008116, 0.058211693999993486, 0.058423085999976365, 0.05837421699999368, 0.05840874800000506, 0.05839691899998911, 0.058436431000018274, 0.058684064999994234, 0.07244061099999044, 0.0590993930000252]})
Collecting data...
Generating '/tmp/nsys-report-e38a.qdstrm'
[1/7] [0%                          ] auto_small_512.nsys-rep[1/7] [0%                          ] auto_small_512.nsys-rep[1/7] [0%                          ] auto_small_512.nsys-rep[1/7] [13%                         ] auto_small_512.nsys-rep[1/7] [11%                         ] auto_small_512.nsys-rep[1/7] [10%                         ] auto_small_512.nsys-rep[1/7] [9%                          ] auto_small_512.nsys-rep[1/7] [8%                          ] auto_small_512.nsys-rep[1/7] [13%                         ] auto_small_512.nsys-rep[1/7] [=17%                        ] auto_small_512.nsys-rep[1/7] [===22%                      ] auto_small_512.nsys-rep[1/7] [====27%                     ] auto_small_512.nsys-rep[1/7] [======33%                   ] auto_small_512.nsys-rep[1/7] [=======38%                  ] auto_small_512.nsys-rep[1/7] [=========43%                ] auto_small_512.nsys-rep[1/7] [==========48%               ] auto_small_512.nsys-rep[1/7] [===========50%              ] auto_small_512.nsys-rep[1/7] [===========51%              ] auto_small_512.nsys-rep[1/7] [===========52%              ] auto_small_512.nsys-rep[1/7] [===========53%              ] auto_small_512.nsys-rep[1/7] [============54%             ] auto_small_512.nsys-rep[1/7] [============55%             ] auto_small_512.nsys-rep[1/7] [============56%             ] auto_small_512.nsys-rep[1/7] [=============58%            ] auto_small_512.nsys-rep[1/7] [========================100%] auto_small_512.nsys-rep[1/7] [========================100%] auto_small_512.nsys-rep
[2/7] [0%                          ] auto_small_512.sqlite[2/7] [1%                          ] auto_small_512.sqlite[2/7] [2%                          ] auto_small_512.sqlite[2/7] [3%                          ] auto_small_512.sqlite[2/7] [4%                          ] auto_small_512.sqlite[2/7] [5%                          ] auto_small_512.sqlite[2/7] [6%                          ] auto_small_512.sqlite[2/7] [7%                          ] auto_small_512.sqlite[2/7] [8%                          ] auto_small_512.sqlite[2/7] [9%                          ] auto_small_512.sqlite[2/7] [10%                         ] auto_small_512.sqlite[2/7] [11%                         ] auto_small_512.sqlite[2/7] [12%                         ] auto_small_512.sqlite[2/7] [13%                         ] auto_small_512.sqlite[2/7] [14%                         ] auto_small_512.sqlite[2/7] [=15%                        ] auto_small_512.sqlite[2/7] [=16%                        ] auto_small_512.sqlite[2/7] [=17%                        ] auto_small_512.sqlite[2/7] [==18%                       ] auto_small_512.sqlite[2/7] [==19%                       ] auto_small_512.sqlite[2/7] [==20%                       ] auto_small_512.sqlite[2/7] [==21%                       ] auto_small_512.sqlite[2/7] [===22%                      ] auto_small_512.sqlite[2/7] [===23%                      ] auto_small_512.sqlite[2/7] [===24%                      ] auto_small_512.sqlite[2/7] [====25%                     ] auto_small_512.sqlite[2/7] [====26%                     ] auto_small_512.sqlite[2/7] [====27%                     ] auto_small_512.sqlite[2/7] [====28%                     ] auto_small_512.sqlite[2/7] [=====29%                    ] auto_small_512.sqlite[2/7] [=====30%                    ] auto_small_512.sqlite[2/7] [=====31%                    ] auto_small_512.sqlite[2/7] [=====32%                    ] auto_small_512.sqlite[2/7] [======33%                   ] auto_small_512.sqlite[2/7] [======34%                   ] auto_small_512.sqlite[2/7] [======35%                   ] auto_small_512.sqlite[2/7] [=======36%                  ] auto_small_512.sqlite[2/7] [=======37%                  ] auto_small_512.sqlite[2/7] [=======38%                  ] auto_small_512.sqlite[2/7] [=======39%                  ] auto_small_512.sqlite[2/7] [========40%                 ] auto_small_512.sqlite[2/7] [========41%                 ] auto_small_512.sqlite[2/7] [========42%                 ] auto_small_512.sqlite[2/7] [=========43%                ] auto_small_512.sqlite[2/7] [=========44%                ] auto_small_512.sqlite[2/7] [=========45%                ] auto_small_512.sqlite[2/7] [=========46%                ] auto_small_512.sqlite[2/7] [==========47%               ] auto_small_512.sqlite[2/7] [==========48%               ] auto_small_512.sqlite[2/7] [==========49%               ] auto_small_512.sqlite[2/7] [===========50%              ] auto_small_512.sqlite[2/7] [===========51%              ] auto_small_512.sqlite[2/7] [===========52%              ] auto_small_512.sqlite[2/7] [===========53%              ] auto_small_512.sqlite[2/7] [============54%             ] auto_small_512.sqlite[2/7] [============55%             ] auto_small_512.sqlite[2/7] [============56%             ] auto_small_512.sqlite[2/7] [============57%             ] auto_small_512.sqlite[2/7] [=============58%            ] auto_small_512.sqlite[2/7] [=============59%            ] auto_small_512.sqlite[2/7] [=============60%            ] auto_small_512.sqlite[2/7] [==============61%           ] auto_small_512.sqlite[2/7] [==============62%           ] auto_small_512.sqlite[2/7] [==============63%           ] auto_small_512.sqlite[2/7] [==============64%           ] auto_small_512.sqlite[2/7] [===============65%          ] auto_small_512.sqlite[2/7] [===============66%          ] auto_small_512.sqlite[2/7] [===============67%          ] auto_small_512.sqlite[2/7] [================68%         ] auto_small_512.sqlite[2/7] [================69%         ] auto_small_512.sqlite[2/7] [================70%         ] auto_small_512.sqlite[2/7] [================71%         ] auto_small_512.sqlite[2/7] [=================72%        ] auto_small_512.sqlite[2/7] [=================73%        ] auto_small_512.sqlite[2/7] [=================74%        ] auto_small_512.sqlite[2/7] [==================75%       ] auto_small_512.sqlite[2/7] [==================76%       ] auto_small_512.sqlite[2/7] [==================77%       ] auto_small_512.sqlite[2/7] [==================78%       ] auto_small_512.sqlite[2/7] [===================79%      ] auto_small_512.sqlite[2/7] [===================80%      ] auto_small_512.sqlite[2/7] [===================81%      ] auto_small_512.sqlite[2/7] [===================82%      ] auto_small_512.sqlite[2/7] [====================83%     ] auto_small_512.sqlite[2/7] [====================84%     ] auto_small_512.sqlite[2/7] [====================85%     ] auto_small_512.sqlite[2/7] [=====================86%    ] auto_small_512.sqlite[2/7] [=====================87%    ] auto_small_512.sqlite[2/7] [=====================88%    ] auto_small_512.sqlite[2/7] [=====================89%    ] auto_small_512.sqlite[2/7] [======================90%   ] auto_small_512.sqlite[2/7] [======================91%   ] auto_small_512.sqlite[2/7] [======================92%   ] auto_small_512.sqlite[2/7] [=======================93%  ] auto_small_512.sqlite[2/7] [=======================94%  ] auto_small_512.sqlite[2/7] [=======================95%  ] auto_small_512.sqlite[2/7] [=======================96%  ] auto_small_512.sqlite[2/7] [========================97% ] auto_small_512.sqlite[2/7] [========================98% ] auto_small_512.sqlite[2/7] [========================99% ] auto_small_512.sqlite[2/7] [========================100%] auto_small_512.sqlite[2/7] [========================100%] auto_small_512.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     52.4       1550433973          1  1550433973.0  1550433973.0  1550433973  1550433973          0.0  PushPop  :WARM_UP       
     20.2        598619406         10    59861940.6    58354029.5    58131392    72324695    4387975.1  PushPop  :BACKWARD_PASS 
     15.5        458514545         10    45851454.5    45446886.0    45051026    48999735    1176523.1  PushPop  :FORWARD_PASS  
     11.8        349031424         10    34903142.4    34852907.5    34646003    35301220     217577.2  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     74.9        727924732      58320    12481.6     5918.0      4586  62606649     354493.3  cudaLaunchKernel        
     12.4        120805387        517   233666.1    16262.0      6212   6743723     666597.5  cudaMemcpyAsync         
      4.3         41684835       4905     8498.4     7479.0      5116     46657       3466.9  cuLaunchKernel          
      2.8         27187442        170   159926.1   152633.0      6202    397686      43352.1  cudaMalloc              
      1.7         16506600          4  4126650.0  4935981.5   1277759   5356878    1913994.4  cuLibraryLoadData       
      1.3         12193583       2205     5530.0     3997.0      3162     34242       2802.7  cudaMemsetAsync         
      1.1         10477871       4905     2136.2      929.0       485   4709267      67381.9  cuKernelGetFunction     
      0.6          6255265        127    49254.1    54543.0      8324     95074      31313.3  cudaStreamSynchronize   
      0.3          2736669          2  1368334.5  1368334.5      2469   2734200    1931625.5  cudaFree                
      0.2          2142558         20   107127.9    92366.5     12333    212826      96229.9  cudaDeviceSynchronize   
      0.1          1434970          1  1434970.0  1434970.0   1434970   1434970          0.0  cudaGetDeviceProperties 
      0.1          1191169          1  1191169.0  1191169.0   1191169   1191169          0.0  cudaHostAlloc           
      0.0           429889        224     1919.1     1767.0       436     23412       1945.0  cudaStreamIsCapturing   
      0.0           199754        810      246.6      208.5       138      1222        118.2  cuGetProcAddress_v2     
      0.0            47622         36     1322.8      494.0       461     13070       2465.6  cudaEventCreateWithFlags
      0.0            31592         16     1974.5     1208.5       723     11157       2502.1  cuLibraryGetKernel      
      0.0             9006          3     3002.0     3134.0      2515      3357        436.2  cuInit                  
      0.0             4109          3     1369.7      190.0       181      3738       2051.0  cuModuleGetLoadingMode  
      0.0             2127          2     1063.5     1063.5       534      1593        748.8  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     10.6        114696955       2940   39012.6   12768.0      1856    119360      36869.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
     10.1        109936390      11775    9336.4    4512.0      1440    186239      18742.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      7.7         83401541      12420    6715.1    4544.0      1472     48992       6791.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      5.7         61484793        720   85395.5   85440.0     79648    100863       5072.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.1         55357985       1095   50555.2   27104.0     26080    324606      37966.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      4.6         50257246       3435   14630.9   10560.0      7872    126271      10213.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.5         48791236       2625   18587.1    7840.0      2880     84159      21137.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      4.4         47953799       4395   10911.0   10112.0      5536    128159       6929.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.4         36321592        360  100893.3   97280.0     96032    124383       8925.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      3.3         35736357        900   39707.1   27040.0     25984    108063      24307.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      3.1         33932692        360   94257.5   90527.0     89887    117471       8659.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      3.1         33199473        420   79046.4   72448.0     70559    122783      16845.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      2.7         29642846        390   76007.3   72415.0     69472    129855      13051.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.6         28422182        360   78950.5   77055.0     76352     91679       4793.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.5         26949200        360   74858.9   74831.5     72864     77759        712.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      2.4         25934709       3705    6999.9    4288.0      1472     48832       6842.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      2.3         25397042        720   35273.7   33952.0     33408     44351       3296.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      2.1         22452681        360   62368.6   63487.5     58688     69376       2717.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      1.9         21118041        360   58661.2   59856.0     54399     65280       3015.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      1.9         21014547       3945    5326.9    2816.0      1280     54944       7393.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.8         19387844        360   53855.1   53360.0     50176     63136       3042.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      1.7         18232347        180  101290.8   97535.5     96575    125504       9212.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nt_align4>(T1::Params)             
      1.6         17112481        180   95069.3   91359.0     90527    118271       8986.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      1.3         14603253        195   74888.5   71392.0     70560    117023      11994.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      1.3         13853937       1680    8246.4    3680.0      1664     75840      10446.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      1.2         12672032        195   64984.8   62432.0     60703     94720       6583.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      1.0         10752549        180   59736.4   59712.0     56575     61376        465.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.9         10166959       1680    6051.8    3232.0      1600     49536       6754.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      0.8          9164881       2070    4427.5    3040.0      1471     49344       5753.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.5          5735680        180   31864.9   31791.5     30432     34304        583.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.4          4710894        375   12562.4   12096.0     11840     15712       1129.3  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.4          4480231        720    6222.5    6080.0      5408      8096        628.9  void cublasLt::splitKreduce_kernel<(int)32, (int)16, int, float, float, float, float, (bool)1, (boo…
      0.4          4423717         15  294914.5  283358.0    283102    363582      27899.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      0.4          4255144         15  283676.3  272735.0    271678    351390      27253.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      0.3          3357329        180   18651.8   17952.0     17728     23296       1719.3  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.3          3029584        375    8078.9    7552.0      6304     23968       2606.4  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.3          2954574        390    7575.8    7456.0      2656      9759       1197.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          2714320        390    6959.8    6784.0      4096      8928        839.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2          2386417        360    6628.9    7151.0      5184      9343       1146.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          1868406        180   10380.0   10048.0      9728     12832        927.9  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.2          1773621        195    9095.5    8992.0      7648     10944        670.8  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1           853211        180    4740.1    4576.0      4416      5920        440.5  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           755518        375    2014.7    1952.0      1888      2528        185.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.1           746652        375    1991.1    1920.0      1792      2688        184.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.1           688602        375    1836.3    1760.0      1248      2656        210.7  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           217630         15   14508.7   14368.0     13952     16416        613.6  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           166206         15   11080.4   10656.0     10591     13728       1074.7  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           124895         15    8326.3    8160.0      7999     10240        546.1  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           114462         15    7630.8    7648.0      6816      8640        444.4  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            87807         30    2926.9    2848.0      2720      3616        249.0  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            47391         15    3159.4    3040.0      2976      3775        255.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            41824         15    2788.3    2720.0      2528      3360        232.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            39327         15    2621.8    2560.0      2464      3263        248.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34400         15    2293.3    2240.0      2048      2816        223.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            33632         15    2242.1    2176.0      2048      2752        204.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            28447         15    1896.5    1824.0      1728      2368        194.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     93.6         97940144    112  874465.6  341950.0      1504   6484317    1099018.0  [CUDA memcpy Host-to-Device]  
      4.0          4180496    390   10719.2    9472.0      5440     48352       7359.3  [CUDA memcpy Device-to-Device]
      2.4          2509623   2205    1138.2    1056.0       992      2720        209.1  [CUDA memset]                 
      0.0            34592     15    2306.1    1984.0      1824      4704        927.4  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   2820.096    390     7.231     6.291     6.291    30.720        4.704  [CUDA memcpy Device-to-Device]
    514.633    112     4.595     2.359     0.003    30.720        5.195  [CUDA memcpy Host-to-Device]  
      0.170   2205     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_512.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_512.sqlite
SUCCESS: small_512
Profiling model_size=small context_size=1024
device set to CUDA
MACHINE hpc
RUNNING SIZE small, CONTEXT_SIZE: 1024
TRINING LOOP WITH:
vocab size 10000 context length 1024
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x154a76f1b240>, {'FORWARD_PASS_TIME': [0.04814851399999043, 0.04795639899998605, 0.04830407600002218, 0.047959501999997656, 0.04792875000001118, 0.04799312900001951, 0.04793822700000305, 0.04794430100000113, 0.05002028100000189, 0.04890129300000012], 'BACKWARD_PASS_TIME': [0.10339178499998525, 0.10339952699999344, 0.10346932499999184, 0.10347270700000877, 0.10348761800000261, 0.10350174800001355, 0.10342884499999627, 0.10360489300001063, 0.10420543500001145, 0.10346926500000109]})
Collecting data...
Generating '/tmp/nsys-report-825b.qdstrm'
[1/7] [0%                          ] auto_small_1024.nsys-rep[1/7] [0%                          ] auto_small_1024.nsys-rep[1/7] [0%                          ] auto_small_1024.nsys-rep[1/7] [13%                         ] auto_small_1024.nsys-rep[1/7] [11%                         ] auto_small_1024.nsys-rep[1/7] [10%                         ] auto_small_1024.nsys-rep[1/7] [9%                          ] auto_small_1024.nsys-rep[1/7] [8%                          ] auto_small_1024.nsys-rep[1/7] [13%                         ] auto_small_1024.nsys-rep[1/7] [=17%                        ] auto_small_1024.nsys-rep[1/7] [===22%                      ] auto_small_1024.nsys-rep[1/7] [====27%                     ] auto_small_1024.nsys-rep[1/7] [=====32%                    ] auto_small_1024.nsys-rep[1/7] [=======38%                  ] auto_small_1024.nsys-rep[1/7] [=========43%                ] auto_small_1024.nsys-rep[1/7] [==========48%               ] auto_small_1024.nsys-rep[1/7] [===========50%              ] auto_small_1024.nsys-rep[1/7] [===========51%              ] auto_small_1024.nsys-rep[1/7] [===========52%              ] auto_small_1024.nsys-rep[1/7] [===========53%              ] auto_small_1024.nsys-rep[1/7] [============54%             ] auto_small_1024.nsys-rep[1/7] [============55%             ] auto_small_1024.nsys-rep[1/7] [============56%             ] auto_small_1024.nsys-rep[1/7] [============57%             ] auto_small_1024.nsys-rep[1/7] [=============58%            ] auto_small_1024.nsys-rep[1/7] [========================100%] auto_small_1024.nsys-rep[1/7] [========================100%] auto_small_1024.nsys-rep
[2/7] [0%                          ] auto_small_1024.sqlite[2/7] [1%                          ] auto_small_1024.sqlite[2/7] [2%                          ] auto_small_1024.sqlite[2/7] [3%                          ] auto_small_1024.sqlite[2/7] [4%                          ] auto_small_1024.sqlite[2/7] [5%                          ] auto_small_1024.sqlite[2/7] [6%                          ] auto_small_1024.sqlite[2/7] [7%                          ] auto_small_1024.sqlite[2/7] [8%                          ] auto_small_1024.sqlite[2/7] [9%                          ] auto_small_1024.sqlite[2/7] [10%                         ] auto_small_1024.sqlite[2/7] [11%                         ] auto_small_1024.sqlite[2/7] [12%                         ] auto_small_1024.sqlite[2/7] [13%                         ] auto_small_1024.sqlite[2/7] [14%                         ] auto_small_1024.sqlite[2/7] [=15%                        ] auto_small_1024.sqlite[2/7] [=16%                        ] auto_small_1024.sqlite[2/7] [=17%                        ] auto_small_1024.sqlite[2/7] [==18%                       ] auto_small_1024.sqlite[2/7] [==19%                       ] auto_small_1024.sqlite[2/7] [==20%                       ] auto_small_1024.sqlite[2/7] [==21%                       ] auto_small_1024.sqlite[2/7] [===22%                      ] auto_small_1024.sqlite[2/7] [===23%                      ] auto_small_1024.sqlite[2/7] [===24%                      ] auto_small_1024.sqlite[2/7] [====25%                     ] auto_small_1024.sqlite[2/7] [====26%                     ] auto_small_1024.sqlite[2/7] [====27%                     ] auto_small_1024.sqlite[2/7] [====28%                     ] auto_small_1024.sqlite[2/7] [=====29%                    ] auto_small_1024.sqlite[2/7] [=====30%                    ] auto_small_1024.sqlite[2/7] [=====31%                    ] auto_small_1024.sqlite[2/7] [=====32%                    ] auto_small_1024.sqlite[2/7] [======33%                   ] auto_small_1024.sqlite[2/7] [======34%                   ] auto_small_1024.sqlite[2/7] [======35%                   ] auto_small_1024.sqlite[2/7] [=======36%                  ] auto_small_1024.sqlite[2/7] [=======37%                  ] auto_small_1024.sqlite[2/7] [=======38%                  ] auto_small_1024.sqlite[2/7] [=======39%                  ] auto_small_1024.sqlite[2/7] [========40%                 ] auto_small_1024.sqlite[2/7] [========41%                 ] auto_small_1024.sqlite[2/7] [========42%                 ] auto_small_1024.sqlite[2/7] [=========43%                ] auto_small_1024.sqlite[2/7] [=========44%                ] auto_small_1024.sqlite[2/7] [=========45%                ] auto_small_1024.sqlite[2/7] [=========46%                ] auto_small_1024.sqlite[2/7] [==========47%               ] auto_small_1024.sqlite[2/7] [==========48%               ] auto_small_1024.sqlite[2/7] [==========49%               ] auto_small_1024.sqlite[2/7] [===========50%              ] auto_small_1024.sqlite[2/7] [===========51%              ] auto_small_1024.sqlite[2/7] [===========52%              ] auto_small_1024.sqlite[2/7] [===========53%              ] auto_small_1024.sqlite[2/7] [============54%             ] auto_small_1024.sqlite[2/7] [============55%             ] auto_small_1024.sqlite[2/7] [============56%             ] auto_small_1024.sqlite[2/7] [============57%             ] auto_small_1024.sqlite[2/7] [=============58%            ] auto_small_1024.sqlite[2/7] [=============59%            ] auto_small_1024.sqlite[2/7] [=============60%            ] auto_small_1024.sqlite[2/7] [==============61%           ] auto_small_1024.sqlite[2/7] [==============62%           ] auto_small_1024.sqlite[2/7] [==============63%           ] auto_small_1024.sqlite[2/7] [==============64%           ] auto_small_1024.sqlite[2/7] [===============65%          ] auto_small_1024.sqlite[2/7] [===============66%          ] auto_small_1024.sqlite[2/7] [===============67%          ] auto_small_1024.sqlite[2/7] [================68%         ] auto_small_1024.sqlite[2/7] [================69%         ] auto_small_1024.sqlite[2/7] [================70%         ] auto_small_1024.sqlite[2/7] [================71%         ] auto_small_1024.sqlite[2/7] [=================72%        ] auto_small_1024.sqlite[2/7] [=================73%        ] auto_small_1024.sqlite[2/7] [=================74%        ] auto_small_1024.sqlite[2/7] [==================75%       ] auto_small_1024.sqlite[2/7] [==================76%       ] auto_small_1024.sqlite[2/7] [==================77%       ] auto_small_1024.sqlite[2/7] [==================78%       ] auto_small_1024.sqlite[2/7] [===================79%      ] auto_small_1024.sqlite[2/7] [===================80%      ] auto_small_1024.sqlite[2/7] [===================81%      ] auto_small_1024.sqlite[2/7] [===================82%      ] auto_small_1024.sqlite[2/7] [====================83%     ] auto_small_1024.sqlite[2/7] [====================84%     ] auto_small_1024.sqlite[2/7] [====================85%     ] auto_small_1024.sqlite[2/7] [=====================86%    ] auto_small_1024.sqlite[2/7] [=====================87%    ] auto_small_1024.sqlite[2/7] [=====================88%    ] auto_small_1024.sqlite[2/7] [=====================89%    ] auto_small_1024.sqlite[2/7] [======================90%   ] auto_small_1024.sqlite[2/7] [======================91%   ] auto_small_1024.sqlite[2/7] [======================92%   ] auto_small_1024.sqlite[2/7] [=======================93%  ] auto_small_1024.sqlite[2/7] [=======================94%  ] auto_small_1024.sqlite[2/7] [=======================95%  ] auto_small_1024.sqlite[2/7] [=======================96%  ] auto_small_1024.sqlite[2/7] [========================97% ] auto_small_1024.sqlite[2/7] [========================98% ] auto_small_1024.sqlite[2/7] [========================99% ] auto_small_1024.sqlite[2/7] [========================100%] auto_small_1024.sqlite[2/7] [========================100%] auto_small_1024.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     56.0       1757952741          1  1757952741.0  1757952741.0  1757952741  1757952741          0.0  PushPop  :WARM_UP       
     18.4        578385057         10    57838505.7    57773023.5    57163048    58723235     478952.0  PushPop  :BACKWARD_PASS 
     14.7        461094833         10    46109483.3    45892264.0    45460535    47880676     725782.3  PushPop  :FORWARD_PASS  
     11.0        344094934         10    34409493.4    34437890.0    34224608    34507106      84547.3  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ----------  ----------  --------  --------  -----------  ------------------------
     44.9        719316874      57645     12478.4      5926.0      4113  61613838     387009.6  cudaLaunchKernel        
     29.8        477625045         20  23881252.3  23645876.0   1894521  46161733   22313178.1  cudaDeviceSynchronize   
     11.0        176704121        127   1391371.0     55397.0      8306  43470254    7463265.4  cudaStreamSynchronize   
      7.4        119209339        517    230579.0     16052.0      6338   6571342     655930.4  cudaMemcpyAsync         
      2.5         40352013       4905      8226.7      7172.0      5315     39392       3228.5  cuLaunchKernel          
      1.1         17719189       2985      5936.1      6323.0      2683     30794       2777.3  cudaMemsetAsync         
      1.1         17195830        115    149529.0    147320.0      7928    331691      39219.1  cudaMalloc              
      1.0         15747874          4   3936968.5   4725460.0   1296724   5000230    1766653.6  cuLibraryLoadData       
      0.7         10821864       4905      2206.3       984.0       506   4649302      66540.2  cuKernelGetFunction     
      0.2          2638617          2   1319308.5   1319308.5      2588   2636029    1862124.0  cudaFree                
      0.1          1456068          1   1456068.0   1456068.0   1456068   1456068          0.0  cudaGetDeviceProperties 
      0.1          1167641          1   1167641.0   1167641.0   1167641   1167641          0.0  cudaHostAlloc           
      0.0           335817        169      1987.1      1769.0       472     15505       1430.2  cudaStreamIsCapturing   
      0.0           205607        810       253.8       211.5       140      5986        231.5  cuGetProcAddress_v2     
      0.0            50671         36      1407.5       490.5       469     13439       2496.2  cudaEventCreateWithFlags
      0.0            22425         17      1319.1      1495.0       584      1860        413.8  cuLibraryGetKernel      
      0.0             6739          3      2246.3      2470.0      1716      2553        461.2  cuInit                  
      0.0             4451          3      1483.7       228.0       161      4062       2233.2  cuModuleGetLoadingMode  
      0.0             1654          2       827.0       827.0       522      1132        431.3  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     12.9        312584509       2940  106321.3   29056.0      1856    451517     135260.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      9.7        233427645        720  324205.1  327166.0    306206    380574      13246.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      8.7        210515859      11775   17878.2    5024.0      1439    452125      58839.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      4.9        118525548        420  282203.7  289165.5    234431    293502      18103.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      4.7        113880426        390  292001.1  294605.5    238270    319422      15647.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.6        110328003       2625   42029.7    9088.0      2944    164671      61773.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      4.5        108600600        360  301668.3  298958.0    296830    356829      12368.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.3        105035111        360  291764.2  291710.0    288126    295902       1522.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      4.1         99825959       1080   92431.4   48511.0     46655    226879      62298.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      3.5         84705647      12420    6820.1    4608.0      1440     48992       6799.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      3.5         83982044       4395   19108.5   18912.0      8128    256606      13845.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.9         71173762       3435   20720.2   20160.0     10688    131039       8701.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.8         67552587        900   75058.4   48527.5     46975    229726      52673.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      2.8         66581004        360  184947.2  184047.0    177599    213854       6013.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      2.7         66276080        360  184100.2  184942.5    179295    192543       3193.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      2.7         64596758        375  172258.0  156959.0    155615    626172      66857.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nn_align4>(T1::Params)             
      2.4         59127963        360  164244.3  162430.5    161374    209726       8984.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      2.3         55534295        195  284791.3  288830.0    234110    291710      14325.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      1.7         40753091       3945   10330.3    3040.0      1280    132319      27243.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.7         40325817        720   56008.1   55712.0     52992     70879       2913.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      1.3         32475774        195  166542.4  167295.0    145183    180191       6418.7  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      1.3         31925050        180  177361.4  176974.5    174911    184574       1675.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_nt_align4>(T1::Params)              
      1.3         31610189        180  175612.2  175615.0    173087    181503       1369.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      1.2         29888705        180  166048.4  163935.0    162943    211134       9645.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nt_align4>(T1::Params)             
      1.2         29014835        180  161193.5  157951.0    156927    204991      11348.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4>(T1::Params)             
      1.1         27381791       3705    7390.5    4416.0      1472     49184       6870.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.9         20545988        180  114144.4  114175.0    110047    115487        571.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.6         13657542       1680    8129.5    3680.0      1632     75839      10429.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      0.5         12710440        180   70613.6   70560.0     69760     72063        385.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.4         10110813       1680    6018.3    3328.0      1600     49632       6768.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      0.4          9104574       2070    4398.3    3040.0      1471     49056       5728.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.3          8363621         15  557574.7  547484.0    545469    702235      40033.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      0.3          8243303         15  549553.5  539196.0    536156    697883      41059.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      0.2          5806359        375   15483.6   15327.0     14656     20063        867.0  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.2          5554884        180   30860.5   30543.5     30048     38912       1567.1  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2          4624993        390   11859.0   12064.0      2688     15808       1945.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          3856746        360   10713.2   11615.5      8607     14048       1565.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          3315534        180   18419.6   18368.0     16640     22208        785.9  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          3294314        375    8784.8    7744.0      7199     39072       4899.0  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1          3160072        390    8102.7    8064.0      4320     10752        926.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.1          1948174        195    9990.6   10080.0      7584     12064        690.2  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1          1222650        180    6792.5    6656.0      6464      8736        495.6  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0           871702        375    2324.5    2303.0      2144      3200        140.5  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0           742073        375    1978.9    1952.0      1888      2528        141.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           724731        375    1932.6    1920.0      1664      2656        215.9  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           387868         15   25857.9   25664.0     25088     27072        527.2  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           317182         30   10572.7   10336.0      9856     11360        628.2  void at_cuda_detail::cub::DeviceRadixSortOnesweepKernel<at_cuda_detail::cub::DeviceRadixSortPolicy<…
      0.0           130879         15    8725.3    8544.0      8384     10016        422.6  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           118912         15    7927.5    7808.0      7520      9248        425.6  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            86783         30    2892.8    2880.0      2752      3616        199.0  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            54848         15    3656.5    3648.0      3584      3712         37.2  void at_cuda_detail::cub::DeviceRadixSortHistogramKernel<at_cuda_detail::cub::DeviceRadixSortPolicy…
      0.0            48736         15    3249.1    3232.0      2912      3680        221.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            42048         15    2803.2    2752.0      2688      3136        113.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            38240         15    2549.3    2560.0      2496      2592         23.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            33503         15    2233.5    2240.0      2048      2400        118.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            32640         15    2176.0    2176.0      2144      2240         24.2  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            30528         15    2035.2    2048.0      1920      2080         41.5  void at_cuda_detail::cub::DeviceRadixSortExclusiveSumKernel<at_cuda_detail::cub::DeviceRadixSortPol…
      0.0            27295         15    1819.7    1824.0      1760      1856         23.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     88.2         96811594    112  864389.2  339629.5      1504   6369394    1083364.4  [CUDA memcpy Host-to-Device]  
      7.5          8219460    390   21075.5   20032.0     18784     47904       5190.3  [CUDA memcpy Device-to-Device]
      4.3          4719483   2985    1581.1    1824.0       992      3168        405.9  [CUDA memset]                 
      0.0            33632     15    2242.1    1888.0      1856      3840        638.9  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   5179.392    390    13.280    12.583    12.583    30.720        3.492  [CUDA memcpy Device-to-Device]
    514.764    112     4.596     2.359     0.003    30.720        5.194  [CUDA memcpy Host-to-Device]  
      0.396   2985     0.000     0.000     0.000     0.004        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_1024.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_small_1024.sqlite
SUCCESS: small_1024
Profiling model_size=medium context_size=128
device set to CUDA
MACHINE hpc
RUNNING SIZE medium, CONTEXT_SIZE: 128
TRINING LOOP WITH:
vocab size 10000 context length 128
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x155107f2f240>, {'FORWARD_PASS_TIME': [0.09190503400000694, 0.09174285800000348, 0.09814269200001036, 0.09313325699997677, 0.09268312899999387, 0.09146919100001583, 0.09254738299998166, 0.09341324600001144, 0.09233881800000177, 0.09757891900000004], 'BACKWARD_PASS_TIME': [0.11245106000001215, 0.11257073300001252, 0.11412397099999794, 0.11389953200000491, 0.11277804100001276, 0.11423193000001675, 0.1131740250000064, 0.11319983999999295, 0.11297612499998877, 0.11390408900001603]})
Collecting data...
Generating '/tmp/nsys-report-376d.qdstrm'
[1/7] [0%                          ] auto_medium_128.nsys-rep[1/7] [0%                          ] auto_medium_128.nsys-rep[1/7] [0%                          ] auto_medium_128.nsys-rep[1/7] [12%                         ] auto_medium_128.nsys-rep[1/7] [11%                         ] auto_medium_128.nsys-rep[1/7] [9%                          ] auto_medium_128.nsys-rep[1/7] [=15%                        ] auto_medium_128.nsys-rep[1/7] [13%                         ] auto_medium_128.nsys-rep[1/7] [12%                         ] auto_medium_128.nsys-rep[1/7] [11%                         ] auto_medium_128.nsys-rep[1/7] [10%                         ] auto_medium_128.nsys-rep[1/7] [13%                         ] auto_medium_128.nsys-rep[1/7] [12%                         ] auto_medium_128.nsys-rep[1/7] [11%                         ] auto_medium_128.nsys-rep[1/7] [10%                         ] auto_medium_128.nsys-rep[1/7] [13%                         ] auto_medium_128.nsys-rep[1/7] [=15%                        ] auto_medium_128.nsys-rep[1/7] [==18%                       ] auto_medium_128.nsys-rep[1/7] [==21%                       ] auto_medium_128.nsys-rep[1/7] [===24%                      ] auto_medium_128.nsys-rep[1/7] [====27%                     ] auto_medium_128.nsys-rep[1/7] [=====30%                    ] auto_medium_128.nsys-rep[1/7] [======33%                   ] auto_medium_128.nsys-rep[1/7] [======35%                   ] auto_medium_128.nsys-rep[1/7] [=======38%                  ] auto_medium_128.nsys-rep[1/7] [========41%                 ] auto_medium_128.nsys-rep[1/7] [=========44%                ] auto_medium_128.nsys-rep[1/7] [==========47%               ] auto_medium_128.nsys-rep[1/7] [===========50%              ] auto_medium_128.nsys-rep[1/7] [===========51%              ] auto_medium_128.nsys-rep[1/7] [===========52%              ] auto_medium_128.nsys-rep[1/7] [===========53%              ] auto_medium_128.nsys-rep[1/7] [============54%             ] auto_medium_128.nsys-rep[1/7] [============55%             ] auto_medium_128.nsys-rep[1/7] [========================100%] auto_medium_128.nsys-rep[1/7] [========================100%] auto_medium_128.nsys-rep
[2/7] [0%                          ] auto_medium_128.sqlite[2/7] [1%                          ] auto_medium_128.sqlite[2/7] [2%                          ] auto_medium_128.sqlite[2/7] [3%                          ] auto_medium_128.sqlite[2/7] [4%                          ] auto_medium_128.sqlite[2/7] [5%                          ] auto_medium_128.sqlite[2/7] [6%                          ] auto_medium_128.sqlite[2/7] [7%                          ] auto_medium_128.sqlite[2/7] [8%                          ] auto_medium_128.sqlite[2/7] [9%                          ] auto_medium_128.sqlite[2/7] [10%                         ] auto_medium_128.sqlite[2/7] [11%                         ] auto_medium_128.sqlite[2/7] [12%                         ] auto_medium_128.sqlite[2/7] [13%                         ] auto_medium_128.sqlite[2/7] [14%                         ] auto_medium_128.sqlite[2/7] [=15%                        ] auto_medium_128.sqlite[2/7] [=16%                        ] auto_medium_128.sqlite[2/7] [=17%                        ] auto_medium_128.sqlite[2/7] [==18%                       ] auto_medium_128.sqlite[2/7] [==19%                       ] auto_medium_128.sqlite[2/7] [==20%                       ] auto_medium_128.sqlite[2/7] [==21%                       ] auto_medium_128.sqlite[2/7] [===22%                      ] auto_medium_128.sqlite[2/7] [===23%                      ] auto_medium_128.sqlite[2/7] [===24%                      ] auto_medium_128.sqlite[2/7] [====25%                     ] auto_medium_128.sqlite[2/7] [====26%                     ] auto_medium_128.sqlite[2/7] [====27%                     ] auto_medium_128.sqlite[2/7] [====28%                     ] auto_medium_128.sqlite[2/7] [=====29%                    ] auto_medium_128.sqlite[2/7] [=====30%                    ] auto_medium_128.sqlite[2/7] [=====31%                    ] auto_medium_128.sqlite[2/7] [=====32%                    ] auto_medium_128.sqlite[2/7] [======33%                   ] auto_medium_128.sqlite[2/7] [======34%                   ] auto_medium_128.sqlite[2/7] [======35%                   ] auto_medium_128.sqlite[2/7] [=======36%                  ] auto_medium_128.sqlite[2/7] [=======37%                  ] auto_medium_128.sqlite[2/7] [=======38%                  ] auto_medium_128.sqlite[2/7] [=======39%                  ] auto_medium_128.sqlite[2/7] [========40%                 ] auto_medium_128.sqlite[2/7] [========41%                 ] auto_medium_128.sqlite[2/7] [========42%                 ] auto_medium_128.sqlite[2/7] [=========43%                ] auto_medium_128.sqlite[2/7] [=========44%                ] auto_medium_128.sqlite[2/7] [=========45%                ] auto_medium_128.sqlite[2/7] [=========46%                ] auto_medium_128.sqlite[2/7] [==========47%               ] auto_medium_128.sqlite[2/7] [==========48%               ] auto_medium_128.sqlite[2/7] [==========49%               ] auto_medium_128.sqlite[2/7] [===========50%              ] auto_medium_128.sqlite[2/7] [===========51%              ] auto_medium_128.sqlite[2/7] [===========52%              ] auto_medium_128.sqlite[2/7] [===========53%              ] auto_medium_128.sqlite[2/7] [============54%             ] auto_medium_128.sqlite[2/7] [============55%             ] auto_medium_128.sqlite[2/7] [============56%             ] auto_medium_128.sqlite[2/7] [============57%             ] auto_medium_128.sqlite[2/7] [=============58%            ] auto_medium_128.sqlite[2/7] [=============59%            ] auto_medium_128.sqlite[2/7] [=============60%            ] auto_medium_128.sqlite[2/7] [==============61%           ] auto_medium_128.sqlite[2/7] [==============62%           ] auto_medium_128.sqlite[2/7] [==============63%           ] auto_medium_128.sqlite[2/7] [==============64%           ] auto_medium_128.sqlite[2/7] [===============65%          ] auto_medium_128.sqlite[2/7] [===============66%          ] auto_medium_128.sqlite[2/7] [===============67%          ] auto_medium_128.sqlite[2/7] [================68%         ] auto_medium_128.sqlite[2/7] [================69%         ] auto_medium_128.sqlite[2/7] [================70%         ] auto_medium_128.sqlite[2/7] [================71%         ] auto_medium_128.sqlite[2/7] [=================72%        ] auto_medium_128.sqlite[2/7] [=================73%        ] auto_medium_128.sqlite[2/7] [=================74%        ] auto_medium_128.sqlite[2/7] [==================75%       ] auto_medium_128.sqlite[2/7] [==================76%       ] auto_medium_128.sqlite[2/7] [==================77%       ] auto_medium_128.sqlite[2/7] [==================78%       ] auto_medium_128.sqlite[2/7] [===================79%      ] auto_medium_128.sqlite[2/7] [===================80%      ] auto_medium_128.sqlite[2/7] [===================81%      ] auto_medium_128.sqlite[2/7] [===================82%      ] auto_medium_128.sqlite[2/7] [====================83%     ] auto_medium_128.sqlite[2/7] [====================84%     ] auto_medium_128.sqlite[2/7] [====================85%     ] auto_medium_128.sqlite[2/7] [=====================86%    ] auto_medium_128.sqlite[2/7] [=====================87%    ] auto_medium_128.sqlite[2/7] [=====================88%    ] auto_medium_128.sqlite[2/7] [=====================89%    ] auto_medium_128.sqlite[2/7] [======================90%   ] auto_medium_128.sqlite[2/7] [======================91%   ] auto_medium_128.sqlite[2/7] [======================92%   ] auto_medium_128.sqlite[2/7] [=======================93%  ] auto_medium_128.sqlite[2/7] [=======================94%  ] auto_medium_128.sqlite[2/7] [=======================95%  ] auto_medium_128.sqlite[2/7] [=======================96%  ] auto_medium_128.sqlite[2/7] [========================97% ] auto_medium_128.sqlite[2/7] [========================98% ] auto_medium_128.sqlite[2/7] [========================99% ] auto_medium_128.sqlite[2/7] [========================100%] auto_medium_128.sqlite[2/7] [========================100%] auto_medium_128.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     44.8       2241161873          1  2241161873.0  2241161873.0  2241161873  2241161873          0.0  PushPop  :WARM_UP       
     22.7       1132260072         10   113226007.2   113080181.0   112328463   114138336     657993.5  PushPop  :BACKWARD_PASS 
     18.7        934014034         10    93401403.4    92532584.0    91382088    98032548    2377040.3  PushPop  :FORWARD_PASS  
     13.8        690768966         10    69076896.6    68674686.5    68070460    72139050    1234408.8  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     65.4       1115713708     113400     9838.7     6194.0      4693  62835869     253596.9  cudaLaunchKernel        
     22.3        380120198        985   385908.8    17341.0      6916   8756476    1020797.2  cudaMemcpyAsync         
      4.9         83996384       9765     8601.8     7879.0      5360     40183       3231.0  cuLaunchKernel          
      3.1         53532970        385   139046.7   137845.0      7909    523072      35087.1  cudaMalloc              
      1.2         20178027       3645     5535.8     4126.0      3333     27788       2603.5  cudaMemsetAsync         
      0.9         15844386        235    67422.9    89252.0      4374     93106      35594.4  cudaStreamSynchronize   
      0.9         15649729          4  3912432.3  4679638.5   1241564   5048888    1790363.2  cuLibraryLoadData       
      0.9         14699729       9765     1505.3      923.0       420   4542308      46055.6  cuKernelGetFunction     
      0.2          2607636          2  1303818.0  1303818.0      2533   2605103    1840294.9  cudaFree                
      0.1          1422570          1  1422570.0  1422570.0   1422570   1422570          0.0  cudaGetDeviceProperties 
      0.1          1148790          1  1148790.0  1148790.0   1148790   1148790          0.0  cudaHostAlloc           
      0.0           740414        439     1686.6     1362.0       465     15998       1121.1  cudaStreamIsCapturing   
      0.0           344509         20    17225.5    16117.5     12720     33298       4608.0  cudaDeviceSynchronize   
      0.0           213863        810      264.0      209.0       130     16660        589.3  cuGetProcAddress_v2     
      0.0            53934         36     1498.2      472.5       454     14370       2716.2  cudaEventCreateWithFlags
      0.0            29501         16     1843.8     1225.0       635     11125       2516.2  cuLibraryGetKernel      
      0.0             7388          3     2462.7     2424.0      1983      2981        500.1  cuInit                  
      0.0             4310          3     1436.7      199.0       192      3919       2149.8  cuModuleGetLoadingMode  
      0.0             2168          2     1084.0     1084.0       591      1577        697.2  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     16.3        226825589      23295    9737.1    4640.0      1440     96928      12875.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     15.0        207836883      21195    9805.9    5824.0      1472     64544       9449.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      8.3        115588895       6855   16862.0    6592.0      4608    169631      20289.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      7.1         98887777      12000    8240.6    5952.0      2976     67487       7136.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.4         75203598       7305   10294.8    5728.0      1472     63327      10060.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      3.7         51227744       3300   15523.6    5408.0      1664     97727      16735.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.5         48401082       5820    8316.3    5216.0      1504     21120       6207.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.3         46283567        720   64282.7   63392.0     58624     76608       5150.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_tn_align4>(T1::Params)             
      3.2         44750252       2160   20717.7   24479.5      7615     32127       8612.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_tn_align4>(T1::Params)               
      3.2         44407305        735   60418.1   58335.0     54463    157695      11702.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      3.1         43213336       5145    8399.1    7776.0      2816     49248       4219.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.0         41676738        735   56703.0   55199.0     50143    129536       8968.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      2.9         40530802       7725    5246.7    3712.0      1280     30176       4243.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      2.9         39983384       3300   12116.2    4768.0      1600     64064      12228.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      2.5         34490640       1440   23951.8   23808.0     21536     29056       1978.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_nn_align4>(T1::Params)              
      2.2         30993129       1440   21523.0   21312.0     19264     26240       1790.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_32x3_nt_align4>(T1::Params)              
      1.9         26820000       4050    6622.2    4416.0      1440     63776       7119.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.6         22687266        360   63020.2   62464.0     57440     75456       5098.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nn_align4>(T1::Params)             
      1.5         20671643        360   57421.2   56544.0     52384     68640       4329.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      1.5         20177199        360   56047.8   55680.0     50944     67040       4511.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      1.0         13541660       1440    9403.9    9248.0      6944     13216       1275.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.9         12124938        735   16496.5   16384.0     14944     19776       1252.8  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.5          6885761        720    9563.6    9680.0      7904     11872        955.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.5          6491843        720    9016.4    8880.0      7615     11296        816.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.4          6153179        720    8546.1    8448.0      7520     10495        708.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.4          6090389        750    8120.5    7104.0      6400     37056       4785.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.4          5397196        750    7196.3    7168.0      3776      8736        738.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.4          5390892        360   14974.7   14944.0     13856     16192        367.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.4          4881933        375   13018.5   12288.0     11104     30176       3033.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.3          4533547        780    5812.2    4608.0      3968     24096       4085.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.3          4444652        735    6047.1    6016.0      4959     12256        927.6  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.3          3886799        360   10796.7   10720.0      9760     12960        855.5  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.3          3589966        750    4786.6    4800.0      2304      6048        507.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          3376725        720    4689.9    4640.0      4128      6496        409.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.2          2977899        720    4136.0    4064.0      3616      5056        344.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          2790578        360    7751.6    7632.0      6848      9760        690.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.2          2507674        375    6687.1    6592.0      5376      8256        509.5  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.2          2218906        360    6163.6    6112.0      5568      7424        492.4  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.2          2120310        375    5654.2    4896.0      4352     23904       3489.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.1          1421369         15   94757.9   94079.0     87039    112255       7704.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      0.1          1326584        360    3685.0    3647.5      3264      4480        334.9  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          1319064        735    1794.6    1792.0      1535      2176        158.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.1          1290936        735    1756.4    1760.0      1504      2240        149.3  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.1          1179479        735    1604.7    1600.0      1344      2528        152.8  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           142272         15    9484.8    9408.0      8672     11264        779.9  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           127999         15    8533.3    8384.0      8032      9504        411.5  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0            94016         15    6267.7    6048.0      5440      8032        658.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            88895         30    2963.2    2880.0      2624      3456        242.7  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            63680         15    4245.3    4224.0      3840      4992        308.5  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            46016         15    3067.7    3040.0      2784      3584        222.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            35680         15    2378.7    2368.0      2144      2816        185.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            35487         15    2365.8    2336.0      2176      2784        177.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            35199         15    2346.6    2336.0      2112      2687        154.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            34752         15    2316.8    2272.0      2048      2976        223.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            29888         15    1992.5    1984.0      1824      2368        144.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  --------  -----------  ------------------------------
     97.7        338816253    220  1540073.9  773116.0      1568   8596758    1564507.2  [CUDA memcpy Host-to-Device]  
      1.3          4440591   3645     1218.3    1152.0       992      2656        258.3  [CUDA memset]                 
      1.0          3432432    750     4576.6    3392.0      3008     63232       8154.8  [CUDA memcpy Device-to-Device]
      0.0            35776     15     2385.1    1984.0      1824      4352        869.9  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   2155.807    750     2.874     2.097     2.097    40.960        5.444  [CUDA memcpy Device-to-Device]
   1692.766    220     7.694     4.194     0.004    40.960        7.490  [CUDA memcpy Host-to-Device]  
      0.150   3645     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_128.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_128.sqlite
SUCCESS: medium_128
Profiling model_size=medium context_size=256
device set to CUDA
MACHINE hpc
RUNNING SIZE medium, CONTEXT_SIZE: 256
TRINING LOOP WITH:
vocab size 10000 context length 256
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x154219d0b380>, {'FORWARD_PASS_TIME': [0.0918618409999965, 0.0925888680000071, 0.09797203399998011, 0.09204384700001356, 0.0919573449999973, 0.09286672000001772, 0.09212042800001541, 0.09148377299999311, 0.09187095600000816, 0.09868614399999842], 'BACKWARD_PASS_TIME': [0.11580780500000287, 0.11604512800002453, 0.11695670000000291, 0.11562084199999845, 0.11580663200001595, 0.11586260300001072, 0.11529891500001099, 0.11577002600000696, 0.1167002729999922, 0.11820216699999264]})
Collecting data...
Generating '/tmp/nsys-report-cb42.qdstrm'
[1/7] [0%                          ] auto_medium_256.nsys-rep[1/7] [0%                          ] auto_medium_256.nsys-rep[1/7] [10%                         ] auto_medium_256.nsys-rep[1/7] [=15%                        ] auto_medium_256.nsys-rep[1/7] [14%                         ] auto_medium_256.nsys-rep[1/7] [12%                         ] auto_medium_256.nsys-rep[1/7] [11%                         ] auto_medium_256.nsys-rep[1/7] [13%                         ] auto_medium_256.nsys-rep[1/7] [12%                         ] auto_medium_256.nsys-rep[1/7] [11%                         ] auto_medium_256.nsys-rep[1/7] [10%                         ] auto_medium_256.nsys-rep[1/7] [13%                         ] auto_medium_256.nsys-rep[1/7] [=15%                        ] auto_medium_256.nsys-rep[1/7] [=16%                        ] auto_medium_256.nsys-rep[1/7] [==18%                       ] auto_medium_256.nsys-rep[1/7] [==21%                       ] auto_medium_256.nsys-rep[1/7] [===24%                      ] auto_medium_256.nsys-rep[1/7] [====27%                     ] auto_medium_256.nsys-rep[1/7] [=====30%                    ] auto_medium_256.nsys-rep[1/7] [=====32%                    ] auto_medium_256.nsys-rep[1/7] [======35%                   ] auto_medium_256.nsys-rep[1/7] [=======38%                  ] auto_medium_256.nsys-rep[1/7] [========41%                 ] auto_medium_256.nsys-rep[1/7] [=========44%                ] auto_medium_256.nsys-rep[1/7] [=========46%                ] auto_medium_256.nsys-rep[1/7] [==========49%               ] auto_medium_256.nsys-rep[1/7] [===========50%              ] auto_medium_256.nsys-rep[1/7] [===========51%              ] auto_medium_256.nsys-rep[1/7] [===========52%              ] auto_medium_256.nsys-rep[1/7] [===========53%              ] auto_medium_256.nsys-rep[1/7] [============54%             ] auto_medium_256.nsys-rep[1/7] [============55%             ] auto_medium_256.nsys-rep[1/7] [========================100%] auto_medium_256.nsys-rep[1/7] [========================100%] auto_medium_256.nsys-rep
[2/7] [0%                          ] auto_medium_256.sqlite[2/7] [1%                          ] auto_medium_256.sqlite[2/7] [2%                          ] auto_medium_256.sqlite[2/7] [3%                          ] auto_medium_256.sqlite[2/7] [4%                          ] auto_medium_256.sqlite[2/7] [5%                          ] auto_medium_256.sqlite[2/7] [6%                          ] auto_medium_256.sqlite[2/7] [7%                          ] auto_medium_256.sqlite[2/7] [8%                          ] auto_medium_256.sqlite[2/7] [9%                          ] auto_medium_256.sqlite[2/7] [10%                         ] auto_medium_256.sqlite[2/7] [11%                         ] auto_medium_256.sqlite[2/7] [12%                         ] auto_medium_256.sqlite[2/7] [13%                         ] auto_medium_256.sqlite[2/7] [14%                         ] auto_medium_256.sqlite[2/7] [=15%                        ] auto_medium_256.sqlite[2/7] [=16%                        ] auto_medium_256.sqlite[2/7] [=17%                        ] auto_medium_256.sqlite[2/7] [==18%                       ] auto_medium_256.sqlite[2/7] [==19%                       ] auto_medium_256.sqlite[2/7] [==20%                       ] auto_medium_256.sqlite[2/7] [==21%                       ] auto_medium_256.sqlite[2/7] [===22%                      ] auto_medium_256.sqlite[2/7] [===23%                      ] auto_medium_256.sqlite[2/7] [===24%                      ] auto_medium_256.sqlite[2/7] [====25%                     ] auto_medium_256.sqlite[2/7] [====26%                     ] auto_medium_256.sqlite[2/7] [====27%                     ] auto_medium_256.sqlite[2/7] [====28%                     ] auto_medium_256.sqlite[2/7] [=====29%                    ] auto_medium_256.sqlite[2/7] [=====30%                    ] auto_medium_256.sqlite[2/7] [=====31%                    ] auto_medium_256.sqlite[2/7] [=====32%                    ] auto_medium_256.sqlite[2/7] [======33%                   ] auto_medium_256.sqlite[2/7] [======34%                   ] auto_medium_256.sqlite[2/7] [======35%                   ] auto_medium_256.sqlite[2/7] [=======36%                  ] auto_medium_256.sqlite[2/7] [=======37%                  ] auto_medium_256.sqlite[2/7] [=======38%                  ] auto_medium_256.sqlite[2/7] [=======39%                  ] auto_medium_256.sqlite[2/7] [========40%                 ] auto_medium_256.sqlite[2/7] [========41%                 ] auto_medium_256.sqlite[2/7] [========42%                 ] auto_medium_256.sqlite[2/7] [=========43%                ] auto_medium_256.sqlite[2/7] [=========44%                ] auto_medium_256.sqlite[2/7] [=========45%                ] auto_medium_256.sqlite[2/7] [=========46%                ] auto_medium_256.sqlite[2/7] [==========47%               ] auto_medium_256.sqlite[2/7] [==========48%               ] auto_medium_256.sqlite[2/7] [==========49%               ] auto_medium_256.sqlite[2/7] [===========50%              ] auto_medium_256.sqlite[2/7] [===========51%              ] auto_medium_256.sqlite[2/7] [===========52%              ] auto_medium_256.sqlite[2/7] [===========53%              ] auto_medium_256.sqlite[2/7] [============54%             ] auto_medium_256.sqlite[2/7] [============55%             ] auto_medium_256.sqlite[2/7] [============56%             ] auto_medium_256.sqlite[2/7] [============57%             ] auto_medium_256.sqlite[2/7] [=============58%            ] auto_medium_256.sqlite[2/7] [=============59%            ] auto_medium_256.sqlite[2/7] [=============60%            ] auto_medium_256.sqlite[2/7] [==============61%           ] auto_medium_256.sqlite[2/7] [==============62%           ] auto_medium_256.sqlite[2/7] [==============63%           ] auto_medium_256.sqlite[2/7] [==============64%           ] auto_medium_256.sqlite[2/7] [===============65%          ] auto_medium_256.sqlite[2/7] [===============66%          ] auto_medium_256.sqlite[2/7] [===============67%          ] auto_medium_256.sqlite[2/7] [================68%         ] auto_medium_256.sqlite[2/7] [================69%         ] auto_medium_256.sqlite[2/7] [================70%         ] auto_medium_256.sqlite[2/7] [================71%         ] auto_medium_256.sqlite[2/7] [=================72%        ] auto_medium_256.sqlite[2/7] [=================73%        ] auto_medium_256.sqlite[2/7] [=================74%        ] auto_medium_256.sqlite[2/7] [==================75%       ] auto_medium_256.sqlite[2/7] [==================76%       ] auto_medium_256.sqlite[2/7] [==================77%       ] auto_medium_256.sqlite[2/7] [==================78%       ] auto_medium_256.sqlite[2/7] [===================79%      ] auto_medium_256.sqlite[2/7] [===================80%      ] auto_medium_256.sqlite[2/7] [===================81%      ] auto_medium_256.sqlite[2/7] [===================82%      ] auto_medium_256.sqlite[2/7] [====================83%     ] auto_medium_256.sqlite[2/7] [====================84%     ] auto_medium_256.sqlite[2/7] [====================85%     ] auto_medium_256.sqlite[2/7] [=====================86%    ] auto_medium_256.sqlite[2/7] [=====================87%    ] auto_medium_256.sqlite[2/7] [=====================88%    ] auto_medium_256.sqlite[2/7] [=====================89%    ] auto_medium_256.sqlite[2/7] [======================90%   ] auto_medium_256.sqlite[2/7] [======================91%   ] auto_medium_256.sqlite[2/7] [======================92%   ] auto_medium_256.sqlite[2/7] [=======================93%  ] auto_medium_256.sqlite[2/7] [=======================94%  ] auto_medium_256.sqlite[2/7] [=======================95%  ] auto_medium_256.sqlite[2/7] [=======================96%  ] auto_medium_256.sqlite[2/7] [========================97% ] auto_medium_256.sqlite[2/7] [========================98% ] auto_medium_256.sqlite[2/7] [========================99% ] auto_medium_256.sqlite[2/7] [========================100%] auto_medium_256.sqlite[2/7] [========================100%] auto_medium_256.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     44.9       2273843082          1  2273843082.0  2273843082.0  2273843082  2273843082          0.0  PushPop  :WARM_UP       
     22.9       1161126075         10   116112607.5   115737830.0   115216514   118104675     854968.9  PushPop  :BACKWARD_PASS 
     18.4        931772465         10    93177246.5    91914229.0    91314772    98523694    2660076.8  PushPop  :FORWARD_PASS  
     13.9        703088477         10    70308847.7    68774118.0    68292581    82778519    4459474.8  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     64.4       1108820988     113400     9778.0     6049.0      4450  64279836     256599.3  cudaLaunchKernel        
     22.0        379227458        985   385002.5    17163.0      6882   8756545    1019460.6  cudaMemcpyAsync         
      4.9         85120357       9765     8716.9     7899.0      5471     80096       3381.9  cuLaunchKernel          
      4.0         68970001        501   137664.7   135624.0      6298    334765      30596.5  cudaMalloc              
      1.5         25942663       4380     5923.0     4380.0      3303     30686       2848.5  cudaMemsetAsync         
      0.9         15902595        235    67670.6    89532.0      8016    104599      35982.4  cudaStreamSynchronize   
      0.9         15690162          4  3922540.5  4689101.0   1269447   5042513    1777440.2  cuLibraryLoadData       
      0.9         15503270       9765     1587.6      956.0       414   4547795      46136.7  cuKernelGetFunction     
      0.2          2629029          2  1314514.5  1314514.5     15346   2613683    1837301.7  cudaFree                
      0.1          1428781          1  1428781.0  1428781.0   1428781   1428781          0.0  cudaGetDeviceProperties 
      0.1          1194711          1  1194711.0  1194711.0   1194711   1194711          0.0  cudaHostAlloc           
      0.1          1083713         20    54185.7    38498.0     12319    110113      42483.0  cudaDeviceSynchronize   
      0.1          1059849        555     1909.6     1804.0       452     21279       1676.5  cudaStreamIsCapturing   
      0.0           195940        810      241.9      209.0       130      1039        107.5  cuGetProcAddress_v2     
      0.0            54262         36     1507.3      491.0       456     14133       2606.5  cudaEventCreateWithFlags
      0.0            23317         18     1295.4     1330.5       604      1799        391.6  cuLibraryGetKernel      
      0.0             7312          3     2437.3     2307.0      2067      2938        449.9  cuInit                  
      0.0             4341          3     1447.0      197.0       180      3964       2179.8  cuModuleGetLoadingMode  
      0.0             1716          2      858.0      858.0       529      1187        465.3  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     14.0        250743298      23295   10763.8    4800.0      1440     97439      13518.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     11.6        206916645      21195    9762.5    5760.0      1471     64192       9455.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      6.8        120975093       6855   17647.7    9088.0      6272    171807      18699.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.7        120204571      12000   10017.0    8992.0      3007     67808       6817.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.4        115336610       5820   19817.3    8128.0      1599     39392      15053.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      4.2         75027391       7305   10270.7    5888.0      1471     64288       9886.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      3.8         68583204        735   93310.5   88063.0     87264    232702      16201.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      3.8         67834518        720   94214.6   90847.5     88416    117408       9001.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_tn_align4>(T1::Params)             
      3.8         67778158        720   94136.3   90528.0     89312    119904       9075.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      2.9         52370115       5145   10178.8    7904.0      2784     50880       6559.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.8         50507819       3300   15305.4    4960.0      1632     97792      16761.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.7         49001196       1440   34028.6   32800.0     32192     43616       3315.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_nt_align4>(T1::Params)             
      2.7         47552785       1440   33022.8   31776.0     31328     41856       3203.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_nn_align4>(T1::Params)             
      2.6         46226858       1440   32102.0   30880.0     30015     41024       3324.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      2.5         44620843       7725    5776.2    3936.0      1280     29856       4531.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      2.4         43296655       1440   30067.1   29536.0     25664     37600       2880.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.2         39413408       3300   11943.5    4416.0      1599     64544      12226.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      1.9         34147056        360   94852.9   91103.0     89343    118528       8867.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      1.9         33978103        360   94383.6   90863.5     89952    118655       9109.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      1.9         33769475        360   93804.1   90303.0     89312    117920       8951.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nn_align4>(T1::Params)             
      1.5         26303355       4050    6494.7    4128.0      1472     64543       7128.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.0         18514985        750   24686.6   24064.0     20576     66816       7469.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      1.0         18018551        720   25025.8   24288.0     23424     30656       2041.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      1.0         18010178        780   23090.0   24320.0     13632     62944      11830.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      1.0         17342087        720   24086.2   23168.0     21311     31968       2237.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      0.9         15245747        720   21174.6   21984.0     17375     27328       2942.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.8         14029018        360   38969.5   38944.0     38432     39679        234.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.7         13401904        720   18613.8   18608.0     16928     21888       1106.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.6         10392787        720   14434.4   14415.5     12320     18624       1068.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.5          8911224        375   23763.3   21824.0     21472     53408       5368.9  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.4          8014683        735   10904.3   10528.0     10176     13951        991.2  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.4          6404831        375   17079.5   15200.0     13888     58815       8434.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.3          6110531        360   16973.7   16640.0     15712     20000       1023.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.3          5184134        750    6912.2    6752.0      3552      8832        822.4  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.3          5087459        360   14131.8   13600.0     13440     17760       1343.1  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.3          4795655        735    6524.7    6496.0      5248     19392       1558.0  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.3          4532684        750    6043.6    5888.0      2656      7808        746.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          3972078        720    5516.8    5888.0      4384      7872        999.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          2877658        360    7993.5    7680.0      7584     10080        772.0  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.2          2782450         15  185496.7  178207.0    177535    233919      18562.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      0.2          2715123         15  181008.2  174111.0    173567    229343      18685.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      0.1          2556910        375    6818.4    6592.0      6176      8992        582.2  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1          1502617        360    4173.9    4032.0      3808      5216        378.7  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          1338655        735    1821.3    1728.0      1664      2592        191.7  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.1          1268635        735    1726.0    1664.0      1536      2176        176.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.1          1241597        735    1689.2    1632.0      1504      2464        162.3  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0           184032         15   12268.8   12192.0     11616     13440        528.4  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           144095         15    9606.3    9248.0      9184     11968        934.1  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           120576         15    8038.4    8096.0      6688      9632        622.4  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            99647         15    6643.1    6368.0      6112      8224        660.3  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            88416         30    2947.2    2816.0      2688      3712        311.2  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            47040         15    3136.0    3104.0      2912      3680        222.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            36191         15    2412.7    2336.0      2016      2752        204.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            34944         15    2329.6    2240.0      2080      2976        268.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34240         15    2282.7    2240.0      2144      2688        164.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            33055         15    2203.7    2144.0      2048      2752        226.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            27936         15    1862.4    1824.0      1728      2400        209.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  --------  -----------  ------------------------------
     97.3        338603657    220  1539107.5  768348.5      1568   8590583    1564689.4  [CUDA memcpy Host-to-Device]  
      1.4          4974639   4380     1135.8    1024.0       991      2656        250.8  [CUDA memset]                 
      1.2          4299562    750     5732.7    4448.0      4000     63200       8013.4  [CUDA memcpy Device-to-Device]
      0.0            35456     15     2363.7    1856.0      1824      4544        962.9  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   3697.213    750     4.930     4.194     4.194    40.960        5.151  [CUDA memcpy Device-to-Device]
   1692.799    220     7.695     4.194     0.004    40.960        7.490  [CUDA memcpy Host-to-Device]  
      0.220   4380     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_256.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_256.sqlite
SUCCESS: medium_256
Profiling model_size=medium context_size=512
device set to CUDA
MACHINE hpc
RUNNING SIZE medium, CONTEXT_SIZE: 512
TRINING LOOP WITH:
vocab size 10000 context length 512
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x1521a3d23380>, {'FORWARD_PASS_TIME': [0.09348354299999073, 0.09347907799997301, 0.09850813799999969, 0.0933700680000129, 0.09285580100004154, 0.09287101799998254, 0.09282745600000908, 0.09225592500001767, 0.09383833800001184, 0.09525467299999946], 'BACKWARD_PASS_TIME': [0.11701462500002435, 0.11841622399998641, 0.11995754299999817, 0.11861840900002107, 0.11799171500001648, 0.11765853099996093, 0.11811999000002515, 0.11898383200002627, 0.11862069800002928, 0.12473117700000103]})
Collecting data...
Generating '/tmp/nsys-report-b785.qdstrm'
[1/7] [0%                          ] auto_medium_512.nsys-rep[1/7] [0%                          ] auto_medium_512.nsys-rep[1/7] [0%                          ] auto_medium_512.nsys-rep[1/7] [0%                          ] auto_medium_512.nsys-rep[1/7] [10%                         ] auto_medium_512.nsys-rep[1/7] [9%                          ] auto_medium_512.nsys-rep[1/7] [8%                          ] auto_medium_512.nsys-rep[1/7] [7%                          ] auto_medium_512.nsys-rep[1/7] [12%                         ] auto_medium_512.nsys-rep[1/7] [11%                         ] auto_medium_512.nsys-rep[1/7] [10%                         ] auto_medium_512.nsys-rep[1/7] [9%                          ] auto_medium_512.nsys-rep[1/7] [12%                         ] auto_medium_512.nsys-rep[1/7] [11%                         ] auto_medium_512.nsys-rep[1/7] [10%                         ] auto_medium_512.nsys-rep[1/7] [9%                          ] auto_medium_512.nsys-rep[1/7] [12%                         ] auto_medium_512.nsys-rep[1/7] [=15%                        ] auto_medium_512.nsys-rep[1/7] [=17%                        ] auto_medium_512.nsys-rep[1/7] [==20%                       ] auto_medium_512.nsys-rep[1/7] [===23%                      ] auto_medium_512.nsys-rep[1/7] [====26%                     ] auto_medium_512.nsys-rep[1/7] [====28%                     ] auto_medium_512.nsys-rep[1/7] [=====31%                    ] auto_medium_512.nsys-rep[1/7] [======34%                   ] auto_medium_512.nsys-rep[1/7] [=======37%                  ] auto_medium_512.nsys-rep[1/7] [=======39%                  ] auto_medium_512.nsys-rep[1/7] [========42%                 ] auto_medium_512.nsys-rep[1/7] [=========45%                ] auto_medium_512.nsys-rep[1/7] [==========48%               ] auto_medium_512.nsys-rep[1/7] [===========50%              ] auto_medium_512.nsys-rep[1/7] [===========51%              ] auto_medium_512.nsys-rep[1/7] [===========52%              ] auto_medium_512.nsys-rep[1/7] [===========53%              ] auto_medium_512.nsys-rep[1/7] [============54%             ] auto_medium_512.nsys-rep[1/7] [============55%             ] auto_medium_512.nsys-rep[1/7] [========================100%] auto_medium_512.nsys-rep[1/7] [========================100%] auto_medium_512.nsys-rep
[2/7] [0%                          ] auto_medium_512.sqlite[2/7] [1%                          ] auto_medium_512.sqlite[2/7] [2%                          ] auto_medium_512.sqlite[2/7] [3%                          ] auto_medium_512.sqlite[2/7] [4%                          ] auto_medium_512.sqlite[2/7] [5%                          ] auto_medium_512.sqlite[2/7] [6%                          ] auto_medium_512.sqlite[2/7] [7%                          ] auto_medium_512.sqlite[2/7] [8%                          ] auto_medium_512.sqlite[2/7] [9%                          ] auto_medium_512.sqlite[2/7] [10%                         ] auto_medium_512.sqlite[2/7] [11%                         ] auto_medium_512.sqlite[2/7] [12%                         ] auto_medium_512.sqlite[2/7] [13%                         ] auto_medium_512.sqlite[2/7] [14%                         ] auto_medium_512.sqlite[2/7] [=15%                        ] auto_medium_512.sqlite[2/7] [=16%                        ] auto_medium_512.sqlite[2/7] [=17%                        ] auto_medium_512.sqlite[2/7] [==18%                       ] auto_medium_512.sqlite[2/7] [==19%                       ] auto_medium_512.sqlite[2/7] [==20%                       ] auto_medium_512.sqlite[2/7] [==21%                       ] auto_medium_512.sqlite[2/7] [===22%                      ] auto_medium_512.sqlite[2/7] [===23%                      ] auto_medium_512.sqlite[2/7] [===24%                      ] auto_medium_512.sqlite[2/7] [====25%                     ] auto_medium_512.sqlite[2/7] [====26%                     ] auto_medium_512.sqlite[2/7] [====27%                     ] auto_medium_512.sqlite[2/7] [====28%                     ] auto_medium_512.sqlite[2/7] [=====29%                    ] auto_medium_512.sqlite[2/7] [=====30%                    ] auto_medium_512.sqlite[2/7] [=====31%                    ] auto_medium_512.sqlite[2/7] [=====32%                    ] auto_medium_512.sqlite[2/7] [======33%                   ] auto_medium_512.sqlite[2/7] [======34%                   ] auto_medium_512.sqlite[2/7] [======35%                   ] auto_medium_512.sqlite[2/7] [=======36%                  ] auto_medium_512.sqlite[2/7] [=======37%                  ] auto_medium_512.sqlite[2/7] [=======38%                  ] auto_medium_512.sqlite[2/7] [=======39%                  ] auto_medium_512.sqlite[2/7] [========40%                 ] auto_medium_512.sqlite[2/7] [========41%                 ] auto_medium_512.sqlite[2/7] [========42%                 ] auto_medium_512.sqlite[2/7] [=========43%                ] auto_medium_512.sqlite[2/7] [=========44%                ] auto_medium_512.sqlite[2/7] [=========45%                ] auto_medium_512.sqlite[2/7] [=========46%                ] auto_medium_512.sqlite[2/7] [==========47%               ] auto_medium_512.sqlite[2/7] [==========48%               ] auto_medium_512.sqlite[2/7] [==========49%               ] auto_medium_512.sqlite[2/7] [===========50%              ] auto_medium_512.sqlite[2/7] [===========51%              ] auto_medium_512.sqlite[2/7] [===========52%              ] auto_medium_512.sqlite[2/7] [===========53%              ] auto_medium_512.sqlite[2/7] [============54%             ] auto_medium_512.sqlite[2/7] [============55%             ] auto_medium_512.sqlite[2/7] [============56%             ] auto_medium_512.sqlite[2/7] [============57%             ] auto_medium_512.sqlite[2/7] [=============58%            ] auto_medium_512.sqlite[2/7] [=============59%            ] auto_medium_512.sqlite[2/7] [=============60%            ] auto_medium_512.sqlite[2/7] [==============61%           ] auto_medium_512.sqlite[2/7] [==============62%           ] auto_medium_512.sqlite[2/7] [==============63%           ] auto_medium_512.sqlite[2/7] [==============64%           ] auto_medium_512.sqlite[2/7] [===============65%          ] auto_medium_512.sqlite[2/7] [===============66%          ] auto_medium_512.sqlite[2/7] [===============67%          ] auto_medium_512.sqlite[2/7] [================68%         ] auto_medium_512.sqlite[2/7] [================69%         ] auto_medium_512.sqlite[2/7] [================70%         ] auto_medium_512.sqlite[2/7] [================71%         ] auto_medium_512.sqlite[2/7] [=================72%        ] auto_medium_512.sqlite[2/7] [=================73%        ] auto_medium_512.sqlite[2/7] [=================74%        ] auto_medium_512.sqlite[2/7] [==================75%       ] auto_medium_512.sqlite[2/7] [==================76%       ] auto_medium_512.sqlite[2/7] [==================77%       ] auto_medium_512.sqlite[2/7] [==================78%       ] auto_medium_512.sqlite[2/7] [===================79%      ] auto_medium_512.sqlite[2/7] [===================80%      ] auto_medium_512.sqlite[2/7] [===================81%      ] auto_medium_512.sqlite[2/7] [===================82%      ] auto_medium_512.sqlite[2/7] [====================83%     ] auto_medium_512.sqlite[2/7] [====================84%     ] auto_medium_512.sqlite[2/7] [====================85%     ] auto_medium_512.sqlite[2/7] [=====================86%    ] auto_medium_512.sqlite[2/7] [=====================87%    ] auto_medium_512.sqlite[2/7] [=====================88%    ] auto_medium_512.sqlite[2/7] [=====================89%    ] auto_medium_512.sqlite[2/7] [======================90%   ] auto_medium_512.sqlite[2/7] [======================91%   ] auto_medium_512.sqlite[2/7] [======================92%   ] auto_medium_512.sqlite[2/7] [=======================93%  ] auto_medium_512.sqlite[2/7] [=======================94%  ] auto_medium_512.sqlite[2/7] [=======================95%  ] auto_medium_512.sqlite[2/7] [=======================96%  ] auto_medium_512.sqlite[2/7] [========================97% ] auto_medium_512.sqlite[2/7] [========================98% ] auto_medium_512.sqlite[2/7] [========================99% ] auto_medium_512.sqlite[2/7] [========================100%] auto_medium_512.sqlite[2/7] [========================100%] auto_medium_512.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     44.9       2286848422          1  2286848422.0  2286848422.0  2286848422  2286848422          0.0  PushPop  :WARM_UP       
     23.3       1189146993         10   118914699.3   118411200.5   116904438   124638761    2159999.8  PushPop  :BACKWARD_PASS 
     18.3        935214181         10    93521418.1    93062363.0    91858560    98166121    1824168.4  PushPop  :FORWARD_PASS  
     13.5        685919078         10    68591907.8    68404038.5    67871921    69930863     603888.5  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     63.5       1102799384     113400     9724.9     6071.0      4650  62973571     252196.3  cudaLaunchKernel        
     21.8        378540539        985   384305.1    16053.0      6692   8729927    1019281.2  cudaMemcpyAsync         
      4.6         80265379       9765     8219.7     7462.0      5069     42898       3303.4  cuLaunchKernel          
      3.5         61496945        411   149627.6   147348.0      5819    348944      29852.0  cudaMalloc              
      3.4         58614315       9780     5993.3     5737.0      3043    225799       3779.5  cudaMemsetAsync         
      0.9         15899752        235    67658.5    89613.0      3878    101523      35929.6  cudaStreamSynchronize   
      0.9         15580028          4  3895007.0  4669110.5   1236030   5005777    1781231.9  cuLibraryLoadData       
      0.8         14713302       9765     1506.7      937.0       414   4558526      46215.3  cuKernelGetFunction     
      0.2          2963708         20   148185.4   127086.5     13036    338701     137558.4  cudaDeviceSynchronize   
      0.1          2593382          2  1296691.0  1296691.0      2428   2590954    1830364.3  cudaFree                
      0.1          1441443          1  1441443.0  1441443.0   1441443   1441443          0.0  cudaGetDeviceProperties 
      0.1          1203206          1  1203206.0  1203206.0   1203206   1203206          0.0  cudaHostAlloc           
      0.1           903062        465     1942.1     1833.0       451     20257       1271.5  cudaStreamIsCapturing   
      0.0           207987        810      256.8      205.0       136      7546        340.9  cuGetProcAddress_v2     
      0.0            74233         36     2062.0      494.0       459     32060       5677.0  cudaEventCreateWithFlags
      0.0            36483         14     2605.9     1317.0       631     11173       3647.5  cuLibraryGetKernel      
      0.0             7324          3     2441.3     2449.0      2019      2856        418.6  cuInit                  
      0.0             4256          3     1418.7      202.0       190      3864       2117.7  cuModuleGetLoadingMode  
      0.0             1679          2      839.5      839.5       509      1170        467.4  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     10.9        337229035      23295   14476.5    5184.0      1440    186751      23611.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     10.0        307932088       5820   52909.3   20448.0      1855    154975      47886.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      6.7        207472654       2175   95389.7   59392.0     57728    439486      52447.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      6.7        206807835      21195    9757.4    5920.0      1440     63616       9407.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      6.0        185106830       1080  171395.2  173439.0    155263    224383      14195.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      5.2        160398032       1440  111387.5  112287.0    104640    132064       5451.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.2        160243633      12000   13353.6   12512.0      2976    129311       7360.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.9        150352923       1815   82839.1   59264.0     57472    449342      48377.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      4.7        144202636       6855   21036.1   15360.0      9568    173535      16698.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.6        109872643       5145   21355.2    9760.0      2784     83040      24569.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.4        105556987        720  146606.9  143199.5    141503    188767      10426.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      2.7         82589684       1440   57353.9   56192.0     54784     74495       3869.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      2.5         76271194        780   97783.6   95935.5     94111    122208       6507.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      2.5         76219121       7305   10433.8    6432.0      1472     62848       9710.7  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      2.4         73322275        720  101836.5  100671.0     99808    120191       4578.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.4         73271238        750   97695.0   97215.0     94303    130879       5165.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.3         71402972        720   99170.8   99104.0     96480    101920        656.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      1.8         56599626       7725    7326.8    3904.0      1280     54720       9077.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.8         55249075        720   76734.8   77455.0     71136     84799       3322.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      1.8         54772545        720   76073.0   76815.0     69472     83520       2602.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      1.7         53663593        360  149065.5  146975.0    143487    191583      10977.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      1.7         51486167        720   71508.6   71119.5     67295     84160       2908.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      1.6         50067718       3300   15172.0    4960.0      1631     97695      16755.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      1.3         39200542       3300   11879.0    4672.0      1568     64768      12188.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      1.2         36046871        375   96125.0   95263.0     94432    116479       4089.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.9         28634876        375   76359.7   75584.0     74336     92575       2482.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.9         28006515        360   77795.9   77759.0     75232     79103        413.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.8         26146838       4050    6456.0    4224.0      1440     64416       7038.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.5         15885562        360   44126.6   44064.0     43488     45536        368.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.3          9378357        735   12759.7   12544.0     12128     16448        880.2  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.3          7900048        360   21944.6   21600.0     20992     28256       1486.1  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2          6786083        750    9048.1    9024.0      2656     11840       1109.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          5799686        735    7890.7    7456.0      6528     29824       2454.6  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.2          5633038        750    7510.7    7424.0      3968      9920        721.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2          5388230        720    7483.7    8160.0      6048     10496       1080.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          5030537         15  335369.1  330014.0    325630    425822      25108.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      0.1          4525867        360   12571.9   12416.0     11776     16192        855.3  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          3434988        375    9160.0    9119.0      7520     11104        524.1  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1          1656279        360    4600.8    4512.0      4384      5824        314.4  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          1533111        735    2085.9    2080.0      1824      2848        174.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0          1445053        735    1966.1    1920.0      1856      2528        138.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0          1375288        735    1871.1    1888.0      1664      2720        171.1  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           296287         15   19752.5   19679.0     19168     20608        391.3  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           159103         15   10606.9   10624.0     10496     10688         48.2  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           123584         15    8238.9    8224.0      7840      9504        378.4  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           110784         15    7385.6    7360.0      6624      8544        554.7  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            86013         30    2867.1    2848.0      2720      3520        195.4  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            46080         15    3072.0    3040.0      2944      3328        109.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            40095         15    2673.0    2656.0      2559      2944        108.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            37280         15    2485.3    2464.0      2432      2592         47.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34080         15    2272.0    2240.0      2208      2432         62.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            32384         15    2158.9    2176.0      2048      2240         41.7  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            26848         15    1789.9    1824.0      1696      1824         50.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  --------  -----------  ------------------------------
     93.4        338690599    220  1539502.7  769900.5      1568   8568791    1564272.9  [CUDA memcpy Host-to-Device]  
      3.5         12862636   9780     1315.2    1056.0       991      9664        398.5  [CUDA memset]                 
      3.0         10855916    750    14474.6   13600.0     10912     63263       6790.2  [CUDA memcpy Device-to-Device]
      0.0            32128     15     2141.9    1888.0      1824      3872        673.6  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   6780.027    750     9.040     8.389     8.389    40.960        4.563  [CUDA memcpy Device-to-Device]
   1692.865    220     7.695     4.194     0.004    40.960        7.489  [CUDA memcpy Host-to-Device]  
      2.526   9780     0.000     0.000     0.000     0.001        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_512.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_512.sqlite
SUCCESS: medium_512
Profiling model_size=medium context_size=1024
device set to CUDA
MACHINE hpc
RUNNING SIZE medium, CONTEXT_SIZE: 1024
TRINING LOOP WITH:
vocab size 10000 context length 1024
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x152f44f87600>, {'FORWARD_PASS_TIME': [0.13050765600002023, 0.13047541800000317, 0.13093031100004282, 0.13035948200001712, 0.13045092800001612, 0.13049934800000074, 0.13051566299998285, 0.13045131799998444, 0.13047393900001225, 0.130782446000012], 'BACKWARD_PASS_TIME': [0.28937837099999797, 0.2896933419999641, 0.28947948100000076, 0.2891451600000323, 0.2895086710000214, 0.289193656000009, 0.2894868050000241, 0.2896878579999793, 0.2896583140000075, 0.2898792940000021]})
Collecting data...
Generating '/tmp/nsys-report-9603.qdstrm'
[1/7] [0%                          ] auto_medium_1024.nsys-rep[1/7] [0%                          ] auto_medium_1024.nsys-rep[1/7] [0%                          ] auto_medium_1024.nsys-rep[1/7] [12%                         ] auto_medium_1024.nsys-rep[1/7] [11%                         ] auto_medium_1024.nsys-rep[1/7] [10%                         ] auto_medium_1024.nsys-rep[1/7] [14%                         ] auto_medium_1024.nsys-rep[1/7] [13%                         ] auto_medium_1024.nsys-rep[1/7] [12%                         ] auto_medium_1024.nsys-rep[1/7] [11%                         ] auto_medium_1024.nsys-rep[1/7] [13%                         ] auto_medium_1024.nsys-rep[1/7] [12%                         ] auto_medium_1024.nsys-rep[1/7] [11%                         ] auto_medium_1024.nsys-rep[1/7] [10%                         ] auto_medium_1024.nsys-rep[1/7] [12%                         ] auto_medium_1024.nsys-rep[1/7] [=15%                        ] auto_medium_1024.nsys-rep[1/7] [==18%                       ] auto_medium_1024.nsys-rep[1/7] [==21%                       ] auto_medium_1024.nsys-rep[1/7] [===23%                      ] auto_medium_1024.nsys-rep[1/7] [====26%                     ] auto_medium_1024.nsys-rep[1/7] [=====29%                    ] auto_medium_1024.nsys-rep[1/7] [=====31%                    ] auto_medium_1024.nsys-rep[1/7] [======34%                   ] auto_medium_1024.nsys-rep[1/7] [=======37%                  ] auto_medium_1024.nsys-rep[1/7] [=======39%                  ] auto_medium_1024.nsys-rep[1/7] [========42%                 ] auto_medium_1024.nsys-rep[1/7] [=========45%                ] auto_medium_1024.nsys-rep[1/7] [==========48%               ] auto_medium_1024.nsys-rep[1/7] [===========50%              ] auto_medium_1024.nsys-rep[1/7] [===========51%              ] auto_medium_1024.nsys-rep[1/7] [===========52%              ] auto_medium_1024.nsys-rep[1/7] [===========53%              ] auto_medium_1024.nsys-rep[1/7] [============54%             ] auto_medium_1024.nsys-rep[1/7] [============55%             ] auto_medium_1024.nsys-rep[1/7] [========================100%] auto_medium_1024.nsys-rep[1/7] [========================100%] auto_medium_1024.nsys-rep
[2/7] [0%                          ] auto_medium_1024.sqlite[2/7] [1%                          ] auto_medium_1024.sqlite[2/7] [2%                          ] auto_medium_1024.sqlite[2/7] [3%                          ] auto_medium_1024.sqlite[2/7] [4%                          ] auto_medium_1024.sqlite[2/7] [5%                          ] auto_medium_1024.sqlite[2/7] [6%                          ] auto_medium_1024.sqlite[2/7] [7%                          ] auto_medium_1024.sqlite[2/7] [8%                          ] auto_medium_1024.sqlite[2/7] [9%                          ] auto_medium_1024.sqlite[2/7] [10%                         ] auto_medium_1024.sqlite[2/7] [11%                         ] auto_medium_1024.sqlite[2/7] [12%                         ] auto_medium_1024.sqlite[2/7] [13%                         ] auto_medium_1024.sqlite[2/7] [14%                         ] auto_medium_1024.sqlite[2/7] [=15%                        ] auto_medium_1024.sqlite[2/7] [=16%                        ] auto_medium_1024.sqlite[2/7] [=17%                        ] auto_medium_1024.sqlite[2/7] [==18%                       ] auto_medium_1024.sqlite[2/7] [==19%                       ] auto_medium_1024.sqlite[2/7] [==20%                       ] auto_medium_1024.sqlite[2/7] [==21%                       ] auto_medium_1024.sqlite[2/7] [===22%                      ] auto_medium_1024.sqlite[2/7] [===23%                      ] auto_medium_1024.sqlite[2/7] [===24%                      ] auto_medium_1024.sqlite[2/7] [====25%                     ] auto_medium_1024.sqlite[2/7] [====26%                     ] auto_medium_1024.sqlite[2/7] [====27%                     ] auto_medium_1024.sqlite[2/7] [====28%                     ] auto_medium_1024.sqlite[2/7] [=====29%                    ] auto_medium_1024.sqlite[2/7] [=====30%                    ] auto_medium_1024.sqlite[2/7] [=====31%                    ] auto_medium_1024.sqlite[2/7] [=====32%                    ] auto_medium_1024.sqlite[2/7] [======33%                   ] auto_medium_1024.sqlite[2/7] [======34%                   ] auto_medium_1024.sqlite[2/7] [======35%                   ] auto_medium_1024.sqlite[2/7] [=======36%                  ] auto_medium_1024.sqlite[2/7] [=======37%                  ] auto_medium_1024.sqlite[2/7] [=======38%                  ] auto_medium_1024.sqlite[2/7] [=======39%                  ] auto_medium_1024.sqlite[2/7] [========40%                 ] auto_medium_1024.sqlite[2/7] [========41%                 ] auto_medium_1024.sqlite[2/7] [========42%                 ] auto_medium_1024.sqlite[2/7] [=========43%                ] auto_medium_1024.sqlite[2/7] [=========44%                ] auto_medium_1024.sqlite[2/7] [=========45%                ] auto_medium_1024.sqlite[2/7] [=========46%                ] auto_medium_1024.sqlite[2/7] [==========47%               ] auto_medium_1024.sqlite[2/7] [==========48%               ] auto_medium_1024.sqlite[2/7] [==========49%               ] auto_medium_1024.sqlite[2/7] [===========50%              ] auto_medium_1024.sqlite[2/7] [===========51%              ] auto_medium_1024.sqlite[2/7] [===========52%              ] auto_medium_1024.sqlite[2/7] [===========53%              ] auto_medium_1024.sqlite[2/7] [============54%             ] auto_medium_1024.sqlite[2/7] [============55%             ] auto_medium_1024.sqlite[2/7] [============56%             ] auto_medium_1024.sqlite[2/7] [============57%             ] auto_medium_1024.sqlite[2/7] [=============58%            ] auto_medium_1024.sqlite[2/7] [=============59%            ] auto_medium_1024.sqlite[2/7] [=============60%            ] auto_medium_1024.sqlite[2/7] [==============61%           ] auto_medium_1024.sqlite[2/7] [==============62%           ] auto_medium_1024.sqlite[2/7] [==============63%           ] auto_medium_1024.sqlite[2/7] [==============64%           ] auto_medium_1024.sqlite[2/7] [===============65%          ] auto_medium_1024.sqlite[2/7] [===============66%          ] auto_medium_1024.sqlite[2/7] [===============67%          ] auto_medium_1024.sqlite[2/7] [================68%         ] auto_medium_1024.sqlite[2/7] [================69%         ] auto_medium_1024.sqlite[2/7] [================70%         ] auto_medium_1024.sqlite[2/7] [================71%         ] auto_medium_1024.sqlite[2/7] [=================72%        ] auto_medium_1024.sqlite[2/7] [=================73%        ] auto_medium_1024.sqlite[2/7] [=================74%        ] auto_medium_1024.sqlite[2/7] [==================75%       ] auto_medium_1024.sqlite[2/7] [==================76%       ] auto_medium_1024.sqlite[2/7] [==================77%       ] auto_medium_1024.sqlite[2/7] [==================78%       ] auto_medium_1024.sqlite[2/7] [===================79%      ] auto_medium_1024.sqlite[2/7] [===================80%      ] auto_medium_1024.sqlite[2/7] [===================81%      ] auto_medium_1024.sqlite[2/7] [===================82%      ] auto_medium_1024.sqlite[2/7] [====================83%     ] auto_medium_1024.sqlite[2/7] [====================84%     ] auto_medium_1024.sqlite[2/7] [====================85%     ] auto_medium_1024.sqlite[2/7] [=====================86%    ] auto_medium_1024.sqlite[2/7] [=====================87%    ] auto_medium_1024.sqlite[2/7] [=====================88%    ] auto_medium_1024.sqlite[2/7] [=====================89%    ] auto_medium_1024.sqlite[2/7] [======================90%   ] auto_medium_1024.sqlite[2/7] [======================91%   ] auto_medium_1024.sqlite[2/7] [======================92%   ] auto_medium_1024.sqlite[2/7] [=======================93%  ] auto_medium_1024.sqlite[2/7] [=======================94%  ] auto_medium_1024.sqlite[2/7] [=======================95%  ] auto_medium_1024.sqlite[2/7] [=======================96%  ] auto_medium_1024.sqlite[2/7] [========================97% ] auto_medium_1024.sqlite[2/7] [========================98% ] auto_medium_1024.sqlite[2/7] [========================99% ] auto_medium_1024.sqlite[2/7] [========================100%] auto_medium_1024.sqlite[2/7] [========================100%] auto_medium_1024.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     48.0       3208650406          1  3208650406.0  3208650406.0  3208650406  3208650406          0.0  PushPop  :WARM_UP       
     27.8       1854521579         10   185452157.9   185435114.0   185050906   186244768     357725.1  PushPop  :BACKWARD_PASS 
     13.8        919929370         10    91992937.0    90891322.0    89599912    97222655    2822897.7  PushPop  :FORWARD_PASS  
     10.4        697684797         10    69768479.7    69236876.5    68955122    72356187    1108996.9  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)            Name          
 --------  ---------------  ---------  ----------  ----------  --------  ---------  -----------  ------------------------
     50.5       2403435955     113445     21185.9      6250.0      4808  109151537     415697.1  cudaLaunchKernel        
     29.9       1424353401         20  71217670.0  72156272.0  33524179  104208913   33650219.2  cudaDeviceSynchronize   
      8.0        380429431        985    386222.8     17575.0      6480    8785209    1020047.9  cudaMemcpyAsync         
      4.5        212489664       9765     21760.3      7735.0      5366     504142      66275.4  cuLaunchKernel          
      3.3        157871794       6600     23920.0      6575.5      2654     580972      68813.9  cudaMemsetAsync         
      2.2        104761117        235    445792.0     89719.0      3811   22241427    2869976.2  cudaStreamSynchronize   
      0.8         37686216        252    149548.5    146645.0      4351     325519      34407.7  cudaMalloc              
      0.3         15950604          4   3987651.0   4775275.0   1270417    5129637    1820871.5  cuLibraryLoadData       
      0.3         15891191       9765      1627.4      1022.0       485    4591037      46582.3  cuKernelGetFunction     
      0.1          2610380          2   1305190.0   1305190.0      2952    2607428    1841642.6  cudaFree                
      0.0          1475469          1   1475469.0   1475469.0   1475469    1475469          0.0  cudaGetDeviceProperties 
      0.0          1143566          1   1143566.0   1143566.0   1143566    1143566          0.0  cudaHostAlloc           
      0.0           614935        306      2009.6      1996.5       467      19344       1532.1  cudaStreamIsCapturing   
      0.0           202373        810       249.8       218.0       138       1199        110.6  cuGetProcAddress_v2     
      0.0            47789         36      1327.5       497.0       456      13006       2292.4  cudaEventCreateWithFlags
      0.0            22626         17      1330.9      1433.0       526       2032        435.6  cuLibraryGetKernel      
      0.0             7296          3      2432.0      2641.0      1994       2661        379.5  cuInit                  
      0.0             4561          3      1520.3       201.0       186       4174       2298.2  cuModuleGetLoadingMode  
      0.0             2123          2      1061.5      1061.5       652       1471        579.1  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     12.2        834301715       5820  143350.8   39200.0      1824    600093     179929.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      9.0        619226725       1440  430018.6  434622.5    406526    504030      16198.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      9.0        618206384      23295   26538.2    6720.0      1440    600797      75954.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      4.3        292313939        750  389751.9  394622.0    238271    426910      30986.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.3        291976859        780  374329.3  385310.5    232351    389854      39471.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      4.2        287989132        720  399984.9  397086.0    394270    470270      14507.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.1        279059407        720  387582.5  387486.0    384126    392318       1663.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      4.0        271288337       5145   52728.5   11520.0      2784    209247      79399.9  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.7        257243172      24480   10508.3    6816.0      1440     64160       9728.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      3.6        247826636        735  337179.1  328030.0    323135    877147      53852.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nn_align4>(T1::Params)             
      3.3        228221291        720  316974.0  315231.0    312511    404222      12102.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      3.3        224471953       8715   25757.0   26431.0      9856    257535      10873.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.2        222828116        735  303167.5  290174.0    284159    879643      60153.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      3.0        208952284       6855   30481.7   29344.0     15936    169503      13511.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.6        175943967        720  244366.6  243167.0    236607    279870       7190.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      2.5        173520459        720  241000.6  241935.0    234111    252447       3866.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      2.2        150350039       1440  104409.7  103871.0    101567    134687       3966.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      2.1        142173117        375  379128.3  385022.0    234207    388446      29464.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      1.9        130709990        375  348560.0  334558.0    331870    808604      61134.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      1.9        128717535       1440   89387.2   87808.0     85792    116607       6370.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      1.9        128575903       1440   89288.8   88863.0     87360    115103       3518.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      1.7        118084723        360  328013.1  321711.0    318623    418078      23133.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_tn_align4>(T1::Params)             
      1.5        105026366       7725   13595.6    3904.0      1280    175743      35643.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.5        104205878        360  289460.8  288767.0    282015    374270      12096.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      1.2         85035467        360  236209.6  236063.0    233599    240511       1322.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_nt_align4>(T1::Params)              
      1.2         82943251       7305   11354.3    6464.0      1472     63936       9785.7  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      1.2         82083505        360  228009.7  227935.0    225215    234463       1195.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      1.2         79442624        375  211847.0  213631.0    143296    229887      14065.6  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.8         54308121        360  150855.9  150783.0    147455    153120        756.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.7         50022950       3300   15158.5    4960.0      1632     97759      16741.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      0.6         39378190       3300   11932.8    4768.0      1599     64064      12145.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      0.5         33760866        360   93780.2   93728.0     92927     95072        413.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.4         26434548       4050    6527.0    4416.0      1472     64927       6990.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.2         14078018        360   39105.6   38880.0     38208     48768       1369.7  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2         13354250        735   18169.0   18080.0     17120     23104        689.5  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.2         11177516        750   14903.4   15072.0      2688     19712       1836.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2         10661234        720   14807.3   15760.0     12384     18656       1677.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          8686658        360   24129.6   24096.0     22272     28288        675.2  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          8137397        750   10849.9   10752.0      4352     14240       1159.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.1          6276832        735    8539.9    7872.0      7104     50976       4842.8  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1          4622376        375   12326.3   12480.0      7744     14592        966.2  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0          2439252        360    6775.7    6655.0      6432      8768        510.1  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          1924857        735    2618.9    2624.0      2240      3328        160.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0          1456791        735    1982.0    2080.0      1696      3136        239.3  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0          1451159        735    1974.4    1952.0      1919      2528        139.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           549372         15   36624.8   36479.0     35584     37664        588.9  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           316512         30   10550.4   10240.0      9824     11296        606.4  void at_cuda_detail::cub::DeviceRadixSortOnesweepKernel<at_cuda_detail::cub::DeviceRadixSortPolicy<…
      0.0           129856         15    8657.1    8576.0      8416      9856        341.9  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           120350         15    8023.3    7968.0      7776      9024        307.3  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            86239         30    2874.6    2848.0      2720      3552        191.3  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            54624         15    3641.6    3648.0      3584      3712         40.5  void at_cuda_detail::cub::DeviceRadixSortHistogramKernel<at_cuda_detail::cub::DeviceRadixSortPolicy…
      0.0            51040         15    3402.7    3392.0      3200      3584         87.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            41472         15    2764.8    2720.0      2688      3136        119.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            38336         15    2555.7    2560.0      2464      2592         26.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34720         15    2314.7    2336.0      2240      2336         39.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            32544         15    2169.6    2176.0      2048      2272         43.9  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            29119         15    1941.3    1920.0      1824      2048         83.5  void at_cuda_detail::cub::DeviceRadixSortExclusiveSumKernel<at_cuda_detail::cub::DeviceRadixSortPol…
      0.0            27200         15    1813.3    1824.0      1696      1856         39.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  --------  --------  --------  -----------  ------------------------------
     91.6        338921915    220  1540554.2  772812.0      1568   8618708    1566059.1  [CUDA memcpy Host-to-Device]  
      5.5         20274840    750    27033.1   26272.0     25504     62815       4974.4  [CUDA memcpy Device-to-Device]
      2.9         10580327   6600     1603.1    1824.0       992      3200        380.6  [CUDA memset]                 
      0.0            32191     15     2146.1    1888.0      1855      4000        679.2  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  12945.654    750    17.261    16.777    16.777    40.960        3.388  [CUDA memcpy Device-to-Device]
   1692.996    220     7.695     4.194     0.004    40.960        7.489  [CUDA memcpy Host-to-Device]  
      1.823   6600     0.000     0.000     0.000     0.004        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_1024.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_medium_1024.sqlite
SUCCESS: medium_1024
Profiling model_size=large context_size=128
device set to CUDA
MACHINE hpc
RUNNING SIZE large, CONTEXT_SIZE: 128
TRINING LOOP WITH:
vocab size 10000 context length 128
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x152f3cceb4c0>, {'FORWARD_PASS_TIME': [0.1385730789999684, 0.13786575500000708, 0.1373387709999747, 0.13815813299999036, 0.1439964309999482, 0.13669255099995326, 0.1378894140000284, 0.1353635379999787, 0.13596872300001905, 0.14030605299996068], 'BACKWARD_PASS_TIME': [0.17359040600001663, 0.17110388099996499, 0.16977359800000613, 0.1714463129999899, 0.17257166600001028, 0.17504410699996242, 0.1725209950000135, 0.17060966799999733, 0.1727938060000156, 0.17360513699998137]})
Collecting data...
Generating '/tmp/nsys-report-ef18.qdstrm'
[1/7] [0%                          ] auto_large_128.nsys-rep[1/7] [0%                          ] auto_large_128.nsys-rep[1/7] [0%                          ] auto_large_128.nsys-rep[1/7] [0%                          ] auto_large_128.nsys-rep[1/7] [13%                         ] auto_large_128.nsys-rep[1/7] [11%                         ] auto_large_128.nsys-rep[1/7] [=16%                        ] auto_large_128.nsys-rep[1/7] [=15%                        ] auto_large_128.nsys-rep[1/7] [14%                         ] auto_large_128.nsys-rep[1/7] [12%                         ] auto_large_128.nsys-rep[1/7] [=15%                        ] auto_large_128.nsys-rep[1/7] [14%                         ] auto_large_128.nsys-rep[1/7] [13%                         ] auto_large_128.nsys-rep[1/7] [12%                         ] auto_large_128.nsys-rep[1/7] [11%                         ] auto_large_128.nsys-rep[1/7] [10%                         ] auto_large_128.nsys-rep[1/7] [9%                          ] auto_large_128.nsys-rep[1/7] [8%                          ] auto_large_128.nsys-rep[1/7] [7%                          ] auto_large_128.nsys-rep[1/7] [9%                          ] auto_large_128.nsys-rep[1/7] [11%                         ] auto_large_128.nsys-rep[1/7] [13%                         ] auto_large_128.nsys-rep[1/7] [=15%                        ] auto_large_128.nsys-rep[1/7] [=17%                        ] auto_large_128.nsys-rep[1/7] [==19%                       ] auto_large_128.nsys-rep[1/7] [==21%                       ] auto_large_128.nsys-rep[1/7] [===23%                      ] auto_large_128.nsys-rep[1/7] [====25%                     ] auto_large_128.nsys-rep[1/7] [====27%                     ] auto_large_128.nsys-rep[1/7] [=====29%                    ] auto_large_128.nsys-rep[1/7] [=====31%                    ] auto_large_128.nsys-rep[1/7] [=====32%                    ] auto_large_128.nsys-rep[1/7] [======34%                   ] auto_large_128.nsys-rep[1/7] [=======36%                  ] auto_large_128.nsys-rep[1/7] [=======38%                  ] auto_large_128.nsys-rep[1/7] [========40%                 ] auto_large_128.nsys-rep[1/7] [========42%                 ] auto_large_128.nsys-rep[1/7] [=========44%                ] auto_large_128.nsys-rep[1/7] [=========46%                ] auto_large_128.nsys-rep[1/7] [==========48%               ] auto_large_128.nsys-rep[1/7] [===========50%              ] auto_large_128.nsys-rep[1/7] [===========51%              ] auto_large_128.nsys-rep[1/7] [===========52%              ] auto_large_128.nsys-rep[1/7] [===========53%              ] auto_large_128.nsys-rep[1/7] [============54%             ] auto_large_128.nsys-rep[1/7] [========================100%] auto_large_128.nsys-rep[1/7] [========================100%] auto_large_128.nsys-rep
[2/7] [0%                          ] auto_large_128.sqlite[2/7] [1%                          ] auto_large_128.sqlite[2/7] [2%                          ] auto_large_128.sqlite[2/7] [3%                          ] auto_large_128.sqlite[2/7] [4%                          ] auto_large_128.sqlite[2/7] [5%                          ] auto_large_128.sqlite[2/7] [6%                          ] auto_large_128.sqlite[2/7] [7%                          ] auto_large_128.sqlite[2/7] [8%                          ] auto_large_128.sqlite[2/7] [9%                          ] auto_large_128.sqlite[2/7] [10%                         ] auto_large_128.sqlite[2/7] [11%                         ] auto_large_128.sqlite[2/7] [12%                         ] auto_large_128.sqlite[2/7] [13%                         ] auto_large_128.sqlite[2/7] [14%                         ] auto_large_128.sqlite[2/7] [=15%                        ] auto_large_128.sqlite[2/7] [=16%                        ] auto_large_128.sqlite[2/7] [=17%                        ] auto_large_128.sqlite[2/7] [==18%                       ] auto_large_128.sqlite[2/7] [==19%                       ] auto_large_128.sqlite[2/7] [==20%                       ] auto_large_128.sqlite[2/7] [==21%                       ] auto_large_128.sqlite[2/7] [===22%                      ] auto_large_128.sqlite[2/7] [===23%                      ] auto_large_128.sqlite[2/7] [===24%                      ] auto_large_128.sqlite[2/7] [====25%                     ] auto_large_128.sqlite[2/7] [====26%                     ] auto_large_128.sqlite[2/7] [====27%                     ] auto_large_128.sqlite[2/7] [====28%                     ] auto_large_128.sqlite[2/7] [=====29%                    ] auto_large_128.sqlite[2/7] [=====30%                    ] auto_large_128.sqlite[2/7] [=====31%                    ] auto_large_128.sqlite[2/7] [=====32%                    ] auto_large_128.sqlite[2/7] [======33%                   ] auto_large_128.sqlite[2/7] [======34%                   ] auto_large_128.sqlite[2/7] [======35%                   ] auto_large_128.sqlite[2/7] [=======36%                  ] auto_large_128.sqlite[2/7] [=======37%                  ] auto_large_128.sqlite[2/7] [=======38%                  ] auto_large_128.sqlite[2/7] [=======39%                  ] auto_large_128.sqlite[2/7] [========40%                 ] auto_large_128.sqlite[2/7] [========41%                 ] auto_large_128.sqlite[2/7] [========42%                 ] auto_large_128.sqlite[2/7] [=========43%                ] auto_large_128.sqlite[2/7] [=========44%                ] auto_large_128.sqlite[2/7] [=========45%                ] auto_large_128.sqlite[2/7] [=========46%                ] auto_large_128.sqlite[2/7] [==========47%               ] auto_large_128.sqlite[2/7] [==========48%               ] auto_large_128.sqlite[2/7] [==========49%               ] auto_large_128.sqlite[2/7] [===========50%              ] auto_large_128.sqlite[2/7] [===========51%              ] auto_large_128.sqlite[2/7] [===========52%              ] auto_large_128.sqlite[2/7] [===========53%              ] auto_large_128.sqlite[2/7] [============54%             ] auto_large_128.sqlite[2/7] [============55%             ] auto_large_128.sqlite[2/7] [============56%             ] auto_large_128.sqlite[2/7] [============57%             ] auto_large_128.sqlite[2/7] [=============58%            ] auto_large_128.sqlite[2/7] [=============59%            ] auto_large_128.sqlite[2/7] [=============60%            ] auto_large_128.sqlite[2/7] [==============61%           ] auto_large_128.sqlite[2/7] [==============62%           ] auto_large_128.sqlite[2/7] [==============63%           ] auto_large_128.sqlite[2/7] [==============64%           ] auto_large_128.sqlite[2/7] [===============65%          ] auto_large_128.sqlite[2/7] [===============66%          ] auto_large_128.sqlite[2/7] [===============67%          ] auto_large_128.sqlite[2/7] [================68%         ] auto_large_128.sqlite[2/7] [================69%         ] auto_large_128.sqlite[2/7] [================70%         ] auto_large_128.sqlite[2/7] [================71%         ] auto_large_128.sqlite[2/7] [=================72%        ] auto_large_128.sqlite[2/7] [=================73%        ] auto_large_128.sqlite[2/7] [=================74%        ] auto_large_128.sqlite[2/7] [==================75%       ] auto_large_128.sqlite[2/7] [==================76%       ] auto_large_128.sqlite[2/7] [==================77%       ] auto_large_128.sqlite[2/7] [==================78%       ] auto_large_128.sqlite[2/7] [===================79%      ] auto_large_128.sqlite[2/7] [===================80%      ] auto_large_128.sqlite[2/7] [===================81%      ] auto_large_128.sqlite[2/7] [===================82%      ] auto_large_128.sqlite[2/7] [====================83%     ] auto_large_128.sqlite[2/7] [====================84%     ] auto_large_128.sqlite[2/7] [====================85%     ] auto_large_128.sqlite[2/7] [=====================86%    ] auto_large_128.sqlite[2/7] [=====================87%    ] auto_large_128.sqlite[2/7] [=====================88%    ] auto_large_128.sqlite[2/7] [=====================89%    ] auto_large_128.sqlite[2/7] [======================90%   ] auto_large_128.sqlite[2/7] [======================91%   ] auto_large_128.sqlite[2/7] [======================92%   ] auto_large_128.sqlite[2/7] [=======================93%  ] auto_large_128.sqlite[2/7] [=======================94%  ] auto_large_128.sqlite[2/7] [=======================95%  ] auto_large_128.sqlite[2/7] [=======================96%  ] auto_large_128.sqlite[2/7] [========================97% ] auto_large_128.sqlite[2/7] [========================98% ] auto_large_128.sqlite[2/7] [========================99% ] auto_large_128.sqlite[2/7] [========================100%] auto_large_128.sqlite[2/7] [========================100%] auto_large_128.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     42.7       3087112539          1  3087112539.0  3087112539.0  3087112539  3087112539          0.0  PushPop  :WARM_UP       
     23.8       1722034403         10   172203440.3   172439865.0   169678724   174925365    1578623.5  PushPop  :BACKWARD_PASS 
     19.1       1381096066         10   138109606.6   137781114.5   135258917   143895395    2458507.9  PushPop  :FORWARD_PASS  
     14.4       1039208592         10   103920859.2   103640038.5   102988719   106223670     961522.6  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     55.8       1499873046     169200     8864.5     6158.0      4768  63157603     207032.2  cudaLaunchKernel        
     31.8        855054614       1453   588475.3    17170.0      7184  10959068    1537427.9  cudaMemcpyAsync         
      4.6        124935024      14625     8542.6     7786.0      5354     61283       3175.5  cuLaunchKernel          
      4.6        122761924        773   158812.3   159548.0      5914    743920      40705.0  cudaMalloc              
      0.9         24306678       4905     4955.5     3880.0      3183     28205       2482.0  cudaMemsetAsync         
      0.7         20039594      14625     1370.2      957.0       439   4585144      37985.0  cuKernelGetFunction     
      0.7         18192990        343    53040.8    53652.0      8487    102807      30356.1  cudaStreamSynchronize   
      0.6         15630578          4  3907644.5  4669841.5   1239616   5051279    1788952.0  cuLibraryLoadData       
      0.1          2610194          2  1305097.0  1305097.0      2699   2607495    1841868.9  cudaFree                
      0.1          1541502        827     1864.0     1716.0       457     18870       1475.1  cudaStreamIsCapturing   
      0.1          1432170          1  1432170.0  1432170.0   1432170   1432170          0.0  cudaGetDeviceProperties 
      0.0          1161570          1  1161570.0  1161570.0   1161570   1161570          0.0  cudaHostAlloc           
      0.0           394492         20    19724.6    15789.0     12860     39789       8067.4  cudaDeviceSynchronize   
      0.0           199657        810      246.5      209.0       130      4790        193.5  cuGetProcAddress_v2     
      0.0            80541         36     2237.3      509.0       459     20628       4239.0  cudaEventCreateWithFlags
      0.0            30108         16     1881.8     1336.0       627     11538       2611.2  cuLibraryGetKernel      
      0.0             6865          3     2288.3     2226.0      1945      2694        378.4  cuInit                  
      0.0             4198          3     1399.3      208.0       183      3807       2085.1  cuModuleGetLoadingMode  
      0.0             1968          2      984.0      984.0       614      1354        523.3  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     18.7        550737800      34815   15819.0    5440.0      1439    119871      23312.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     17.6        517128909      31635   16346.7    8352.0      1472     78399      16507.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      7.7        226723975      10275   22065.6    6912.0      5152    214527      28077.5  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.1        179501541      17940   10005.7    6208.0      3008     82943      10794.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.7        167395475      10905   15350.3    9248.0      1471     78784      14848.2  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      4.3        127341228       4920   25882.4    7744.0      1727    119839      28505.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.9        115302536       1635   70521.4   68767.0     67392    168575       7751.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      3.4        100220136       1095   91525.2   89663.0     88159    161152       7097.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      3.1         90735411      11505    7886.6    5056.0      1280     37568       6903.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      3.0         89498893       8700   10287.2    5536.0      1472     25792       8436.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.8         83677248       7665   10916.8    7808.0      3039     59264       7881.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.8         83271360       4920   16925.1    5856.0      1600     80192      17797.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      2.8         83027590       2160   38438.7   37903.5     37119     49952       2735.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      2.8         81819812       6030   13568.8    5440.0      1472     78304      16523.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      2.7         79687283       1080   73784.5   72671.5     71168     94048       5223.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      2.0         59348456       2160   27476.1   26976.0     26368     36608       2009.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_nn_align4>(T1::Params)              
      1.6         48001638       2160   22223.0   21888.0     20832     28544       1425.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      1.5         45083782        540   83488.5   81760.0     81055    107776       6066.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x128_32x6_tn_align4>(T1::Params)              
      1.3         39527291        540   73198.7   72127.0     70367     93216       5172.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      0.8         22844091       2160   10576.0    9856.0      8384     15264       1473.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.6         17941639       1095   16385.1   16096.0     15680     20960       1104.5  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.4         12862019        540   23818.6   23808.0     22752     24863        302.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.4         10388157       1080    9618.7   10080.0      8224     12672       1075.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.4         10317393       1080    9553.1    9760.0      8288     12288        763.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_tn_align4>(T1::Params)               
      0.3          9758183       1080    9035.4    8927.5      8480     11744        639.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          9541002       1080    8834.3    9024.0      7712     12160        914.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.3          9102830       1110    8200.7    7456.0      7264     36704       3748.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          8129403       1110    7323.8    7264.0      3712      9504        658.6  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.3          7390765        555   13316.7   12736.0     12448     30559       2280.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.2          6916491       1140    6067.1    5248.0      4832     23552       3203.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.2          6129790       1095    5598.0    5856.0      4864     12512        846.8  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.2          5735002        540   10620.4   10400.0     10272     13664        754.3  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2          5606860       1080    5191.5    5120.0      4672      6880        344.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.2          5319084       1110    4792.0    4736.0      2272      6336        447.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          4488490        540    8312.0    8192.0      7456     11200        671.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.2          4452714       1080    4122.9    4096.0      3808      5600        305.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          3582793        555    6455.5    6400.0      4992      8447        433.6  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1          3397401        540    6291.5    6176.0      6048      8000        433.6  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          3218033        555    5798.3    5280.0      4928     23296       2775.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.1          1866230        540    3456.0    3424.0      3296      4448        257.9  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          1832986       1095    1674.0    1664.0      1536      2176        122.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.1          1802971       1095    1646.5    1632.0      1503      2560        129.3  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.1          1671612       1095    1526.6    1472.0      1344      2432        156.8  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.1          1665786         15  111052.4  109248.0    108735    136288       6986.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      0.0           142719         15    9514.6    9504.0      8928     10848        463.5  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           133727         15    8915.1    8768.0      8639     11200        634.6  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0            88736         15    5915.7    5856.0      5504      7392        442.7  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            85855         30    2861.8    2879.5      2624      3456        233.3  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            60544         15    4036.3    3936.0      3872      4800        244.3  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            44799         15    2986.6    2944.0      2784      3680        215.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34975         15    2331.7    2304.0      2048      2976        211.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            33760         15    2250.7    2240.0      2080      2720        152.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            33600         15    2240.0    2208.0      2080      2752        174.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            33504         15    2233.6    2176.0      2144      2752        152.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            27840         15    1856.0    1824.0      1728      2240        111.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     98.7        788708318    328  2404598.5  1242681.5      1632  10763850    2322690.4  [CUDA memcpy Host-to-Device]  
      0.7          5407523   4905     1102.5     1056.0       992      2816        189.6  [CUDA memset]                 
      0.6          5004102   1110     4508.2     3456.0      3296     77344       8419.9  [CUDA memcpy Device-to-Device]
      0.0            34624     15     2308.3     1888.0      1824      4352        849.5  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   3877.680    328    11.822     6.554     0.005    51.200       11.033  [CUDA memcpy Host-to-Device]  
   3638.477   1110     3.278     2.621     2.621    51.200        5.611  [CUDA memcpy Device-to-Device]
      0.190   4905     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_128.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_128.sqlite
SUCCESS: large_128
Profiling model_size=large context_size=256
device set to CUDA
MACHINE hpc
RUNNING SIZE large, CONTEXT_SIZE: 256
TRINING LOOP WITH:
vocab size 10000 context length 256
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x151c44e63240>, {'FORWARD_PASS_TIME': [0.14097756600000366, 0.1380147120000288, 0.13620485199999166, 0.1379413809999619, 0.1456254089999902, 0.13939962899996772, 0.13911301600001025, 0.13827097899996943, 0.1389934179999841, 0.14488185199996906], 'BACKWARD_PASS_TIME': [0.17091631499999949, 0.17049932899999476, 0.1716468030000442, 0.17122376499997927, 0.17511786400001483, 0.17253804299997455, 0.17046977699999388, 0.17040148799998178, 0.17058491500000628, 0.17135841700002175]})
Collecting data...
Generating '/tmp/nsys-report-fa77.qdstrm'
[1/7] [0%                          ] auto_large_256.nsys-rep[1/7] [0%                          ] auto_large_256.nsys-rep[1/7] [0%                          ] auto_large_256.nsys-rep[1/7] [0%                          ] auto_large_256.nsys-rep[1/7] [13%                         ] auto_large_256.nsys-rep[1/7] [12%                         ] auto_large_256.nsys-rep[1/7] [=17%                        ] auto_large_256.nsys-rep[1/7] [=15%                        ] auto_large_256.nsys-rep[1/7] [14%                         ] auto_large_256.nsys-rep[1/7] [13%                         ] auto_large_256.nsys-rep[1/7] [=15%                        ] auto_large_256.nsys-rep[1/7] [14%                         ] auto_large_256.nsys-rep[1/7] [13%                         ] auto_large_256.nsys-rep[1/7] [12%                         ] auto_large_256.nsys-rep[1/7] [11%                         ] auto_large_256.nsys-rep[1/7] [10%                         ] auto_large_256.nsys-rep[1/7] [9%                          ] auto_large_256.nsys-rep[1/7] [8%                          ] auto_large_256.nsys-rep[1/7] [7%                          ] auto_large_256.nsys-rep[1/7] [9%                          ] auto_large_256.nsys-rep[1/7] [11%                         ] auto_large_256.nsys-rep[1/7] [13%                         ] auto_large_256.nsys-rep[1/7] [=15%                        ] auto_large_256.nsys-rep[1/7] [=17%                        ] auto_large_256.nsys-rep[1/7] [==19%                       ] auto_large_256.nsys-rep[1/7] [==21%                       ] auto_large_256.nsys-rep[1/7] [===23%                      ] auto_large_256.nsys-rep[1/7] [====25%                     ] auto_large_256.nsys-rep[1/7] [====27%                     ] auto_large_256.nsys-rep[1/7] [====28%                     ] auto_large_256.nsys-rep[1/7] [=====30%                    ] auto_large_256.nsys-rep[1/7] [=====32%                    ] auto_large_256.nsys-rep[1/7] [======34%                   ] auto_large_256.nsys-rep[1/7] [=======36%                  ] auto_large_256.nsys-rep[1/7] [=======38%                  ] auto_large_256.nsys-rep[1/7] [========40%                 ] auto_large_256.nsys-rep[1/7] [========42%                 ] auto_large_256.nsys-rep[1/7] [=========44%                ] auto_large_256.nsys-rep[1/7] [=========46%                ] auto_large_256.nsys-rep[1/7] [==========48%               ] auto_large_256.nsys-rep[1/7] [===========50%              ] auto_large_256.nsys-rep[1/7] [===========51%              ] auto_large_256.nsys-rep[1/7] [===========52%              ] auto_large_256.nsys-rep[1/7] [===========53%              ] auto_large_256.nsys-rep[1/7] [============54%             ] auto_large_256.nsys-rep[1/7] [========================100%] auto_large_256.nsys-rep[1/7] [========================100%] auto_large_256.nsys-rep
[2/7] [0%                          ] auto_large_256.sqlite[2/7] [1%                          ] auto_large_256.sqlite[2/7] [2%                          ] auto_large_256.sqlite[2/7] [3%                          ] auto_large_256.sqlite[2/7] [4%                          ] auto_large_256.sqlite[2/7] [5%                          ] auto_large_256.sqlite[2/7] [6%                          ] auto_large_256.sqlite[2/7] [7%                          ] auto_large_256.sqlite[2/7] [8%                          ] auto_large_256.sqlite[2/7] [9%                          ] auto_large_256.sqlite[2/7] [10%                         ] auto_large_256.sqlite[2/7] [11%                         ] auto_large_256.sqlite[2/7] [12%                         ] auto_large_256.sqlite[2/7] [13%                         ] auto_large_256.sqlite[2/7] [14%                         ] auto_large_256.sqlite[2/7] [=15%                        ] auto_large_256.sqlite[2/7] [=16%                        ] auto_large_256.sqlite[2/7] [=17%                        ] auto_large_256.sqlite[2/7] [==18%                       ] auto_large_256.sqlite[2/7] [==19%                       ] auto_large_256.sqlite[2/7] [==20%                       ] auto_large_256.sqlite[2/7] [==21%                       ] auto_large_256.sqlite[2/7] [===22%                      ] auto_large_256.sqlite[2/7] [===23%                      ] auto_large_256.sqlite[2/7] [===24%                      ] auto_large_256.sqlite[2/7] [====25%                     ] auto_large_256.sqlite[2/7] [====26%                     ] auto_large_256.sqlite[2/7] [====27%                     ] auto_large_256.sqlite[2/7] [====28%                     ] auto_large_256.sqlite[2/7] [=====29%                    ] auto_large_256.sqlite[2/7] [=====30%                    ] auto_large_256.sqlite[2/7] [=====31%                    ] auto_large_256.sqlite[2/7] [=====32%                    ] auto_large_256.sqlite[2/7] [======33%                   ] auto_large_256.sqlite[2/7] [======34%                   ] auto_large_256.sqlite[2/7] [======35%                   ] auto_large_256.sqlite[2/7] [=======36%                  ] auto_large_256.sqlite[2/7] [=======37%                  ] auto_large_256.sqlite[2/7] [=======38%                  ] auto_large_256.sqlite[2/7] [=======39%                  ] auto_large_256.sqlite[2/7] [========40%                 ] auto_large_256.sqlite[2/7] [========41%                 ] auto_large_256.sqlite[2/7] [========42%                 ] auto_large_256.sqlite[2/7] [=========43%                ] auto_large_256.sqlite[2/7] [=========44%                ] auto_large_256.sqlite[2/7] [=========45%                ] auto_large_256.sqlite[2/7] [=========46%                ] auto_large_256.sqlite[2/7] [==========47%               ] auto_large_256.sqlite[2/7] [==========48%               ] auto_large_256.sqlite[2/7] [==========49%               ] auto_large_256.sqlite[2/7] [===========50%              ] auto_large_256.sqlite[2/7] [===========51%              ] auto_large_256.sqlite[2/7] [===========52%              ] auto_large_256.sqlite[2/7] [===========53%              ] auto_large_256.sqlite[2/7] [============54%             ] auto_large_256.sqlite[2/7] [============55%             ] auto_large_256.sqlite[2/7] [============56%             ] auto_large_256.sqlite[2/7] [============57%             ] auto_large_256.sqlite[2/7] [=============58%            ] auto_large_256.sqlite[2/7] [=============59%            ] auto_large_256.sqlite[2/7] [=============60%            ] auto_large_256.sqlite[2/7] [==============61%           ] auto_large_256.sqlite[2/7] [==============62%           ] auto_large_256.sqlite[2/7] [==============63%           ] auto_large_256.sqlite[2/7] [==============64%           ] auto_large_256.sqlite[2/7] [===============65%          ] auto_large_256.sqlite[2/7] [===============66%          ] auto_large_256.sqlite[2/7] [===============67%          ] auto_large_256.sqlite[2/7] [================68%         ] auto_large_256.sqlite[2/7] [================69%         ] auto_large_256.sqlite[2/7] [================70%         ] auto_large_256.sqlite[2/7] [================71%         ] auto_large_256.sqlite[2/7] [=================72%        ] auto_large_256.sqlite[2/7] [=================73%        ] auto_large_256.sqlite[2/7] [=================74%        ] auto_large_256.sqlite[2/7] [==================75%       ] auto_large_256.sqlite[2/7] [==================76%       ] auto_large_256.sqlite[2/7] [==================77%       ] auto_large_256.sqlite[2/7] [==================78%       ] auto_large_256.sqlite[2/7] [===================79%      ] auto_large_256.sqlite[2/7] [===================80%      ] auto_large_256.sqlite[2/7] [===================81%      ] auto_large_256.sqlite[2/7] [===================82%      ] auto_large_256.sqlite[2/7] [====================83%     ] auto_large_256.sqlite[2/7] [====================84%     ] auto_large_256.sqlite[2/7] [====================85%     ] auto_large_256.sqlite[2/7] [=====================86%    ] auto_large_256.sqlite[2/7] [=====================87%    ] auto_large_256.sqlite[2/7] [=====================88%    ] auto_large_256.sqlite[2/7] [=====================89%    ] auto_large_256.sqlite[2/7] [======================90%   ] auto_large_256.sqlite[2/7] [======================91%   ] auto_large_256.sqlite[2/7] [======================92%   ] auto_large_256.sqlite[2/7] [=======================93%  ] auto_large_256.sqlite[2/7] [=======================94%  ] auto_large_256.sqlite[2/7] [=======================95%  ] auto_large_256.sqlite[2/7] [=======================96%  ] auto_large_256.sqlite[2/7] [========================97% ] auto_large_256.sqlite[2/7] [========================98% ] auto_large_256.sqlite[2/7] [========================99% ] auto_large_256.sqlite[2/7] [========================100%] auto_large_256.sqlite[2/7] [========================100%] auto_large_256.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     42.7       3102581662          1  3102581662.0  3102581662.0  3102581662  3102581662          0.0  PushPop  :WARM_UP       
     23.6       1713752507         10   171375250.7   170956961.5   170313652   175000574    1436066.0  PushPop  :BACKWARD_PASS 
     19.2       1397364150         10   139736415.0   138849669.0   135997150   145422062    3056933.0  PushPop  :FORWARD_PASS  
     14.5       1055418394         10   105541839.4   105652218.0   103971840   108071130    1113740.4  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     55.1       1516886679     169200     8965.1     6269.0      4686  63663093     208263.9  cudaLaunchKernel        
     31.1        856584779       1453   589528.4    16470.0      6599  10965929    1540940.5  cudaMemcpyAsync         
      5.5        149989989        860   174407.0   172226.0      6096    773283      38575.9  cudaMalloc              
      4.6        127525884      14625     8719.7     8000.0      5268    370411       4336.8  cuLaunchKernel          
      1.4         38304653       6540     5857.0     4281.0      3190     70085       2933.2  cudaMemsetAsync         
      0.7         20306652      14625     1388.5      978.0       469   4675772      38747.7  cuKernelGetFunction     
      0.6         17694063        343    51586.2    52500.0      7225     93729      30164.4  cudaStreamSynchronize   
      0.6         15794340          4  3948585.0  4719236.5   1265374   5090493    1799371.0  cuLibraryLoadData       
      0.1          2627424          2  1313712.0  1313712.0      2729   2624695    1854009.9  cudaFree                
      0.1          1684713        914     1843.2     1745.5       478     22389       1249.8  cudaStreamIsCapturing   
      0.1          1444059         20    72202.9    58821.0     13356    144292      58713.5  cudaDeviceSynchronize   
      0.1          1421895          1  1421895.0  1421895.0   1421895   1421895          0.0  cudaGetDeviceProperties 
      0.0          1177131          1  1177131.0  1177131.0   1177131   1177131          0.0  cudaHostAlloc           
      0.0           192267        810      237.4      205.5       136      1112        104.3  cuGetProcAddress_v2     
      0.0            51178         36     1421.6      476.0       453     17304       3038.8  cudaEventCreateWithFlags
      0.0            30562         16     1910.1     1303.0       634     11394       2565.8  cuLibraryGetKernel      
      0.0             7949          3     2649.7     2639.0      2464      2846        191.2  cuInit                  
      0.0             4110          3     1370.0      258.0       217      3635       1961.7  cuModuleGetLoadingMode  
      0.0             1698          2      849.0      849.0       565      1133        401.6  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     16.0        608297156      34815   17472.3    6848.0      1440    119424      23579.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     13.6        516803080      31635   16336.4    8352.0      1440     79008      16411.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      6.5        246845639      10275   24023.9   10432.0      7072    183903      27161.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.1        233075395       1635  142553.8  141824.0    138655    223487       7197.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      5.9        224694136       8700   25826.9    9855.5      1504     48832      19888.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      5.8        220255219      17940   12277.3    9984.0      3008     78784      10121.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.4        168835247      10905   15482.4    9184.0      1472     79232      14703.3  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      3.8        146563224       1095  133847.7  130431.0    128831    249663      14880.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      3.6        136414282       1080  126309.5  124352.0    122816    160415       8139.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nt_align4>(T1::Params)             
      3.3        127185844       4920   25850.8    8000.0      1632    120351      28467.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.7        102020703       7665   13309.9    8064.0      3039     58591       8989.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.4         93305098      11505    8110.0    5088.0      1280     36064       6745.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      2.3         87114211       2160   40330.7   39648.0     38784     52928       2804.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_nn_align4>(T1::Params)             
      2.2         84571161       2160   39153.3   39040.0     37984     42304        715.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      2.2         83273234       4920   16925.5    6016.0      1600     78943      17767.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      2.1         81800124       6030   13565.5    5664.0      1472     78336      16462.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      2.1         80726560       2160   37373.4   37775.5     33344     46336       2578.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.0         77387424       2160   35827.5   35264.0     34080     46752       2483.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      2.0         76681368        540  142002.5  139871.5    137599    183871       9791.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      1.8         67213614        540  124469.7  122367.0    121440    159648       8364.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nt_align4>(T1::Params)             
      0.9         36040415       1080   33370.8   33120.0     32448     40320       1193.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.9         33049921       1110   29774.7   28896.0     27936     60128       4940.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.8         31452349       1140   27589.8   29376.0     20128     62240       8673.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.8         30416609       1080   28163.5   28064.0     26464     35296       1252.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      0.7         27896189       1080   25829.8   26752.0     21760     32000       3019.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.7         26422893        540   48931.3   48896.0     47424     50976        775.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.7         25817581       1080   23905.2   23904.0     22624     26240        437.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.6         24081042       1080   22297.3   22591.5     18592     25952       1906.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.4         15394108        555   27737.1   27168.0     26752     47808       3121.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.3         13242851        555   23861.0   22912.0     21184     59167       5760.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.3         12048903        540   22312.8   22272.0     21728     23360        284.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.3         11679370       1095   10666.1   10528.0     10112     14240        666.0  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.2          8390106        540   15537.2   15264.0     15104     20000       1041.1  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2          8043586       1110    7246.5    7360.0      3872      7936        443.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2          7454786       1110    6716.0    6656.0      2656      8704        649.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          6825573       1095    6233.4    6336.0      5248     17504       1301.2  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.2          6491842       1080    6011.0    6592.0      4800      8640        896.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          4833096        540    8950.2    8800.0      8640     11584        606.8  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          3941716        555    7102.2    6976.0      6528      9280        455.3  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1          3621551         15  241436.7  240734.0    240159    251199       2734.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      0.1          2162676        540    4005.0    3968.0      3776      4352        102.5  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          2009786       1095    1835.4    1792.0      1664      2496        122.9  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0          1822963       1095    1664.8    1632.0      1504      2335        123.5  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0          1819126       1095    1661.3    1664.0      1536      1792         35.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           218399         15   14559.9   14495.0     14240     15040        205.6  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           138080         15    9205.3    9216.0      9088      9312         60.1  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           116416         15    7761.1    7712.0      7264      8096        253.1  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            96320         15    6421.3    6464.0      5856      6976        377.2  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            86336         30    2877.9    2848.0      2656      3328        152.2  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            46176         15    3078.4    3008.0      2912      3840        221.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            35872         15    2391.5    2432.0      2208      2624        107.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            34208         15    2280.5    2240.0      2112      2944        190.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34048         15    2269.9    2240.0      2144      2784        152.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            32255         15    2150.3    2175.0      2048      2208         45.5  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            27168         15    1811.2    1824.0      1696      1856         44.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     98.0        790856055    328  2411146.5  1241882.0      1312  10794157    2327085.5  [CUDA memcpy Host-to-Device]  
      1.0          7930344   1110     7144.5     6144.0      4896     77056       8111.2  [CUDA memcpy Device-to-Device]
      1.0          7812090   6540     1194.5     1056.0       991      9728        324.9  [CUDA memset]                 
      0.0            36384     15     2425.6     1984.0      1856      4160        843.2  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   6508.954   1110     5.864     5.243     5.243    51.200        5.309  [CUDA memcpy Device-to-Device]
   3877.713    328    11.822     6.554     0.005    51.200       11.033  [CUDA memcpy Host-to-Device]  
      0.496   6540     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_256.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_256.sqlite
SUCCESS: large_256
Profiling model_size=large context_size=512
device set to CUDA
MACHINE hpc
RUNNING SIZE large, CONTEXT_SIZE: 512
TRINING LOOP WITH:
vocab size 10000 context length 512
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x148c7ee171a0>, {'FORWARD_PASS_TIME': [0.1405359620000013, 0.13832867299998952, 0.13699753399998826, 0.13624043699996946, 0.14377981399996997, 0.13687208499999315, 0.1393286059999923, 0.1366392420000011, 0.1363137910000205, 0.1399043160000133], 'BACKWARD_PASS_TIME': [0.21679934700000558, 0.2162559559999977, 0.21638784599997507, 0.21730819100002918, 0.2175202859999672, 0.21715419000003067, 0.21716408099996443, 0.21645558800003073, 0.21730574299999716, 0.2206340679999812]})
Collecting data...
Generating '/tmp/nsys-report-26f9.qdstrm'
[1/7] [0%                          ] auto_large_512.nsys-rep[1/7] [0%                          ] auto_large_512.nsys-rep[1/7] [0%                          ] auto_large_512.nsys-rep[1/7] [13%                         ] auto_large_512.nsys-rep[1/7] [11%                         ] auto_large_512.nsys-rep[1/7] [=16%                        ] auto_large_512.nsys-rep[1/7] [=15%                        ] auto_large_512.nsys-rep[1/7] [14%                         ] auto_large_512.nsys-rep[1/7] [12%                         ] auto_large_512.nsys-rep[1/7] [=15%                        ] auto_large_512.nsys-rep[1/7] [14%                         ] auto_large_512.nsys-rep[1/7] [13%                         ] auto_large_512.nsys-rep[1/7] [12%                         ] auto_large_512.nsys-rep[1/7] [11%                         ] auto_large_512.nsys-rep[1/7] [10%                         ] auto_large_512.nsys-rep[1/7] [9%                          ] auto_large_512.nsys-rep[1/7] [8%                          ] auto_large_512.nsys-rep[1/7] [7%                          ] auto_large_512.nsys-rep[1/7] [9%                          ] auto_large_512.nsys-rep[1/7] [11%                         ] auto_large_512.nsys-rep[1/7] [13%                         ] auto_large_512.nsys-rep[1/7] [=15%                        ] auto_large_512.nsys-rep[1/7] [=17%                        ] auto_large_512.nsys-rep[1/7] [==19%                       ] auto_large_512.nsys-rep[1/7] [==21%                       ] auto_large_512.nsys-rep[1/7] [===23%                      ] auto_large_512.nsys-rep[1/7] [====25%                     ] auto_large_512.nsys-rep[1/7] [====27%                     ] auto_large_512.nsys-rep[1/7] [====28%                     ] auto_large_512.nsys-rep[1/7] [=====30%                    ] auto_large_512.nsys-rep[1/7] [=====32%                    ] auto_large_512.nsys-rep[1/7] [======34%                   ] auto_large_512.nsys-rep[1/7] [=======36%                  ] auto_large_512.nsys-rep[1/7] [=======38%                  ] auto_large_512.nsys-rep[1/7] [========40%                 ] auto_large_512.nsys-rep[1/7] [========42%                 ] auto_large_512.nsys-rep[1/7] [=========44%                ] auto_large_512.nsys-rep[1/7] [=========46%                ] auto_large_512.nsys-rep[1/7] [==========48%               ] auto_large_512.nsys-rep[1/7] [===========50%              ] auto_large_512.nsys-rep[1/7] [===========51%              ] auto_large_512.nsys-rep[1/7] [===========52%              ] auto_large_512.nsys-rep[1/7] [===========53%              ] auto_large_512.nsys-rep[1/7] [============54%             ] auto_large_512.nsys-rep[1/7] [========================100%] auto_large_512.nsys-rep[1/7] [========================100%] auto_large_512.nsys-rep
[2/7] [0%                          ] auto_large_512.sqlite[2/7] [1%                          ] auto_large_512.sqlite[2/7] [2%                          ] auto_large_512.sqlite[2/7] [3%                          ] auto_large_512.sqlite[2/7] [4%                          ] auto_large_512.sqlite[2/7] [5%                          ] auto_large_512.sqlite[2/7] [6%                          ] auto_large_512.sqlite[2/7] [7%                          ] auto_large_512.sqlite[2/7] [8%                          ] auto_large_512.sqlite[2/7] [9%                          ] auto_large_512.sqlite[2/7] [10%                         ] auto_large_512.sqlite[2/7] [11%                         ] auto_large_512.sqlite[2/7] [12%                         ] auto_large_512.sqlite[2/7] [13%                         ] auto_large_512.sqlite[2/7] [14%                         ] auto_large_512.sqlite[2/7] [=15%                        ] auto_large_512.sqlite[2/7] [=16%                        ] auto_large_512.sqlite[2/7] [=17%                        ] auto_large_512.sqlite[2/7] [==18%                       ] auto_large_512.sqlite[2/7] [==19%                       ] auto_large_512.sqlite[2/7] [==20%                       ] auto_large_512.sqlite[2/7] [==21%                       ] auto_large_512.sqlite[2/7] [===22%                      ] auto_large_512.sqlite[2/7] [===23%                      ] auto_large_512.sqlite[2/7] [===24%                      ] auto_large_512.sqlite[2/7] [====25%                     ] auto_large_512.sqlite[2/7] [====26%                     ] auto_large_512.sqlite[2/7] [====27%                     ] auto_large_512.sqlite[2/7] [====28%                     ] auto_large_512.sqlite[2/7] [=====29%                    ] auto_large_512.sqlite[2/7] [=====30%                    ] auto_large_512.sqlite[2/7] [=====31%                    ] auto_large_512.sqlite[2/7] [=====32%                    ] auto_large_512.sqlite[2/7] [======33%                   ] auto_large_512.sqlite[2/7] [======34%                   ] auto_large_512.sqlite[2/7] [======35%                   ] auto_large_512.sqlite[2/7] [=======36%                  ] auto_large_512.sqlite[2/7] [=======37%                  ] auto_large_512.sqlite[2/7] [=======38%                  ] auto_large_512.sqlite[2/7] [=======39%                  ] auto_large_512.sqlite[2/7] [========40%                 ] auto_large_512.sqlite[2/7] [========41%                 ] auto_large_512.sqlite[2/7] [========42%                 ] auto_large_512.sqlite[2/7] [=========43%                ] auto_large_512.sqlite[2/7] [=========44%                ] auto_large_512.sqlite[2/7] [=========45%                ] auto_large_512.sqlite[2/7] [=========46%                ] auto_large_512.sqlite[2/7] [==========47%               ] auto_large_512.sqlite[2/7] [==========48%               ] auto_large_512.sqlite[2/7] [==========49%               ] auto_large_512.sqlite[2/7] [===========50%              ] auto_large_512.sqlite[2/7] [===========51%              ] auto_large_512.sqlite[2/7] [===========52%              ] auto_large_512.sqlite[2/7] [===========53%              ] auto_large_512.sqlite[2/7] [============54%             ] auto_large_512.sqlite[2/7] [============55%             ] auto_large_512.sqlite[2/7] [============56%             ] auto_large_512.sqlite[2/7] [============57%             ] auto_large_512.sqlite[2/7] [=============58%            ] auto_large_512.sqlite[2/7] [=============59%            ] auto_large_512.sqlite[2/7] [=============60%            ] auto_large_512.sqlite[2/7] [==============61%           ] auto_large_512.sqlite[2/7] [==============62%           ] auto_large_512.sqlite[2/7] [==============63%           ] auto_large_512.sqlite[2/7] [==============64%           ] auto_large_512.sqlite[2/7] [===============65%          ] auto_large_512.sqlite[2/7] [===============66%          ] auto_large_512.sqlite[2/7] [===============67%          ] auto_large_512.sqlite[2/7] [================68%         ] auto_large_512.sqlite[2/7] [================69%         ] auto_large_512.sqlite[2/7] [================70%         ] auto_large_512.sqlite[2/7] [================71%         ] auto_large_512.sqlite[2/7] [=================72%        ] auto_large_512.sqlite[2/7] [=================73%        ] auto_large_512.sqlite[2/7] [=================74%        ] auto_large_512.sqlite[2/7] [==================75%       ] auto_large_512.sqlite[2/7] [==================76%       ] auto_large_512.sqlite[2/7] [==================77%       ] auto_large_512.sqlite[2/7] [==================78%       ] auto_large_512.sqlite[2/7] [===================79%      ] auto_large_512.sqlite[2/7] [===================80%      ] auto_large_512.sqlite[2/7] [===================81%      ] auto_large_512.sqlite[2/7] [===================82%      ] auto_large_512.sqlite[2/7] [====================83%     ] auto_large_512.sqlite[2/7] [====================84%     ] auto_large_512.sqlite[2/7] [====================85%     ] auto_large_512.sqlite[2/7] [=====================86%    ] auto_large_512.sqlite[2/7] [=====================87%    ] auto_large_512.sqlite[2/7] [=====================88%    ] auto_large_512.sqlite[2/7] [=====================89%    ] auto_large_512.sqlite[2/7] [======================90%   ] auto_large_512.sqlite[2/7] [======================91%   ] auto_large_512.sqlite[2/7] [======================92%   ] auto_large_512.sqlite[2/7] [=======================93%  ] auto_large_512.sqlite[2/7] [=======================94%  ] auto_large_512.sqlite[2/7] [=======================95%  ] auto_large_512.sqlite[2/7] [=======================96%  ] auto_large_512.sqlite[2/7] [========================97% ] auto_large_512.sqlite[2/7] [========================98% ] auto_large_512.sqlite[2/7] [========================99% ] auto_large_512.sqlite[2/7] [========================100%] auto_large_512.sqlite[2/7] [========================100%] auto_large_512.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     44.0       3247823088          1  3247823088.0  3247823088.0  3247823088  3247823088          0.0  PushPop  :WARM_UP       
     23.2       1712280248         10   171228024.8   171195692.5   168566188   173678614    1669995.1  PushPop  :BACKWARD_PASS 
     18.7       1376301230         10   137630123.0   136767554.0   135311976   142930535    2450209.1  PushPop  :FORWARD_PASS  
     14.1       1037993854         10   103799385.4   103286132.0   102695734   106262372    1215829.3  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ----------  ----------  --------  --------  -----------  ------------------------
     48.7       1607415703     169200      9500.1      6070.0      4565  62137272     244785.4  cudaLaunchKernel        
     25.9        853716911       1453    587554.7     16844.0      7159  10926581    1535388.0  cudaMemcpyAsync         
     14.2        467660814         20  23383040.7  22303911.0    637864  48660532   23215129.2  cudaDeviceSynchronize   
      3.7        123170496      14625      8421.9      7658.0      5155     42654       3300.0  cuLaunchKernel          
      3.3        109189401        715    152712.4    149332.0      6269    380504      31182.8  cudaMalloc              
      1.5         51116414        343    149027.4     54570.0      8540   8243296     876184.1  cudaStreamSynchronize   
      1.3         44448636       4905      9061.9      3937.0      3154    237055      22180.0  cudaMemsetAsync         
      0.6         19294255      14625      1319.3       971.0       463   3740753      31013.4  cuKernelGetFunction     
      0.5         15569565          4   3892391.3   4585768.0   1236692   5161337    1795433.8  cuLibraryLoadData       
      0.1          2608849          2   1304424.5   1304424.5      2706   2606143    1840908.0  cudaFree                
      0.0          1554719        769      2021.7      1993.0       457     21115       1460.6  cudaStreamIsCapturing   
      0.0          1437045          1   1437045.0   1437045.0   1437045   1437045          0.0  cudaGetDeviceProperties 
      0.0          1168640          1   1168640.0   1168640.0   1168640   1168640          0.0  cudaHostAlloc           
      0.0           191502        810       236.4       202.0       136      1040        108.6  cuGetProcAddress_v2     
      0.0            46702         36      1297.3       480.0       449     12769       2363.9  cudaEventCreateWithFlags
      0.0            17926         14      1280.4      1361.0       627      1966        455.0  cuLibraryGetKernel      
      0.0             6891          3      2297.0      2312.0      2234      2345         57.0  cuInit                  
      0.0             3871          3      1290.3       189.0       181      3501       1914.5  cuModuleGetLoadingMode  
      0.0             2085          2      1042.5      1042.5       587      1498        644.2  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     12.4        776311181      34815   22298.2    7232.0      1440    192575      32639.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      9.2        578231782       8700   66463.4   25424.0      1855    193120      59238.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      8.3        520670146      31635   16458.7    8352.0      1440     78591      16385.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      7.0        436942260       3255  134237.3   72352.0     69696    610749      88565.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      4.9        307234315       2715  113161.8   73440.0     70944    537566      77864.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      4.8        302522737      17940   16863.0   14144.0      3008    127520       9917.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.7        297242851       2160  137612.4  139135.0    129855    161599       5469.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.7        296258041      10275   28832.9   20032.0     11360    212543      24410.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.9        244976452       1095  223722.8  219807.0    216639    553661      27298.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      3.7        233156292       1080  215885.5  212511.0    208703    270175      13765.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      3.3        207667522       7665   27093.0   13952.0      2944     83552      28194.9  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.7        172322930      10905   15802.2    9152.0      1471     78463      14550.0  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      2.2        137204891       1140  120355.2  120287.5    115391    123743       1513.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      2.2        135385785       1080  125357.2  124415.0    123423    146751       4403.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.2        135064799       2160   62530.0   62175.0     61247     80064       2455.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nt_align4>(T1::Params)             
      2.1        134882467       1110  121515.7  121439.0    117536    134624       2576.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.1        132922621       1080  123076.5  123039.0    120223    125695        653.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      2.0        127511412       4920   25917.0    8032.0      1728    120095      28518.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      1.9        120094762        540  222397.7  221503.0    218399    283742       9203.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nt_align4>(T1::Params)             
      1.9        117580967      11505   10220.0    5088.0      1280     55968      11741.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.9        116105758        540  215010.7  213951.0    210975    271423       8493.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      1.6         98265052       1080   90986.2   92207.5     86303     98175       3362.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      1.5         97163262       1080   89966.0   90527.5     85248     96959       2748.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      1.5         94510452       1080   87509.7   87087.5     83520    100256       2486.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      1.3         83274847       4920   16925.8    6016.0      1600     78848      17759.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      1.3         82236150       6030   13637.8    5632.0      1472     77984      16488.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.1         66394875        555  119630.4  119584.0    115488    122431       1004.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.8         50977344        540   94402.5   94351.5     92160     96159        638.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.8         49851302        555   89822.2   89439.0     81536    100063       2521.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.5         30326652        540   56160.5   56111.5     55423     57952        357.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.2         14273890        540   26433.1   26304.0     25760     33279        959.3  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2         14210917       1095   12978.0   12927.0     12448     16352        490.7  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.2         11667567       1110   10511.3   10560.0      2656     13632       1004.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2          9953211       1080    9215.9    9920.0      7200     12576       1498.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          9390838       1110    8460.2    8384.0      3968     10944        752.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.1          8527573       1095    7787.7    7424.0      7008     34016       2433.5  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1          8163142        540   15116.9   15072.0     14464     18560        533.6  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          5210855        555    9388.9    9376.0      7328     11456        407.3  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0          2476340        540    4585.8    4512.0      4384      5728        293.4  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          2404853       1095    2196.2    2208.0      1856      2912        118.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0          2150293       1095    1963.7    1920.0      1856      2464        129.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0          2107132       1095    1924.3    1920.0      1664      2528        206.5  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           379070         15   25271.3   25248.0     24352     26336        452.9  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           158463         15   10564.2   10592.0     10464     10624         46.7  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           124159         15    8277.3    8224.0      8032      8928        222.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           111422         15    7428.1    7520.0      6688      8032        430.1  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            87775         30    2925.8    2912.0      2720      3424        196.4  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            49311         15    3287.4    3264.0      3104      3424         85.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            40384         15    2692.3    2688.0      2528      3072        127.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            37504         15    2500.3    2464.0      2432      2560         48.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            34208         15    2280.5    2304.0      2208      2400         62.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            32480         15    2165.3    2176.0      2080      2240         39.5  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            27072         15    1804.8    1824.0      1696      1856         43.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     96.8        787357762    328  2400481.0  1240314.0      1600  10728302    2319071.7  [CUDA memcpy Host-to-Device]  
      2.4         19572877   1110    17633.2    16800.0     15360     78047       6925.0  [CUDA memcpy Device-to-Device]
      0.8          6695143   4905     1365.0     1056.0       992      2720        394.6  [CUDA memset]                 
      0.0            35584     15     2372.3     1952.0      1856      4160        772.9  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  12249.907   1110    11.036    10.486    10.486    51.200        4.703  [CUDA memcpy Device-to-Device]
   3877.778    328    11.822     6.554     0.005    51.200       11.032  [CUDA memcpy Host-to-Device]  
      0.059   4905     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_512.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_512.sqlite
SUCCESS: large_512
Profiling model_size=large context_size=1024
device set to CUDA
MACHINE hpc
RUNNING SIZE large, CONTEXT_SIZE: 1024
TRINING LOOP WITH:
vocab size 10000 context length 1024
model initialized
optimizer ready
it_id 0
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/2m9n86hi[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_110636-2m9n86hi/logs[0m
Collecting data...
Generating '/tmp/nsys-report-7f3f.qdstrm'
[1/7] [0%                          ] auto_large_1024.nsys-rep[1/7] [0%                          ] auto_large_1024.nsys-rep[1/7] [11%                         ] auto_large_1024.nsys-rep[1/7] [===========51%              ] auto_large_1024.nsys-rep[1/7] [===========52%              ] auto_large_1024.nsys-rep[1/7] [===========53%              ] auto_large_1024.nsys-rep[1/7] [============54%             ] auto_large_1024.nsys-rep[1/7] [============55%             ] auto_large_1024.nsys-rep[1/7] [============57%             ] auto_large_1024.nsys-rep[1/7] [=============58%            ] auto_large_1024.nsys-rep[1/7] [=============60%            ] auto_large_1024.nsys-rep[1/7] [==============63%           ] auto_large_1024.nsys-rep[1/7] [==============64%           ] auto_large_1024.nsys-rep[1/7] [===============67%          ] auto_large_1024.nsys-rep[1/7] [================68%         ] auto_large_1024.nsys-rep[1/7] [================69%         ] auto_large_1024.nsys-rep[1/7] [================70%         ] auto_large_1024.nsys-rep[1/7] [================71%         ] auto_large_1024.nsys-rep[1/7] [=================72%        ] auto_large_1024.nsys-rep[1/7] [==================78%       ] auto_large_1024.nsys-rep[1/7] [====================84%     ] auto_large_1024.nsys-rep[1/7] [=====================89%    ] auto_large_1024.nsys-rep[1/7] [=======================93%  ] auto_large_1024.nsys-rep[1/7] [========================100%] auto_large_1024.nsys-rep[1/7] [========================100%] auto_large_1024.nsys-rep
[2/7] [0%                          ] auto_large_1024.sqlite[2/7] [1%                          ] auto_large_1024.sqlite[2/7] [2%                          ] auto_large_1024.sqlite[2/7] [3%                          ] auto_large_1024.sqlite[2/7] [4%                          ] auto_large_1024.sqlite[2/7] [5%                          ] auto_large_1024.sqlite[2/7] [6%                          ] auto_large_1024.sqlite[2/7] [7%                          ] auto_large_1024.sqlite[2/7] [8%                          ] auto_large_1024.sqlite[2/7] [9%                          ] auto_large_1024.sqlite[2/7] [10%                         ] auto_large_1024.sqlite[2/7] [11%                         ] auto_large_1024.sqlite[2/7] [12%                         ] auto_large_1024.sqlite[2/7] [13%                         ] auto_large_1024.sqlite[2/7] [14%                         ] auto_large_1024.sqlite[2/7] [=15%                        ] auto_large_1024.sqlite[2/7] [=16%                        ] auto_large_1024.sqlite[2/7] [=17%                        ] auto_large_1024.sqlite[2/7] [==18%                       ] auto_large_1024.sqlite[2/7] [==19%                       ] auto_large_1024.sqlite[2/7] [==20%                       ] auto_large_1024.sqlite[2/7] [==21%                       ] auto_large_1024.sqlite[2/7] [===22%                      ] auto_large_1024.sqlite[2/7] [===23%                      ] auto_large_1024.sqlite[2/7] [===24%                      ] auto_large_1024.sqlite[2/7] [====25%                     ] auto_large_1024.sqlite[2/7] [====26%                     ] auto_large_1024.sqlite[2/7] [====27%                     ] auto_large_1024.sqlite[2/7] [====28%                     ] auto_large_1024.sqlite[2/7] [=====29%                    ] auto_large_1024.sqlite[2/7] [=====30%                    ] auto_large_1024.sqlite[2/7] [=====31%                    ] auto_large_1024.sqlite[2/7] [=====32%                    ] auto_large_1024.sqlite[2/7] [======33%                   ] auto_large_1024.sqlite[2/7] [======34%                   ] auto_large_1024.sqlite[2/7] [======35%                   ] auto_large_1024.sqlite[2/7] [=======36%                  ] auto_large_1024.sqlite[2/7] [=======37%                  ] auto_large_1024.sqlite[2/7] [=======38%                  ] auto_large_1024.sqlite[2/7] [=======39%                  ] auto_large_1024.sqlite[2/7] [========40%                 ] auto_large_1024.sqlite[2/7] [========41%                 ] auto_large_1024.sqlite[2/7] [========42%                 ] auto_large_1024.sqlite[2/7] [=========43%                ] auto_large_1024.sqlite[2/7] [=========44%                ] auto_large_1024.sqlite[2/7] [=========45%                ] auto_large_1024.sqlite[2/7] [=========46%                ] auto_large_1024.sqlite[2/7] [==========47%               ] auto_large_1024.sqlite[2/7] [==========48%               ] auto_large_1024.sqlite[2/7] [==========49%               ] auto_large_1024.sqlite[2/7] [===========50%              ] auto_large_1024.sqlite[2/7] [===========51%              ] auto_large_1024.sqlite[2/7] [===========52%              ] auto_large_1024.sqlite[2/7] [===========53%              ] auto_large_1024.sqlite[2/7] [============54%             ] auto_large_1024.sqlite[2/7] [============55%             ] auto_large_1024.sqlite[2/7] [============56%             ] auto_large_1024.sqlite[2/7] [============57%             ] auto_large_1024.sqlite[2/7] [=============58%            ] auto_large_1024.sqlite[2/7] [=============59%            ] auto_large_1024.sqlite[2/7] [=============60%            ] auto_large_1024.sqlite[2/7] [==============61%           ] auto_large_1024.sqlite[2/7] [==============62%           ] auto_large_1024.sqlite[2/7] [==============63%           ] auto_large_1024.sqlite[2/7] [==============64%           ] auto_large_1024.sqlite[2/7] [===============65%          ] auto_large_1024.sqlite[2/7] [===============66%          ] auto_large_1024.sqlite[2/7] [===============67%          ] auto_large_1024.sqlite[2/7] [================68%         ] auto_large_1024.sqlite[2/7] [================69%         ] auto_large_1024.sqlite[2/7] [================70%         ] auto_large_1024.sqlite[2/7] [================71%         ] auto_large_1024.sqlite[2/7] [=================72%        ] auto_large_1024.sqlite[2/7] [=================73%        ] auto_large_1024.sqlite[2/7] [=================74%        ] auto_large_1024.sqlite[2/7] [==================75%       ] auto_large_1024.sqlite[2/7] [==================76%       ] auto_large_1024.sqlite[2/7] [==================77%       ] auto_large_1024.sqlite[2/7] [==================78%       ] auto_large_1024.sqlite[2/7] [===================79%      ] auto_large_1024.sqlite[2/7] [===================80%      ] auto_large_1024.sqlite[2/7] [===================81%      ] auto_large_1024.sqlite[2/7] [===================82%      ] auto_large_1024.sqlite[2/7] [====================83%     ] auto_large_1024.sqlite[2/7] [====================84%     ] auto_large_1024.sqlite[2/7] [====================85%     ] auto_large_1024.sqlite[2/7] [=====================86%    ] auto_large_1024.sqlite[2/7] [=====================87%    ] auto_large_1024.sqlite[2/7] [=====================88%    ] auto_large_1024.sqlite[2/7] [=====================89%    ] auto_large_1024.sqlite[2/7] [======================90%   ] auto_large_1024.sqlite[2/7] [======================91%   ] auto_large_1024.sqlite[2/7] [======================92%   ] auto_large_1024.sqlite[2/7] [=======================93%  ] auto_large_1024.sqlite[2/7] [=======================94%  ] auto_large_1024.sqlite[2/7] [=======================95%  ] auto_large_1024.sqlite[2/7] [=======================96%  ] auto_large_1024.sqlite[2/7] [========================97% ] auto_large_1024.sqlite[2/7] [========================98% ] auto_large_1024.sqlite[2/7] [========================99% ] auto_large_1024.sqlite[2/7] [========================100%] auto_large_1024.sqlite[2/7] [========================100%] auto_large_1024.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  --------
    100.0        783574330          1  783574330.0  783574330.0  783574330  783574330          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ----------  ---------  --------  --------  -----------  ------------------------
     71.1        832987447        328   2539595.9  1432864.0      7170  10933748    2345311.7  cudaMemcpyAsync         
     15.3        179369128       1379    130071.9     8197.0      5405  24709037    1246222.8  cudaLaunchKernel        
      5.3         62569943          4  15642485.8  1353986.5     54921  59807049   29468164.7  cudaFree                
      4.4         51499356        323    159440.7   149321.0      6018   1242053      66944.9  cudaMalloc              
      1.5         17988949        328     54844.4    54128.5      8092    101781      29913.4  cudaStreamSynchronize   
      1.3         15602851          4   3900712.8  4670761.0   1249242   5012087    1776506.4  cuLibraryLoadData       
      0.4          5109199        256     19957.8     1334.0       789   4532384     283280.2  cuKernelGetFunction     
      0.3          3017040        256     11785.3    11119.5      7867     31153       3373.3  cuLaunchKernel          
      0.2          2375308          2   1187654.0  1187654.0    933276   1442032     359744.8  cudaGetDeviceProperties 
      0.1           746196        324      2303.1     2163.0       479     20971       1815.4  cudaStreamIsCapturing   
      0.0           296289         28     10581.8    10210.0      9715     18789       1662.6  cudaMemsetAsync         
      0.0           221153        810       273.0      211.0       135     22193        779.6  cuGetProcAddress_v2     
      0.0            30461         18      1692.3      490.0       478     12739       2970.5  cudaEventCreateWithFlags
      0.0            21513          1     21513.0    21513.0     21513     21513          0.0  cudaMemGetInfo          
      0.0             8637          8      1079.6      979.5       537      1645        424.0  cuLibraryGetKernel      
      0.0             6700          3      2233.3     2110.0      2016      2574        298.7  cuInit                  
      0.0             4168          3      1389.3      169.0       162      3837       2119.7  cuModuleGetLoadingMode  
      0.0             1666          2       833.0      833.0       499      1167        472.3  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     20.3         41298947        171  241514.3  126847.0    123808    481630     165477.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      7.9         16117111         28  575611.1  575165.5    574493    579101       1224.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      7.7         15636184         29  539178.8  539006.0    535614    542302       1347.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      7.3         14783133         29  509763.2  509278.0    507838    514237       1665.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      7.0         14250504        346   41186.4   43455.0     34047     47168       4152.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.9         14094591         29  486020.4  485630.0    484094    488734       1295.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      6.6         13484744         28  481598.0  481710.0    479518    482974        974.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      6.4         13036196         28  465578.4  465662.0    462366    468222       1403.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      5.1         10447191         56  186557.0  186671.0    182688    190623       3330.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      4.6          9385745         29  323646.4  324223.0    313279    327743       3517.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      4.2          8559475         28  305695.5  305855.0    303295    308190       1227.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      3.8          7793660         29  268746.9  268702.0    266975    269951        590.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      3.5          7066969         28  252391.8  252510.5    245951    256319       1776.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.1          6300396        172   36630.2   38735.5     29888     42048       4246.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.2          4448015        172   25860.6   18080.0     17696     43936      11378.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      1.6          3290249         28  117508.9  117439.0    116159    119775        890.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.7          1417628         57   24870.7   24864.0     23104     30880       1231.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.4           874492         57   15342.0   15167.0     14688     17376        504.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.3           582237         59    9868.4    8864.0      8608     57152       6283.5  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1           229373         29    7909.4    7904.0      7743      8320        123.7  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           143388         57    2515.6    2496.0      2463      2816         85.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.1           137056         58    2363.0    2352.0      2144      2912        150.7  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.1           127006         57    2228.2    2240.0      2207      2240         15.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0            71840         29    2477.2    2336.0      2304      3200        270.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      0.0             6432          2    3216.0    3216.0      3136      3296        113.1  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
    100.0        787060630    328  2399575.1  1239050.5      1472  10761071    2318441.4  [CUDA memcpy Host-to-Device]
      0.0            67487     28     2410.3     2528.0      1760      3008        324.1  [CUDA memset]               

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
   3877.910    328    11.823     6.554     0.005    51.200       11.032  [CUDA memcpy Host-to-Device]
      0.018     28     0.001     0.001     0.001     0.001        0.000  [CUDA memset]               

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_1024.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_large_1024.sqlite
FAILED: large_1024 (likely OOM)
Profiling model_size=xl context_size=128
device set to CUDA
MACHINE hpc
RUNNING SIZE xl, CONTEXT_SIZE: 128
TRINING LOOP WITH:
vocab size 10000 context length 128
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x14cef8c274c0>, {'FORWARD_PASS_TIME': [0.17901259900003197, 0.1790260040000362, 0.18282290100000864, 0.18306440200001362, 0.18273986799999875, 0.186013317000004, 0.18246424199998046, 0.18331969100000833, 0.18178236099998912, 0.19000289399997428], 'BACKWARD_PASS_TIME': [0.23199730800001817, 0.2297747510000363, 0.23445703299995557, 0.22592761599997857, 0.2301832539999964, 0.2308726589999992, 0.2257327529999884, 0.22532504200000858, 0.22852714200001856, 0.22675873399998636]})
Collecting data...
Generating '/tmp/nsys-report-c808.qdstrm'
[1/7] [0%                          ] auto_xl_128.nsys-rep[1/7] [0%                          ] auto_xl_128.nsys-rep[1/7] [5%                          ] auto_xl_128.nsys-rep[1/7] [=17%                        ] auto_xl_128.nsys-rep[1/7] [=15%                        ] auto_xl_128.nsys-rep[1/7] [=17%                        ] auto_xl_128.nsys-rep[1/7] [=16%                        ] auto_xl_128.nsys-rep[1/7] [=15%                        ] auto_xl_128.nsys-rep[1/7] [14%                         ] auto_xl_128.nsys-rep[1/7] [13%                         ] auto_xl_128.nsys-rep[1/7] [12%                         ] auto_xl_128.nsys-rep[1/7] [11%                         ] auto_xl_128.nsys-rep[1/7] [10%                         ] auto_xl_128.nsys-rep[1/7] [9%                          ] auto_xl_128.nsys-rep[1/7] [8%                          ] auto_xl_128.nsys-rep[1/7] [7%                          ] auto_xl_128.nsys-rep[1/7] [6%                          ] auto_xl_128.nsys-rep[1/7] [7%                          ] auto_xl_128.nsys-rep[1/7] [9%                          ] auto_xl_128.nsys-rep[1/7] [10%                         ] auto_xl_128.nsys-rep[1/7] [11%                         ] auto_xl_128.nsys-rep[1/7] [13%                         ] auto_xl_128.nsys-rep[1/7] [14%                         ] auto_xl_128.nsys-rep[1/7] [=16%                        ] auto_xl_128.nsys-rep[1/7] [=17%                        ] auto_xl_128.nsys-rep[1/7] [==19%                       ] auto_xl_128.nsys-rep[1/7] [==20%                       ] auto_xl_128.nsys-rep[1/7] [===22%                      ] auto_xl_128.nsys-rep[1/7] [===23%                      ] auto_xl_128.nsys-rep[1/7] [===24%                      ] auto_xl_128.nsys-rep[1/7] [====26%                     ] auto_xl_128.nsys-rep[1/7] [====27%                     ] auto_xl_128.nsys-rep[1/7] [=====29%                    ] auto_xl_128.nsys-rep[1/7] [=====30%                    ] auto_xl_128.nsys-rep[1/7] [=====32%                    ] auto_xl_128.nsys-rep[1/7] [======33%                   ] auto_xl_128.nsys-rep[1/7] [======35%                   ] auto_xl_128.nsys-rep[1/7] [=======36%                  ] auto_xl_128.nsys-rep[1/7] [=======37%                  ] auto_xl_128.nsys-rep[1/7] [=======39%                  ] auto_xl_128.nsys-rep[1/7] [========40%                 ] auto_xl_128.nsys-rep[1/7] [========42%                 ] auto_xl_128.nsys-rep[1/7] [=========43%                ] auto_xl_128.nsys-rep[1/7] [=========45%                ] auto_xl_128.nsys-rep[1/7] [=========46%                ] auto_xl_128.nsys-rep[1/7] [==========47%               ] auto_xl_128.nsys-rep[1/7] [==========49%               ] auto_xl_128.nsys-rep[1/7] [===========50%              ] auto_xl_128.nsys-rep[1/7] [===========51%              ] auto_xl_128.nsys-rep[1/7] [===========52%              ] auto_xl_128.nsys-rep[1/7] [===========53%              ] auto_xl_128.nsys-rep[1/7] [============54%             ] auto_xl_128.nsys-rep[1/7] [========================100%] auto_xl_128.nsys-rep[1/7] [========================100%] auto_xl_128.nsys-rep
[2/7] [0%                          ] auto_xl_128.sqlite[2/7] [1%                          ] auto_xl_128.sqlite[2/7] [2%                          ] auto_xl_128.sqlite[2/7] [3%                          ] auto_xl_128.sqlite[2/7] [4%                          ] auto_xl_128.sqlite[2/7] [5%                          ] auto_xl_128.sqlite[2/7] [6%                          ] auto_xl_128.sqlite[2/7] [7%                          ] auto_xl_128.sqlite[2/7] [8%                          ] auto_xl_128.sqlite[2/7] [9%                          ] auto_xl_128.sqlite[2/7] [10%                         ] auto_xl_128.sqlite[2/7] [11%                         ] auto_xl_128.sqlite[2/7] [12%                         ] auto_xl_128.sqlite[2/7] [13%                         ] auto_xl_128.sqlite[2/7] [14%                         ] auto_xl_128.sqlite[2/7] [=15%                        ] auto_xl_128.sqlite[2/7] [=16%                        ] auto_xl_128.sqlite[2/7] [=17%                        ] auto_xl_128.sqlite[2/7] [==18%                       ] auto_xl_128.sqlite[2/7] [==19%                       ] auto_xl_128.sqlite[2/7] [==20%                       ] auto_xl_128.sqlite[2/7] [==21%                       ] auto_xl_128.sqlite[2/7] [===22%                      ] auto_xl_128.sqlite[2/7] [===23%                      ] auto_xl_128.sqlite[2/7] [===24%                      ] auto_xl_128.sqlite[2/7] [====25%                     ] auto_xl_128.sqlite[2/7] [====26%                     ] auto_xl_128.sqlite[2/7] [====27%                     ] auto_xl_128.sqlite[2/7] [====28%                     ] auto_xl_128.sqlite[2/7] [=====29%                    ] auto_xl_128.sqlite[2/7] [=====30%                    ] auto_xl_128.sqlite[2/7] [=====31%                    ] auto_xl_128.sqlite[2/7] [=====32%                    ] auto_xl_128.sqlite[2/7] [======33%                   ] auto_xl_128.sqlite[2/7] [======34%                   ] auto_xl_128.sqlite[2/7] [======35%                   ] auto_xl_128.sqlite[2/7] [=======36%                  ] auto_xl_128.sqlite[2/7] [=======37%                  ] auto_xl_128.sqlite[2/7] [=======38%                  ] auto_xl_128.sqlite[2/7] [=======39%                  ] auto_xl_128.sqlite[2/7] [========40%                 ] auto_xl_128.sqlite[2/7] [========41%                 ] auto_xl_128.sqlite[2/7] [========42%                 ] auto_xl_128.sqlite[2/7] [=========43%                ] auto_xl_128.sqlite[2/7] [=========44%                ] auto_xl_128.sqlite[2/7] [=========45%                ] auto_xl_128.sqlite[2/7] [=========46%                ] auto_xl_128.sqlite[2/7] [==========47%               ] auto_xl_128.sqlite[2/7] [==========48%               ] auto_xl_128.sqlite[2/7] [==========49%               ] auto_xl_128.sqlite[2/7] [===========50%              ] auto_xl_128.sqlite[2/7] [===========51%              ] auto_xl_128.sqlite[2/7] [===========52%              ] auto_xl_128.sqlite[2/7] [===========53%              ] auto_xl_128.sqlite[2/7] [============54%             ] auto_xl_128.sqlite[2/7] [============55%             ] auto_xl_128.sqlite[2/7] [============56%             ] auto_xl_128.sqlite[2/7] [============57%             ] auto_xl_128.sqlite[2/7] [=============58%            ] auto_xl_128.sqlite[2/7] [=============59%            ] auto_xl_128.sqlite[2/7] [=============60%            ] auto_xl_128.sqlite[2/7] [==============61%           ] auto_xl_128.sqlite[2/7] [==============62%           ] auto_xl_128.sqlite[2/7] [==============63%           ] auto_xl_128.sqlite[2/7] [==============64%           ] auto_xl_128.sqlite[2/7] [===============65%          ] auto_xl_128.sqlite[2/7] [===============66%          ] auto_xl_128.sqlite[2/7] [===============67%          ] auto_xl_128.sqlite[2/7] [================68%         ] auto_xl_128.sqlite[2/7] [================69%         ] auto_xl_128.sqlite[2/7] [================70%         ] auto_xl_128.sqlite[2/7] [================71%         ] auto_xl_128.sqlite[2/7] [=================72%        ] auto_xl_128.sqlite[2/7] [=================73%        ] auto_xl_128.sqlite[2/7] [=================74%        ] auto_xl_128.sqlite[2/7] [==================75%       ] auto_xl_128.sqlite[2/7] [==================76%       ] auto_xl_128.sqlite[2/7] [==================77%       ] auto_xl_128.sqlite[2/7] [==================78%       ] auto_xl_128.sqlite[2/7] [===================79%      ] auto_xl_128.sqlite[2/7] [===================80%      ] auto_xl_128.sqlite[2/7] [===================81%      ] auto_xl_128.sqlite[2/7] [===================82%      ] auto_xl_128.sqlite[2/7] [====================83%     ] auto_xl_128.sqlite[2/7] [====================84%     ] auto_xl_128.sqlite[2/7] [====================85%     ] auto_xl_128.sqlite[2/7] [=====================86%    ] auto_xl_128.sqlite[2/7] [=====================87%    ] auto_xl_128.sqlite[2/7] [=====================88%    ] auto_xl_128.sqlite[2/7] [=====================89%    ] auto_xl_128.sqlite[2/7] [======================90%   ] auto_xl_128.sqlite[2/7] [======================91%   ] auto_xl_128.sqlite[2/7] [======================92%   ] auto_xl_128.sqlite[2/7] [=======================93%  ] auto_xl_128.sqlite[2/7] [=======================94%  ] auto_xl_128.sqlite[2/7] [=======================95%  ] auto_xl_128.sqlite[2/7] [=======================96%  ] auto_xl_128.sqlite[2/7] [========================97% ] auto_xl_128.sqlite[2/7] [========================98% ] auto_xl_128.sqlite[2/7] [========================99% ] auto_xl_128.sqlite[2/7] [========================100%] auto_xl_128.sqlite[2/7] [========================100%] auto_xl_128.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     40.4       4053018741          1  4053018741.0  4053018741.0  4053018741  4053018741          0.0  PushPop  :WARM_UP       
     22.8       2288486019         10   228848601.9   229053717.5   225234946   234335107    3030044.0  PushPop  :BACKWARD_PASS 
     18.5       1860680243         10   186068024.3   186139688.5   185758685   186404158     262836.7  PushPop  :OPTIMIZER_STEP
     18.2       1828616099         10   182861609.9   182617819.0   178853081   189837995    3194348.8  PushPop  :FORWARD_PASS  

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     53.6       2546314875     225000    11317.0     6262.0      4646  62613769     177769.2  cudaLaunchKernel        
     36.7       1740201838       1921   905883.3    17349.0      7375  13630823    2366150.1  cudaMemcpyAsync         
      3.9        183924909       1104   166598.6   168380.0      6273    915825      43620.8  cudaMalloc              
      3.4        163326417      19485     8382.2     7668.0      5148     77493       3109.2  cuLaunchKernel          
      0.8         39780509       7245     5490.8     3998.0      3250     96860       3178.4  cudaMemsetAsync         
      0.5         25909240        451    57448.4    69949.0      8499     87521      27725.2  cudaStreamSynchronize   
      0.5         24299401      19485     1247.1      925.0       390   4671864      33538.2  cuKernelGetFunction     
      0.3         15681184          4  3920296.0  4699815.5   1249819   5031734    1788777.3  cuLibraryLoadData       
      0.1          2615354          2  1307677.0  1307677.0      2656   2612698    1845578.4  cudaFree                
      0.0          1970078       1158     1701.3     1608.0       471     27870       1215.0  cudaStreamIsCapturing   
      0.0          1446212          1  1446212.0  1446212.0   1446212   1446212          0.0  cudaGetDeviceProperties 
      0.0          1180304          1  1180304.0  1180304.0   1180304   1180304          0.0  cudaHostAlloc           
      0.0           966567         20    48328.3    27825.0     14206    100481      35698.3  cudaDeviceSynchronize   
      0.0           204509        810      252.5      206.5       129     12294        436.1  cuGetProcAddress_v2     
      0.0            52239         36     1451.1      492.5       462     13258       2362.1  cudaEventCreateWithFlags
      0.0            29584         16     1849.0     1392.5       618     10919       2447.8  cuLibraryGetKernel      
      0.0             8047          3     2682.3     2462.0      2250      3335        575.1  cuInit                  
      0.0             3879          3     1293.0      222.0       185      3472       1887.2  cuModuleGetLoadingMode  
      0.0             1949          2      974.5      974.5       542      1407        611.6  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     19.7       1092539359      46335   23579.1    7840.0      1440    147775      35055.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     19.0       1058591214      42075   25159.6   14592.0      1472     96608      25532.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      7.9        437004372      13695   31909.8    7776.0      5664    272094      43395.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.1        339061595      14505   23375.5   14784.0      1760     97216      22959.2  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      5.7        316088367      23880   13236.5    6976.0      3072    102719      16843.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.8        264513875       6540   40445.5   17312.0      1952    148063      40575.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      4.3        240920078       2175  110767.9  107615.0    105983    209087       9201.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      3.2        178776135       6540   27335.8   13120.0      1888     96927      25841.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      3.2        176958159      15285   11577.2    6816.0      1280     45248      11035.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      3.1        170034745      10185   16694.6    8928.0      3072     70431      16956.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.0        166462679       8010   20781.9    7808.0      1440     96607      26195.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      2.7        151933769      11580   13120.4    6688.0      1472     31583      10899.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.5        137684592       1455   94628.6   92319.0     91264    178751       8372.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_nn_align4>(T1::Params)             
      2.4        130725477       1440   90781.6   89119.0     87360    116608       6419.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4>(T1::Params)             
      1.9        107524006       2880   37334.7   36639.0     35200     47808       2658.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nt_align4>(T1::Params)             
      1.7         95138886       2880   33034.3   32448.0     31456     43551       2491.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_nn_align4>(T1::Params)              
      1.6         91146319       2880   31648.0   31072.0     30400     41824       2274.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_32x6_tn_align4>(T1::Params)              
      1.3         70535377        720   97965.8   96352.0     95072    121695       6001.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      1.2         65544036        720   91033.4   89343.0     87647    115967       6522.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nn_align4>(T1::Params)             
      0.7         36214253       2880   12574.4   12064.0     10623     17760       1336.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.4         23765197       1455   16333.5   16064.0     15616     20672       1077.0  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.4         22202187        720   30836.4   30816.0     30335     31776        223.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.3         18195451       1440   12635.7   12832.0     11360     16576       1014.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_tn_align4>(T1::Params)               
      0.3         15894526       1440   11037.9   11760.0      8704     15264       1872.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.3         14882243       1440   10334.9   10175.0      9792     13600        727.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2         13467685       1470    9161.7    8544.0      8352     36704       3129.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2         13331305       1440    9257.9    9184.0      8224     12128        800.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.2         12276972       1470    8351.7    8256.0      3712     10752        731.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2         11726311        735   15954.2   15488.0     15136     29632       1741.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.2         10598409       1500    7065.6    6880.0      5184     24192       2750.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.2          8785270        720   12201.8   11968.0     11808     15648        866.4  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2          8547898       1440    5936.0    5824.0      5440      8096        466.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.1          8264129       1455    5679.8    5824.0      4960     17696       1082.3  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1          7959105        720   11054.3   10879.0     10112     15168        778.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.1          7777092       1470    5290.5    5216.0      2208      6944        485.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          6417143       1440    4456.3    4448.0      4095      6016        378.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          5052141        720    7016.9    6880.0      6752      9152        506.3  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          4833618        735    6576.4    6496.0      5408      8416        442.7  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.1          4723049        735    6425.9    5984.0      5568     24128       2365.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.0          2624627         15  174975.1  171679.0    171039    220543      12612.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      0.0          2485463        720    3452.0    3392.0      3264      4448        246.3  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          2439444       1455    1676.6    1664.0      1536      2176        126.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0          2398512       1455    1648.5    1632.0      1472      2624        134.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0          2385556       1455    1639.6    1504.0      1343      2496        228.1  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           168095         15   11206.3   11136.0     10912     11680        194.3  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           132992         15    8866.1    8704.0      8672     11264        663.8  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0            87904         15    5860.3    5792.0      5376      7456        501.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            86688         30    2889.6    2912.0      2560      3648        279.9  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            60064         15    4004.3    3936.0      3872      4864        258.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            46944         15    3129.6    3040.0      2880      3872        277.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            35104         15    2340.3    2304.0      2240      2720        117.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            34016         15    2267.7    2208.0      2176      2752        149.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            33952         15    2263.5    2272.0      2048      2816        166.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            32864         15    2190.9    2176.0      2048      2752        163.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            27936         15    1862.4    1824.0      1792      2368        141.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     99.1       1653577956    436  3792610.0  2037046.0      1728  13464991    3548439.5  [CUDA memcpy Host-to-Device]  
      0.5          8577507   7245     1183.9     1056.0       992      9664        302.3  [CUDA memset]                 
      0.4          7127065   1470     4848.3     3840.0      3552     95167       9111.1  [CUDA memcpy Device-to-Device]
      0.0            35296     15     2353.1     1984.0      1824      4448        846.0  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   7992.974    436    18.333    10.240     0.006    64.000       16.842  [CUDA memcpy Host-to-Device]  
   5727.744   1470     3.896     3.277     3.277    64.000        6.105  [CUDA memcpy Device-to-Device]
      0.473   7245     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_128.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_128.sqlite
SUCCESS: xl_128
Profiling model_size=xl context_size=256
device set to CUDA
MACHINE hpc
RUNNING SIZE xl, CONTEXT_SIZE: 256
TRINING LOOP WITH:
vocab size 10000 context length 256
model initialized
optimizer ready
it_id 0
it_id 1
it_id 2
it_id 3
it_id 4
it_id 0 Counting time
it_id 1 Counting time
it_id 2 Counting time
it_id 3 Counting time
it_id 4 Counting time
it_id 5 Counting time
it_id 6 Counting time
it_id 7 Counting time
it_id 8 Counting time
it_id 9 Counting time
result, not used defaultdict(<function training_loop.<locals>.<lambda> at 0x14d821e3ef20>, {'FORWARD_PASS_TIME': [0.19672761599997557, 0.18621366500008207, 0.189931629000057, 0.18785511200007932, 0.18866812600003868, 0.18977180700005647, 0.18638251499999114, 0.18607709000002615, 0.19292434800001956, 0.18714549699996041], 'BACKWARD_PASS_TIME': [0.2501124670000081, 0.23239729900001294, 0.2363837179999564, 0.23157403499999418, 0.23021767099999124, 0.23467535699990094, 0.2332551939999803, 0.2314084780000485, 0.24336701300001096, 0.2326633469999706]})
Collecting data...
Generating '/tmp/nsys-report-e2cb.qdstrm'
[1/7] [0%                          ] auto_xl_256.nsys-rep[1/7] [0%                          ] auto_xl_256.nsys-rep[1/7] [0%                          ] auto_xl_256.nsys-rep[1/7] [5%                          ] auto_xl_256.nsys-rep[1/7] [6%                          ] auto_xl_256.nsys-rep[1/7] [5%                          ] auto_xl_256.nsys-rep[1/7] [11%                         ] auto_xl_256.nsys-rep[1/7] [10%                         ] auto_xl_256.nsys-rep[1/7] [9%                          ] auto_xl_256.nsys-rep[1/7] [8%                          ] auto_xl_256.nsys-rep[1/7] [7%                          ] auto_xl_256.nsys-rep[1/7] [6%                          ] auto_xl_256.nsys-rep[1/7] [7%                          ] auto_xl_256.nsys-rep[1/7] [9%                          ] auto_xl_256.nsys-rep[1/7] [10%                         ] auto_xl_256.nsys-rep[1/7] [11%                         ] auto_xl_256.nsys-rep[1/7] [13%                         ] auto_xl_256.nsys-rep[1/7] [14%                         ] auto_xl_256.nsys-rep[1/7] [=16%                        ] auto_xl_256.nsys-rep[1/7] [=17%                        ] auto_xl_256.nsys-rep[1/7] [==18%                       ] auto_xl_256.nsys-rep[1/7] [==20%                       ] auto_xl_256.nsys-rep[1/7] [==21%                       ] auto_xl_256.nsys-rep[1/7] [===23%                      ] auto_xl_256.nsys-rep[1/7] [===24%                      ] auto_xl_256.nsys-rep[1/7] [====26%                     ] auto_xl_256.nsys-rep[1/7] [====27%                     ] auto_xl_256.nsys-rep[1/7] [====28%                     ] auto_xl_256.nsys-rep[1/7] [=====30%                    ] auto_xl_256.nsys-rep[1/7] [=====31%                    ] auto_xl_256.nsys-rep[1/7] [======33%                   ] auto_xl_256.nsys-rep[1/7] [======34%                   ] auto_xl_256.nsys-rep[1/7] [======35%                   ] auto_xl_256.nsys-rep[1/7] [=======37%                  ] auto_xl_256.nsys-rep[1/7] [=======38%                  ] auto_xl_256.nsys-rep[1/7] [========40%                 ] auto_xl_256.nsys-rep[1/7] [========41%                 ] auto_xl_256.nsys-rep[1/7] [========42%                 ] auto_xl_256.nsys-rep[1/7] [=========44%                ] auto_xl_256.nsys-rep[1/7] [=========45%                ] auto_xl_256.nsys-rep[1/7] [==========47%               ] auto_xl_256.nsys-rep[1/7] [==========48%               ] auto_xl_256.nsys-rep[1/7] [===========50%              ] auto_xl_256.nsys-rep[1/7] [===========51%              ] auto_xl_256.nsys-rep[1/7] [===========52%              ] auto_xl_256.nsys-rep[1/7] [===========53%              ] auto_xl_256.nsys-rep[1/7] [============54%             ] auto_xl_256.nsys-rep[1/7] [========================100%] auto_xl_256.nsys-rep[1/7] [========================100%] auto_xl_256.nsys-rep
[2/7] [0%                          ] auto_xl_256.sqlite[2/7] [1%                          ] auto_xl_256.sqlite[2/7] [2%                          ] auto_xl_256.sqlite[2/7] [3%                          ] auto_xl_256.sqlite[2/7] [4%                          ] auto_xl_256.sqlite[2/7] [5%                          ] auto_xl_256.sqlite[2/7] [6%                          ] auto_xl_256.sqlite[2/7] [7%                          ] auto_xl_256.sqlite[2/7] [8%                          ] auto_xl_256.sqlite[2/7] [9%                          ] auto_xl_256.sqlite[2/7] [10%                         ] auto_xl_256.sqlite[2/7] [11%                         ] auto_xl_256.sqlite[2/7] [12%                         ] auto_xl_256.sqlite[2/7] [13%                         ] auto_xl_256.sqlite[2/7] [14%                         ] auto_xl_256.sqlite[2/7] [=15%                        ] auto_xl_256.sqlite[2/7] [=16%                        ] auto_xl_256.sqlite[2/7] [=17%                        ] auto_xl_256.sqlite[2/7] [==18%                       ] auto_xl_256.sqlite[2/7] [==19%                       ] auto_xl_256.sqlite[2/7] [==20%                       ] auto_xl_256.sqlite[2/7] [==21%                       ] auto_xl_256.sqlite[2/7] [===22%                      ] auto_xl_256.sqlite[2/7] [===23%                      ] auto_xl_256.sqlite[2/7] [===24%                      ] auto_xl_256.sqlite[2/7] [====25%                     ] auto_xl_256.sqlite[2/7] [====26%                     ] auto_xl_256.sqlite[2/7] [====27%                     ] auto_xl_256.sqlite[2/7] [====28%                     ] auto_xl_256.sqlite[2/7] [=====29%                    ] auto_xl_256.sqlite[2/7] [=====30%                    ] auto_xl_256.sqlite[2/7] [=====31%                    ] auto_xl_256.sqlite[2/7] [=====32%                    ] auto_xl_256.sqlite[2/7] [======33%                   ] auto_xl_256.sqlite[2/7] [======34%                   ] auto_xl_256.sqlite[2/7] [======35%                   ] auto_xl_256.sqlite[2/7] [=======36%                  ] auto_xl_256.sqlite[2/7] [=======37%                  ] auto_xl_256.sqlite[2/7] [=======38%                  ] auto_xl_256.sqlite[2/7] [=======39%                  ] auto_xl_256.sqlite[2/7] [========40%                 ] auto_xl_256.sqlite[2/7] [========41%                 ] auto_xl_256.sqlite[2/7] [========42%                 ] auto_xl_256.sqlite[2/7] [=========43%                ] auto_xl_256.sqlite[2/7] [=========44%                ] auto_xl_256.sqlite[2/7] [=========45%                ] auto_xl_256.sqlite[2/7] [=========46%                ] auto_xl_256.sqlite[2/7] [==========47%               ] auto_xl_256.sqlite[2/7] [==========48%               ] auto_xl_256.sqlite[2/7] [==========49%               ] auto_xl_256.sqlite[2/7] [===========50%              ] auto_xl_256.sqlite[2/7] [===========51%              ] auto_xl_256.sqlite[2/7] [===========52%              ] auto_xl_256.sqlite[2/7] [===========53%              ] auto_xl_256.sqlite[2/7] [============54%             ] auto_xl_256.sqlite[2/7] [============55%             ] auto_xl_256.sqlite[2/7] [============56%             ] auto_xl_256.sqlite[2/7] [============57%             ] auto_xl_256.sqlite[2/7] [=============58%            ] auto_xl_256.sqlite[2/7] [=============59%            ] auto_xl_256.sqlite[2/7] [=============60%            ] auto_xl_256.sqlite[2/7] [==============61%           ] auto_xl_256.sqlite[2/7] [==============62%           ] auto_xl_256.sqlite[2/7] [==============63%           ] auto_xl_256.sqlite[2/7] [==============64%           ] auto_xl_256.sqlite[2/7] [===============65%          ] auto_xl_256.sqlite[2/7] [===============66%          ] auto_xl_256.sqlite[2/7] [===============67%          ] auto_xl_256.sqlite[2/7] [================68%         ] auto_xl_256.sqlite[2/7] [================69%         ] auto_xl_256.sqlite[2/7] [================70%         ] auto_xl_256.sqlite[2/7] [================71%         ] auto_xl_256.sqlite[2/7] [=================72%        ] auto_xl_256.sqlite[2/7] [=================73%        ] auto_xl_256.sqlite[2/7] [=================74%        ] auto_xl_256.sqlite[2/7] [==================75%       ] auto_xl_256.sqlite[2/7] [==================76%       ] auto_xl_256.sqlite[2/7] [==================77%       ] auto_xl_256.sqlite[2/7] [==================78%       ] auto_xl_256.sqlite[2/7] [===================79%      ] auto_xl_256.sqlite[2/7] [===================80%      ] auto_xl_256.sqlite[2/7] [===================81%      ] auto_xl_256.sqlite[2/7] [===================82%      ] auto_xl_256.sqlite[2/7] [====================83%     ] auto_xl_256.sqlite[2/7] [====================84%     ] auto_xl_256.sqlite[2/7] [====================85%     ] auto_xl_256.sqlite[2/7] [=====================86%    ] auto_xl_256.sqlite[2/7] [=====================87%    ] auto_xl_256.sqlite[2/7] [=====================88%    ] auto_xl_256.sqlite[2/7] [=====================89%    ] auto_xl_256.sqlite[2/7] [======================90%   ] auto_xl_256.sqlite[2/7] [======================91%   ] auto_xl_256.sqlite[2/7] [======================92%   ] auto_xl_256.sqlite[2/7] [=======================93%  ] auto_xl_256.sqlite[2/7] [=======================94%  ] auto_xl_256.sqlite[2/7] [=======================95%  ] auto_xl_256.sqlite[2/7] [=======================96%  ] auto_xl_256.sqlite[2/7] [========================97% ] auto_xl_256.sqlite[2/7] [========================98% ] auto_xl_256.sqlite[2/7] [========================99% ] auto_xl_256.sqlite[2/7] [========================100%] auto_xl_256.sqlite[2/7] [========================100%] auto_xl_256.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style        Range     
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------
     41.0       4244440572          1  4244440572.0  4244440572.0  4244440572  4244440572          0.0  PushPop  :WARM_UP       
     22.8       2354971021         10   235497102.1   232851539.5   230130912   249997808    6316295.6  PushPop  :BACKWARD_PASS 
     18.3       1889116152         10   188911615.2   187994902.5   185791286   196487360    3413853.8  PushPop  :FORWARD_PASS  
     18.0       1861659246         10   186165924.6   186142189.5   185617149   186930995     324775.6  PushPop  :OPTIMIZER_STEP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     51.3       2533892395     225000    11261.7     6343.0      4760  61918754     178306.3  cudaLaunchKernel        
     35.3       1740752562       1921   906170.0    17205.0      7787  13616791    2368432.3  cudaMemcpyAsync         
      6.4        315962456       1473   214502.7   181120.0      7278   4206039     323778.8  cudaMalloc              
      3.4        166705392      19485     8555.6     7993.0      5322     72050       3236.1  cuLaunchKernel          
      1.5         75610889      11580     6529.4     6429.5      3338    581247       6082.2  cudaMemsetAsync         
      0.6         31002892        372    83341.1    72846.5      2659   2616753     133201.4  cudaFree                
      0.5         25485281        451    56508.4    69016.0      6803    106749      27740.8  cudaStreamSynchronize   
      0.5         24719447      19485     1268.6      965.0       430   4558995      32718.2  cuKernelGetFunction     
      0.3         15627520          4  3906880.0  4669714.5   1244233   5043858    1785275.1  cuLibraryLoadData       
      0.1          2826386       1527     1850.9     1772.0       459     25773       1360.4  cudaStreamIsCapturing   
      0.0          1949780         20    97489.0    73083.0     13627    218212      85044.9  cudaDeviceSynchronize   
      0.0          1422405          1  1422405.0  1422405.0   1422405   1422405          0.0  cudaGetDeviceProperties 
      0.0          1145808          1  1145808.0  1145808.0   1145808   1145808          0.0  cudaHostAlloc           
      0.0           209043        810      258.1      208.0       133      6879        325.3  cuGetProcAddress_v2     
      0.0            49194         36     1366.5      506.0       480     14591       2622.8  cudaEventCreateWithFlags
      0.0            18101         14     1292.9     1266.5       688      1967        425.8  cuLibraryGetKernel      
      0.0             6965          3     2321.7     2251.0      2106      2608        258.4  cuInit                  
      0.0             4236          3     1412.0      196.0       176      3864       2123.5  cuModuleGetLoadingMode  
      0.0             1854          2      927.0      927.0       683      1171        345.1  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     16.4       1200426391      46335   25907.6    9280.0      1439    149472      35134.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     14.5       1062612426      42075   25255.2   14656.0      1504     99648      25486.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      6.5        472730350      13695   34518.5   13088.0      8256    317918      41858.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.0        442062090       2175  203246.9  198303.0    196319    380958      15959.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      5.3        388085050      11580   33513.4   14223.5      1504     63936      25714.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      5.2        379285766      23880   15883.0   11232.0      3104     99808      15986.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.7        343299253      14505   23667.6   15168.0      1760    100128      22884.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      3.9        285654477       3600   79348.5   54688.0     52832    220415      47946.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      3.6        264886516       6540   40502.5   17440.0      1951    150015      40523.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.6        264715926       1455  181935.3  177919.0    175679    354462      15809.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      3.5        259203337       1455  178146.6  173855.0    170463    335486      15531.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      2.9        215051394      10185   21114.5    9920.0      3071     70463      16874.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.5        184807645      15285   12090.8    6848.0      1344     45376      10938.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      2.5        182051128       2880   63212.2   62176.0     60639     80991       4192.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_16x3_nt_align4>(T1::Params)             
      2.4        178784542       6540   27337.1   13088.0      1888     98944      25869.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      2.3        166360048       8010   20769.0    7840.0      1472     99039      26186.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      2.2        162968287       2880   56586.2   55680.0     54112     72736       3731.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x128_32x3_nn_align4>(T1::Params)              
      1.8        133725002       2880   46432.3   46943.5     42496     56768       3022.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      1.7        126086722        720  175120.4  172127.0    170303    225023      11948.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      0.8         60640532       1440   42111.5   41727.5     40959     49824       1836.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.8         58582642       1500   39055.1   38368.0     36319     63232       4525.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.8         55578404       1440   38596.1   38464.0     35808     42943       1063.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.8         55439932       1440   38500.0   38528.0     34879     44895       1594.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.7         54309186       1470   36945.0   37087.0     34528     66591       3702.5  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.7         53947732       1440   37463.7   37280.0     34784     42752       1424.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.7         48245053       1440   33503.5   33152.0     30944     41408       1670.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      0.6         44772973        720   62184.7   62144.0     59072     64959        445.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.4         27240166        735   37061.5   36192.0     35647     52800       2412.7  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.4         27199457        735   37006.1   36544.0     35839     59231       3075.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.3         22546065        720   31314.0   31136.0     30464     34304        674.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.2         16946666       1455   11647.2   11456.0     10944     15488        784.7  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.2         13134621        720   18242.5   17920.0     17759     23584       1236.6  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2         12368237       1470    8413.8    8320.0      3808     10976        746.7  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2         11323852       1470    7703.3    7616.0      2656     10112        726.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          9567739       1440    6644.3    7312.0      5280      9664       1159.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          9242590       1455    6352.3    6368.0      5408     22624       1545.7  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1          7523005        720   10448.6   10272.0      9984     13504        716.6  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1          6250044        735    8503.5    8416.0      7040     11007        520.5  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0          2906894        720    4037.4    3968.0      3776      5087        271.8  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          2708053       1455    1861.2    1760.0      1632      2624        177.5  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0          2579792       1455    1773.1    1728.0      1504      2720        183.7  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0          2450676       1455    1684.3    1664.0      1536      2176        123.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           271679         15   18111.9   18112.0     17152     19200        488.5  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0           137470         15    9164.7    9184.0      9087      9280         54.0  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0           116895         15    7793.0    7808.0      6528      8320        432.7  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            96607         15    6440.5    6495.0      5760      7040        387.1  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0            87040         30    2901.3    2944.0      2688      3136        149.9  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            45216         15    3014.4    3008.0      2880      3232         96.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            35808         15    2387.2    2432.0      2048      2624        163.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0            33440         15    2229.3    2208.0      2080      2304         64.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0            33312         15    2220.8    2208.0      2144      2592        114.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0            32384         15    2158.9    2144.0      2144      2176         16.5  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0            27232         15    1815.5    1824.0      1728      1856         28.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     98.2       1654144881    436  3793910.3  2034710.5      1376  13419935    3553265.9  [CUDA memcpy Host-to-Device]  
      1.0         16116474   1470    10963.6    10272.0      6048     99872       8594.7  [CUDA memcpy Device-to-Device]
      0.9         14494265  11580     1251.7     1056.0       991      3136        348.6  [CUDA memset]                 
      0.0            40864     15     2724.3     2016.0      1824      4064        987.1  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  10495.488   1470     7.140     6.554     6.554    64.000        5.775  [CUDA memcpy Device-to-Device]
   7993.006    436    18.333    10.240     0.006    64.000       16.842  [CUDA memcpy Host-to-Device]  
      2.199  11580     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000     15     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_256.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_256.sqlite
SUCCESS: xl_256
Profiling model_size=xl context_size=512
device set to CUDA
MACHINE hpc
RUNNING SIZE xl, CONTEXT_SIZE: 512
TRINING LOOP WITH:
vocab size 10000 context length 512
model initialized
optimizer ready
it_id 0
it_id 1
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/h0x9avnc[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_110843-h0x9avnc/logs[0m
Collecting data...
Generating '/tmp/nsys-report-9499.qdstrm'
[1/7] [0%                          ] auto_xl_512.nsys-rep[1/7] [0%                          ] auto_xl_512.nsys-rep[1/7] [===24%                      ] auto_xl_512.nsys-rep[1/7] [======34%                   ] auto_xl_512.nsys-rep[1/7] [=======39%                  ] auto_xl_512.nsys-rep[1/7] [==========49%               ] auto_xl_512.nsys-rep[1/7] [===========50%              ] auto_xl_512.nsys-rep[1/7] [===========51%              ] auto_xl_512.nsys-rep[1/7] [===========52%              ] auto_xl_512.nsys-rep[1/7] [===========53%              ] auto_xl_512.nsys-rep[1/7] [============54%             ] auto_xl_512.nsys-rep[1/7] [============55%             ] auto_xl_512.nsys-rep[1/7] [============56%             ] auto_xl_512.nsys-rep[1/7] [============57%             ] auto_xl_512.nsys-rep[1/7] [=============58%            ] auto_xl_512.nsys-rep[1/7] [==============61%           ] auto_xl_512.nsys-rep[1/7] [==============64%           ] auto_xl_512.nsys-rep[1/7] [===============67%          ] auto_xl_512.nsys-rep[1/7] [================70%         ] auto_xl_512.nsys-rep[1/7] [================71%         ] auto_xl_512.nsys-rep[1/7] [=================74%        ] auto_xl_512.nsys-rep[1/7] [========================100%] auto_xl_512.nsys-rep[1/7] [========================100%] auto_xl_512.nsys-rep
[2/7] [0%                          ] auto_xl_512.sqlite[2/7] [1%                          ] auto_xl_512.sqlite[2/7] [2%                          ] auto_xl_512.sqlite[2/7] [3%                          ] auto_xl_512.sqlite[2/7] [4%                          ] auto_xl_512.sqlite[2/7] [5%                          ] auto_xl_512.sqlite[2/7] [6%                          ] auto_xl_512.sqlite[2/7] [7%                          ] auto_xl_512.sqlite[2/7] [8%                          ] auto_xl_512.sqlite[2/7] [9%                          ] auto_xl_512.sqlite[2/7] [10%                         ] auto_xl_512.sqlite[2/7] [11%                         ] auto_xl_512.sqlite[2/7] [12%                         ] auto_xl_512.sqlite[2/7] [13%                         ] auto_xl_512.sqlite[2/7] [14%                         ] auto_xl_512.sqlite[2/7] [=15%                        ] auto_xl_512.sqlite[2/7] [=16%                        ] auto_xl_512.sqlite[2/7] [=17%                        ] auto_xl_512.sqlite[2/7] [==18%                       ] auto_xl_512.sqlite[2/7] [==19%                       ] auto_xl_512.sqlite[2/7] [==20%                       ] auto_xl_512.sqlite[2/7] [==21%                       ] auto_xl_512.sqlite[2/7] [===22%                      ] auto_xl_512.sqlite[2/7] [===23%                      ] auto_xl_512.sqlite[2/7] [===24%                      ] auto_xl_512.sqlite[2/7] [====25%                     ] auto_xl_512.sqlite[2/7] [====26%                     ] auto_xl_512.sqlite[2/7] [====27%                     ] auto_xl_512.sqlite[2/7] [====28%                     ] auto_xl_512.sqlite[2/7] [=====29%                    ] auto_xl_512.sqlite[2/7] [=====30%                    ] auto_xl_512.sqlite[2/7] [=====31%                    ] auto_xl_512.sqlite[2/7] [=====32%                    ] auto_xl_512.sqlite[2/7] [======33%                   ] auto_xl_512.sqlite[2/7] [======34%                   ] auto_xl_512.sqlite[2/7] [======35%                   ] auto_xl_512.sqlite[2/7] [=======36%                  ] auto_xl_512.sqlite[2/7] [=======37%                  ] auto_xl_512.sqlite[2/7] [=======38%                  ] auto_xl_512.sqlite[2/7] [=======39%                  ] auto_xl_512.sqlite[2/7] [========40%                 ] auto_xl_512.sqlite[2/7] [========41%                 ] auto_xl_512.sqlite[2/7] [========42%                 ] auto_xl_512.sqlite[2/7] [=========43%                ] auto_xl_512.sqlite[2/7] [=========44%                ] auto_xl_512.sqlite[2/7] [=========45%                ] auto_xl_512.sqlite[2/7] [=========46%                ] auto_xl_512.sqlite[2/7] [==========47%               ] auto_xl_512.sqlite[2/7] [==========48%               ] auto_xl_512.sqlite[2/7] [==========49%               ] auto_xl_512.sqlite[2/7] [===========50%              ] auto_xl_512.sqlite[2/7] [===========51%              ] auto_xl_512.sqlite[2/7] [===========52%              ] auto_xl_512.sqlite[2/7] [===========53%              ] auto_xl_512.sqlite[2/7] [============54%             ] auto_xl_512.sqlite[2/7] [============55%             ] auto_xl_512.sqlite[2/7] [============56%             ] auto_xl_512.sqlite[2/7] [============57%             ] auto_xl_512.sqlite[2/7] [=============58%            ] auto_xl_512.sqlite[2/7] [=============59%            ] auto_xl_512.sqlite[2/7] [=============60%            ] auto_xl_512.sqlite[2/7] [==============61%           ] auto_xl_512.sqlite[2/7] [==============62%           ] auto_xl_512.sqlite[2/7] [==============63%           ] auto_xl_512.sqlite[2/7] [==============64%           ] auto_xl_512.sqlite[2/7] [===============65%          ] auto_xl_512.sqlite[2/7] [===============66%          ] auto_xl_512.sqlite[2/7] [===============67%          ] auto_xl_512.sqlite[2/7] [================68%         ] auto_xl_512.sqlite[2/7] [================69%         ] auto_xl_512.sqlite[2/7] [================70%         ] auto_xl_512.sqlite[2/7] [================71%         ] auto_xl_512.sqlite[2/7] [=================72%        ] auto_xl_512.sqlite[2/7] [=================73%        ] auto_xl_512.sqlite[2/7] [=================74%        ] auto_xl_512.sqlite[2/7] [==================75%       ] auto_xl_512.sqlite[2/7] [==================76%       ] auto_xl_512.sqlite[2/7] [==================77%       ] auto_xl_512.sqlite[2/7] [==================78%       ] auto_xl_512.sqlite[2/7] [===================79%      ] auto_xl_512.sqlite[2/7] [===================80%      ] auto_xl_512.sqlite[2/7] [===================81%      ] auto_xl_512.sqlite[2/7] [===================82%      ] auto_xl_512.sqlite[2/7] [====================83%     ] auto_xl_512.sqlite[2/7] [====================84%     ] auto_xl_512.sqlite[2/7] [====================85%     ] auto_xl_512.sqlite[2/7] [=====================86%    ] auto_xl_512.sqlite[2/7] [=====================87%    ] auto_xl_512.sqlite[2/7] [=====================88%    ] auto_xl_512.sqlite[2/7] [=====================89%    ] auto_xl_512.sqlite[2/7] [======================90%   ] auto_xl_512.sqlite[2/7] [======================91%   ] auto_xl_512.sqlite[2/7] [======================92%   ] auto_xl_512.sqlite[2/7] [=======================93%  ] auto_xl_512.sqlite[2/7] [=======================94%  ] auto_xl_512.sqlite[2/7] [=======================95%  ] auto_xl_512.sqlite[2/7] [=======================96%  ] auto_xl_512.sqlite[2/7] [========================97% ] auto_xl_512.sqlite[2/7] [========================98% ] auto_xl_512.sqlite[2/7] [========================99% ] auto_xl_512.sqlite[2/7] [========================100%] auto_xl_512.sqlite[2/7] [========================100%] auto_xl_512.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  --------
    100.0       1869079809          1  1869079809.0  1869079809.0  1869079809  1869079809          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     67.4       1717412847        535  3210117.5  2204303.0      7787  13714614    3566382.6  cudaMemcpyAsync         
     23.9        608516612      16235    37481.8     6586.0      4609  79263346     918088.3  cudaLaunchKernel        
      5.5        140745113        934   150690.7   143617.5      9012   2076493      71691.6  cudaMalloc              
      1.0         25153799        437    57560.2    68892.0      4403     83840      26926.8  cudaStreamSynchronize   
      0.8         21360303       1528    13979.3     9428.5      5731    123747      15973.3  cuLaunchKernel          
      0.6         16379467          4  4094866.8  4856260.5   1266812   5400134    1903914.3  cuLibraryLoadData       
      0.3          7578004       1528     4959.4     1221.0       472   4628986     118665.6  cuKernelGetFunction     
      0.1          3555208         15   237013.9    65522.0      2568   2594575     652822.6  cudaFree                
      0.1          2417573        435     5557.6     4117.0      3336     30604       3205.3  cudaMemsetAsync         
      0.1          2332238          2  1166119.0  1166119.0    874540   1457698     412355.0  cudaGetDeviceProperties 
      0.1          1979749        936     2115.1     2069.0       510     19275       1092.6  cudaStreamIsCapturing   
      0.1          1292056          1  1292056.0  1292056.0   1292056   1292056          0.0  cudaHostAlloc           
      0.0           199961        810      246.9      207.0       131      2777        160.7  cuGetProcAddress_v2     
      0.0            46857         36     1301.6      514.0       485     13460       2486.8  cudaEventCreateWithFlags
      0.0            24152          1    24152.0    24152.0     24152     24152          0.0  cudaMemGetInfo          
      0.0            22279         16     1392.4     1448.0       632      2013        394.8  cuLibraryGetKernel      
      0.0             7759          3     2586.3     2474.0      2227      3058        426.7  cuInit                  
      0.0             4776          3     1592.0      296.0       199      4281       2329.2  cuModuleGetLoadingMode  
      0.0             1937          2      968.5      968.5       469      1468        706.4  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     11.5        101261798       3243   31224.7   11616.0      1567    238463      43261.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      8.1         70806507       2805   25243.0   15264.0      1760     94879      25407.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      8.0         69814978        822   84933.1  110863.0      1856    238719      71668.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      6.4         56547667        147  384678.0  371935.0    341566    554366      43388.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      6.2         54585730        144  379067.6  377934.5    373566    411006       4334.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      5.0         44050924       1902   23160.3   20079.5      3200    121216      13814.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.7         41097858       1067   38517.2   24352.0     16927    226943      35114.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.3         37740682        217  173920.2  173472.0    161663    196351       9289.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.7         32081158         97  330733.6  328575.0    325407    543933      22048.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_nn_align4>(T1::Params)             
      3.3         29128663        295   98741.2   95680.0     87616    114911      10489.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      3.1         27263458        704   38726.5   19984.0      3232    100543      34806.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.1         26990306         73  369730.2  358238.0    330335    426430      39391.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_tn_align4>(T1::Params)             
      2.7         23836588       1018   23415.1   13504.0      1760     95584      22012.7  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      2.5         21864154        193  113285.8  110880.0    108992    585277      34155.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      2.2         19661635        122  161160.9  154399.0    152704    183872      11115.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.2         19220005        124  155000.0  153487.0    120736    168319       7016.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.1         18694856        122  153236.5  153167.0    151743    155872        822.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      2.0         17928877        436   41121.3   18079.0      2336    147552      40772.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.0         17136491        192   89252.6   89280.0     87423     90367        496.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nn_align4>(T1::Params)             
      1.9         16309938         48  339790.4  339326.0    335518    366270       4095.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      1.7         14947285       1045   14303.6    6880.0      1600     68544      15818.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.7         14887864        100  148878.6  149871.0    117024    153343       6215.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      1.6         13765758        122  112834.1  110271.5    107136    125631       5743.4  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      1.5         13314496        121  110037.2  110079.0    104544    116064       2939.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      1.4         11895662        436   27283.6   12928.0      1952     96192      25933.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      1.3         11251142        585   19232.7    7776.0      1600     96128      25536.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.3         11117931         74  150242.3  150655.0    116159    152704       4087.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.9          8282389         75  110431.9  108672.0     85343    120288       5890.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.6          5700102         48  118752.1  118719.5    116160    119776        507.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.6          5392262         48  112338.8  112368.0    110591    113887        793.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_nt_align4>(T1::Params)              
      0.6          5160322         73   70689.3   70591.0     69568     72352        615.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.6          4983526         48  103823.5  103695.5    102784    105984        648.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.2          1706490        149   11453.0   11104.0      4480     14400       1408.7  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2          1525530         48   31781.9   31775.5     31136     32287        214.6  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.2          1429435         97   14736.4   14751.0     14272     15648        222.9  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.1          1286012        150    8573.4    8016.0      7232     38592       3304.5  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1          1209717         98   12344.1   12447.0      3008     13376        959.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1          1081598         96   11266.6   11376.0      9088     13440       1848.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           924122         48   19252.5   19248.0     18784     19808        199.0  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1           483645         49    9870.3    9920.0      7328     10528        443.2  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           367424         74    4965.2    4848.0      4320      5760        554.9  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0           319679        148    2160.0    2080.0      1920      2528        230.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           316926        149    2127.0    2112.0      1728      2976        274.8  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           217598         97    2243.3    2240.0      2080      2624         96.2  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0            31712          1   31712.0   31712.0     31712     31712          0.0  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0            12192          4    3048.0    3120.0      2752      3200        211.3  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0            10527          1   10527.0   10527.0     10527     10527          0.0  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0             7680          1    7680.0    7680.0      7680      7680          0.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0             7232          1    7232.0    7232.0      7232      7232          0.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0             3008          1    3008.0    3008.0      3008      3008          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0             2560          1    2560.0    2560.0      2560      2560          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0             2496          1    2496.0    2496.0      2496      2496          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0             2464          1    2464.0    2464.0      2464      2464          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0             2176          1    2176.0    2176.0      2176      2176          0.0  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0             1824          1    1824.0    1824.0      1824      1824          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     99.8       1650878892    436  3786419.5  2033974.5      1408  13553119    3546268.9  [CUDA memcpy Host-to-Device]  
      0.1          2133494     98    21770.3    21008.0     20352     94335       7410.0  [CUDA memcpy Device-to-Device]
      0.0           542684    435     1247.5     1056.0       992      2208        350.4  [CUDA memset]                 
      0.0             3616      1     3616.0     3616.0      3616      3616          0.0  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   7993.072    436    18.333    10.240     0.006    64.000       16.842  [CUDA memcpy Host-to-Device]  
   1335.398     98    13.627    13.107    13.107    64.000        5.141  [CUDA memcpy Device-to-Device]
      0.006    435     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000      1     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_512.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_512.sqlite
FAILED: xl_512 (likely OOM)
Profiling model_size=xl context_size=1024
device set to CUDA
MACHINE hpc
RUNNING SIZE xl, CONTEXT_SIZE: 1024
TRINING LOOP WITH:
vocab size 10000 context length 1024
model initialized
optimizer ready
it_id 0
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/i7h2l9sk[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_110919-i7h2l9sk/logs[0m
Collecting data...
Generating '/tmp/nsys-report-4f65.qdstrm'
[1/7] [0%                          ] auto_xl_1024.nsys-rep[1/7] [0%                          ] auto_xl_1024.nsys-rep[1/7] [9%                          ] auto_xl_1024.nsys-rep[1/7] [===========51%              ] auto_xl_1024.nsys-rep[1/7] [===========52%              ] auto_xl_1024.nsys-rep[1/7] [===========53%              ] auto_xl_1024.nsys-rep[1/7] [============54%             ] auto_xl_1024.nsys-rep[1/7] [============56%             ] auto_xl_1024.nsys-rep[1/7] [============57%             ] auto_xl_1024.nsys-rep[1/7] [=============58%            ] auto_xl_1024.nsys-rep[1/7] [==============61%           ] auto_xl_1024.nsys-rep[1/7] [==============62%           ] auto_xl_1024.nsys-rep[1/7] [==============64%           ] auto_xl_1024.nsys-rep[1/7] [===============65%          ] auto_xl_1024.nsys-rep[1/7] [===============66%          ] auto_xl_1024.nsys-rep[1/7] [===============67%          ] auto_xl_1024.nsys-rep[1/7] [================68%         ] auto_xl_1024.nsys-rep[1/7] [=================73%        ] auto_xl_1024.nsys-rep[1/7] [===================79%      ] auto_xl_1024.nsys-rep[1/7] [====================84%     ] auto_xl_1024.nsys-rep[1/7] [=====================89%    ] auto_xl_1024.nsys-rep[1/7] [======================90%   ] auto_xl_1024.nsys-rep[1/7] [=======================94%  ] auto_xl_1024.nsys-rep[1/7] [========================100%] auto_xl_1024.nsys-rep[1/7] [========================100%] auto_xl_1024.nsys-rep
[2/7] [0%                          ] auto_xl_1024.sqlite[2/7] [1%                          ] auto_xl_1024.sqlite[2/7] [2%                          ] auto_xl_1024.sqlite[2/7] [3%                          ] auto_xl_1024.sqlite[2/7] [4%                          ] auto_xl_1024.sqlite[2/7] [5%                          ] auto_xl_1024.sqlite[2/7] [6%                          ] auto_xl_1024.sqlite[2/7] [7%                          ] auto_xl_1024.sqlite[2/7] [8%                          ] auto_xl_1024.sqlite[2/7] [9%                          ] auto_xl_1024.sqlite[2/7] [10%                         ] auto_xl_1024.sqlite[2/7] [11%                         ] auto_xl_1024.sqlite[2/7] [12%                         ] auto_xl_1024.sqlite[2/7] [13%                         ] auto_xl_1024.sqlite[2/7] [14%                         ] auto_xl_1024.sqlite[2/7] [=15%                        ] auto_xl_1024.sqlite[2/7] [=16%                        ] auto_xl_1024.sqlite[2/7] [=17%                        ] auto_xl_1024.sqlite[2/7] [==18%                       ] auto_xl_1024.sqlite[2/7] [==19%                       ] auto_xl_1024.sqlite[2/7] [==20%                       ] auto_xl_1024.sqlite[2/7] [==21%                       ] auto_xl_1024.sqlite[2/7] [===22%                      ] auto_xl_1024.sqlite[2/7] [===23%                      ] auto_xl_1024.sqlite[2/7] [===24%                      ] auto_xl_1024.sqlite[2/7] [====25%                     ] auto_xl_1024.sqlite[2/7] [====26%                     ] auto_xl_1024.sqlite[2/7] [====27%                     ] auto_xl_1024.sqlite[2/7] [====28%                     ] auto_xl_1024.sqlite[2/7] [=====29%                    ] auto_xl_1024.sqlite[2/7] [=====30%                    ] auto_xl_1024.sqlite[2/7] [=====31%                    ] auto_xl_1024.sqlite[2/7] [=====32%                    ] auto_xl_1024.sqlite[2/7] [======33%                   ] auto_xl_1024.sqlite[2/7] [======34%                   ] auto_xl_1024.sqlite[2/7] [======35%                   ] auto_xl_1024.sqlite[2/7] [=======36%                  ] auto_xl_1024.sqlite[2/7] [=======37%                  ] auto_xl_1024.sqlite[2/7] [=======38%                  ] auto_xl_1024.sqlite[2/7] [=======39%                  ] auto_xl_1024.sqlite[2/7] [========40%                 ] auto_xl_1024.sqlite[2/7] [========41%                 ] auto_xl_1024.sqlite[2/7] [========42%                 ] auto_xl_1024.sqlite[2/7] [=========43%                ] auto_xl_1024.sqlite[2/7] [=========44%                ] auto_xl_1024.sqlite[2/7] [=========45%                ] auto_xl_1024.sqlite[2/7] [=========46%                ] auto_xl_1024.sqlite[2/7] [==========47%               ] auto_xl_1024.sqlite[2/7] [==========48%               ] auto_xl_1024.sqlite[2/7] [==========49%               ] auto_xl_1024.sqlite[2/7] [===========50%              ] auto_xl_1024.sqlite[2/7] [===========51%              ] auto_xl_1024.sqlite[2/7] [===========52%              ] auto_xl_1024.sqlite[2/7] [===========53%              ] auto_xl_1024.sqlite[2/7] [============54%             ] auto_xl_1024.sqlite[2/7] [============55%             ] auto_xl_1024.sqlite[2/7] [============56%             ] auto_xl_1024.sqlite[2/7] [============57%             ] auto_xl_1024.sqlite[2/7] [=============58%            ] auto_xl_1024.sqlite[2/7] [=============59%            ] auto_xl_1024.sqlite[2/7] [=============60%            ] auto_xl_1024.sqlite[2/7] [==============61%           ] auto_xl_1024.sqlite[2/7] [==============62%           ] auto_xl_1024.sqlite[2/7] [==============63%           ] auto_xl_1024.sqlite[2/7] [==============64%           ] auto_xl_1024.sqlite[2/7] [===============65%          ] auto_xl_1024.sqlite[2/7] [===============66%          ] auto_xl_1024.sqlite[2/7] [===============67%          ] auto_xl_1024.sqlite[2/7] [================68%         ] auto_xl_1024.sqlite[2/7] [================69%         ] auto_xl_1024.sqlite[2/7] [================70%         ] auto_xl_1024.sqlite[2/7] [================71%         ] auto_xl_1024.sqlite[2/7] [=================72%        ] auto_xl_1024.sqlite[2/7] [=================73%        ] auto_xl_1024.sqlite[2/7] [=================74%        ] auto_xl_1024.sqlite[2/7] [==================75%       ] auto_xl_1024.sqlite[2/7] [==================76%       ] auto_xl_1024.sqlite[2/7] [==================77%       ] auto_xl_1024.sqlite[2/7] [==================78%       ] auto_xl_1024.sqlite[2/7] [===================79%      ] auto_xl_1024.sqlite[2/7] [===================80%      ] auto_xl_1024.sqlite[2/7] [===================81%      ] auto_xl_1024.sqlite[2/7] [===================82%      ] auto_xl_1024.sqlite[2/7] [====================83%     ] auto_xl_1024.sqlite[2/7] [====================84%     ] auto_xl_1024.sqlite[2/7] [====================85%     ] auto_xl_1024.sqlite[2/7] [=====================86%    ] auto_xl_1024.sqlite[2/7] [=====================87%    ] auto_xl_1024.sqlite[2/7] [=====================88%    ] auto_xl_1024.sqlite[2/7] [=====================89%    ] auto_xl_1024.sqlite[2/7] [======================90%   ] auto_xl_1024.sqlite[2/7] [======================91%   ] auto_xl_1024.sqlite[2/7] [======================92%   ] auto_xl_1024.sqlite[2/7] [=======================93%  ] auto_xl_1024.sqlite[2/7] [=======================94%  ] auto_xl_1024.sqlite[2/7] [=======================95%  ] auto_xl_1024.sqlite[2/7] [=======================96%  ] auto_xl_1024.sqlite[2/7] [========================97% ] auto_xl_1024.sqlite[2/7] [========================98% ] auto_xl_1024.sqlite[2/7] [========================99% ] auto_xl_1024.sqlite[2/7] [========================100%] auto_xl_1024.sqlite[2/7] [========================100%] auto_xl_1024.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  --------
    100.0        777994586          1  777994586.0  777994586.0  777994586  777994586          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ----------  ---------  --------  --------  -----------  ------------------------
     81.2       1713673075        436   3930442.8  2216746.5      7486  13721941    3588510.3  cudaMemcpyAsync         
      8.6        181854198        990    183691.1     8087.5      5274  22390427    1492881.8  cudaLaunchKernel        
      4.8        101725169          5  20345033.8    75993.0     58931  98909546   43932802.9  cudaFree                
      2.9         60266991        369    163325.2   150121.0      5223   3451046     174455.1  cudaMalloc              
      1.2         25709302        436     58966.3    70142.0      8459     89757      26783.1  cudaStreamSynchronize   
      0.7         15824634          4   3956158.5  4707372.5   1280250   5129639    1795908.8  cuLibraryLoadData       
      0.2          5090385        184     27665.1     1206.0       677   4547820     335280.9  cuKernelGetFunction     
      0.1          2448287          2   1224143.5  1224143.5   1018803   1429484     290395.3  cudaGetDeviceProperties 
      0.1          2173622        184     11813.2    10845.5      7547     41512       4389.8  cuLaunchKernel          
      0.0           757403        370      2047.0     2100.5       475     15423        904.8  cudaStreamIsCapturing   
      0.0           201173         20     10058.6    10119.5      9332     10815        482.4  cudaMemsetAsync         
      0.0           196441        810       242.5      210.0       134      1236        108.0  cuGetProcAddress_v2     
      0.0            27357         18      1519.8      485.5       466     13698       3133.8  cudaEventCreateWithFlags
      0.0            21208          1     21208.0    21208.0     21208     21208          0.0  cudaMemGetInfo          
      0.0            10158          9      1128.7     1197.0       495      1790        487.5  cuLibraryGetKernel      
      0.0             7557          3      2519.0     2417.0      2313      2827        271.8  cuInit                  
      0.0             4427          3      1475.7      214.0       172      4041       2221.7  cuModuleGetLoadingMode  
      0.0             1794          2       897.0      897.0       621      1173        390.3  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     16.8         34679188         40  866979.7  866603.5    865084    869820       1199.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      8.8         18313062         83  220639.3  220575.0    217663    224223        824.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4>(T1::Params)             
      8.4         17430345         20  871517.3  871579.5    870331    872764        594.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4>(T1::Params)             
      7.5         15451731         20  772586.6  772460.5    771932    775196        688.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      7.0         14585944         20  729297.2  729100.5    727388    733084       1530.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.5         13431260        250   53725.0   57199.5     44383     59520       5630.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.4         13188926         20  659446.3  659165.0    658556    664029       1190.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.8         12098692         20  604934.6  604605.0    602397    608605       1848.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      5.8         11987397         20  599369.8  599405.0    597597    601597       1064.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      4.4          9100532         40  227513.3  227439.0    220287    235519       6546.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      4.4          9085491         21  432642.4  432510.0    428958    435998       1640.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      3.7          7675227         20  383761.3  383646.5    381598    385758       1259.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      3.3          6798015         20  339900.8  339870.5    338814    341406        660.6  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      3.0          6186435         20  309321.8  309391.0    303487    311199       1644.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      3.0          6121538        124   49367.2   49359.5     44320     54367       2835.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.1          4389926        124   35402.6   26832.0     26304     55135      12640.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      1.4          2868466         20  143423.3  143471.5    141887    145504       1083.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.7          1524762         41   37189.3   37024.0     36320     40672        664.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.5           975739         41   23798.5   23776.0     22623     24576        298.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2           507710         43   11807.2   10368.0      9696     76288      10076.4  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1           184127         21    8768.0    8768.0      8640      8992         79.0  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           114784         41    2799.6    2752.0      2656      3200        100.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.1           111424         42    2653.0    2592.0      2432      3424        202.5  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.1           103936         41    2535.0    2496.0      2464      2880         83.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0            61088         20    3054.4    2848.0      2400      3968        585.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      0.0             6976          2    3488.0    3488.0      3488      3488          0.0  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
    100.0       1652852969    436  3790947.2  2035478.0      1728  13534557    3550774.1  [CUDA memcpy Host-to-Device]
      0.0            48510     20     2425.5     2624.0      2144      2752        256.2  [CUDA memset]               

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
   7993.203    436    18.333    10.240     0.006    64.000       16.841  [CUDA memcpy Host-to-Device]
      0.017     20     0.001     0.001     0.001     0.001        0.000  [CUDA memset]               

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_1024.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_xl_1024.sqlite
FAILED: xl_1024 (likely OOM)
Profiling model_size=2.7B context_size=128
device set to CUDA
MACHINE hpc
RUNNING SIZE 2.7B, CONTEXT_SIZE: 128
TRINING LOOP WITH:
vocab size 10000 context length 128
model initialized
optimizer ready
it_id 0
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/zs48ofn2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_110953-zs48ofn2/logs[0m
Collecting data...
Generating '/tmp/nsys-report-0033.qdstrm'
[1/7] [0%                          ] auto_2.7B_128.nsys-rep[1/7] [0%                          ] auto_2.7B_128.nsys-rep[1/7] [======34%                   ] auto_2.7B_128.nsys-rep[1/7] [=========46%                ] auto_2.7B_128.nsys-rep[1/7] [===========51%              ] auto_2.7B_128.nsys-rep[1/7] [===========52%              ] auto_2.7B_128.nsys-rep[1/7] [===========53%              ] auto_2.7B_128.nsys-rep[1/7] [============54%             ] auto_2.7B_128.nsys-rep[1/7] [============55%             ] auto_2.7B_128.nsys-rep[1/7] [============56%             ] auto_2.7B_128.nsys-rep[1/7] [============57%             ] auto_2.7B_128.nsys-rep[1/7] [=============58%            ] auto_2.7B_128.nsys-rep[1/7] [=============59%            ] auto_2.7B_128.nsys-rep[1/7] [=============60%            ] auto_2.7B_128.nsys-rep[1/7] [==============61%           ] auto_2.7B_128.nsys-rep[1/7] [==============64%           ] auto_2.7B_128.nsys-rep[1/7] [================68%         ] auto_2.7B_128.nsys-rep[1/7] [=================72%        ] auto_2.7B_128.nsys-rep[1/7] [==================75%       ] auto_2.7B_128.nsys-rep[1/7] [===================79%      ] auto_2.7B_128.nsys-rep[1/7] [===================80%      ] auto_2.7B_128.nsys-rep[1/7] [====================83%     ] auto_2.7B_128.nsys-rep[1/7] [========================100%] auto_2.7B_128.nsys-rep[1/7] [========================100%] auto_2.7B_128.nsys-rep
[2/7] [0%                          ] auto_2.7B_128.sqlite[2/7] [1%                          ] auto_2.7B_128.sqlite[2/7] [2%                          ] auto_2.7B_128.sqlite[2/7] [3%                          ] auto_2.7B_128.sqlite[2/7] [4%                          ] auto_2.7B_128.sqlite[2/7] [5%                          ] auto_2.7B_128.sqlite[2/7] [6%                          ] auto_2.7B_128.sqlite[2/7] [7%                          ] auto_2.7B_128.sqlite[2/7] [8%                          ] auto_2.7B_128.sqlite[2/7] [9%                          ] auto_2.7B_128.sqlite[2/7] [10%                         ] auto_2.7B_128.sqlite[2/7] [11%                         ] auto_2.7B_128.sqlite[2/7] [12%                         ] auto_2.7B_128.sqlite[2/7] [13%                         ] auto_2.7B_128.sqlite[2/7] [14%                         ] auto_2.7B_128.sqlite[2/7] [=15%                        ] auto_2.7B_128.sqlite[2/7] [=16%                        ] auto_2.7B_128.sqlite[2/7] [=17%                        ] auto_2.7B_128.sqlite[2/7] [==18%                       ] auto_2.7B_128.sqlite[2/7] [==19%                       ] auto_2.7B_128.sqlite[2/7] [==20%                       ] auto_2.7B_128.sqlite[2/7] [==21%                       ] auto_2.7B_128.sqlite[2/7] [===22%                      ] auto_2.7B_128.sqlite[2/7] [===23%                      ] auto_2.7B_128.sqlite[2/7] [===24%                      ] auto_2.7B_128.sqlite[2/7] [====25%                     ] auto_2.7B_128.sqlite[2/7] [====26%                     ] auto_2.7B_128.sqlite[2/7] [====27%                     ] auto_2.7B_128.sqlite[2/7] [====28%                     ] auto_2.7B_128.sqlite[2/7] [=====29%                    ] auto_2.7B_128.sqlite[2/7] [=====30%                    ] auto_2.7B_128.sqlite[2/7] [=====31%                    ] auto_2.7B_128.sqlite[2/7] [=====32%                    ] auto_2.7B_128.sqlite[2/7] [======33%                   ] auto_2.7B_128.sqlite[2/7] [======34%                   ] auto_2.7B_128.sqlite[2/7] [======35%                   ] auto_2.7B_128.sqlite[2/7] [=======36%                  ] auto_2.7B_128.sqlite[2/7] [=======37%                  ] auto_2.7B_128.sqlite[2/7] [=======38%                  ] auto_2.7B_128.sqlite[2/7] [=======39%                  ] auto_2.7B_128.sqlite[2/7] [========40%                 ] auto_2.7B_128.sqlite[2/7] [========41%                 ] auto_2.7B_128.sqlite[2/7] [========42%                 ] auto_2.7B_128.sqlite[2/7] [=========43%                ] auto_2.7B_128.sqlite[2/7] [=========44%                ] auto_2.7B_128.sqlite[2/7] [=========45%                ] auto_2.7B_128.sqlite[2/7] [=========46%                ] auto_2.7B_128.sqlite[2/7] [==========47%               ] auto_2.7B_128.sqlite[2/7] [==========48%               ] auto_2.7B_128.sqlite[2/7] [==========49%               ] auto_2.7B_128.sqlite[2/7] [===========50%              ] auto_2.7B_128.sqlite[2/7] [===========51%              ] auto_2.7B_128.sqlite[2/7] [===========52%              ] auto_2.7B_128.sqlite[2/7] [===========53%              ] auto_2.7B_128.sqlite[2/7] [============54%             ] auto_2.7B_128.sqlite[2/7] [============55%             ] auto_2.7B_128.sqlite[2/7] [============56%             ] auto_2.7B_128.sqlite[2/7] [============57%             ] auto_2.7B_128.sqlite[2/7] [=============58%            ] auto_2.7B_128.sqlite[2/7] [=============59%            ] auto_2.7B_128.sqlite[2/7] [=============60%            ] auto_2.7B_128.sqlite[2/7] [==============61%           ] auto_2.7B_128.sqlite[2/7] [==============62%           ] auto_2.7B_128.sqlite[2/7] [==============63%           ] auto_2.7B_128.sqlite[2/7] [==============64%           ] auto_2.7B_128.sqlite[2/7] [===============65%          ] auto_2.7B_128.sqlite[2/7] [===============66%          ] auto_2.7B_128.sqlite[2/7] [===============67%          ] auto_2.7B_128.sqlite[2/7] [================68%         ] auto_2.7B_128.sqlite[2/7] [================69%         ] auto_2.7B_128.sqlite[2/7] [================70%         ] auto_2.7B_128.sqlite[2/7] [================71%         ] auto_2.7B_128.sqlite[2/7] [=================72%        ] auto_2.7B_128.sqlite[2/7] [=================73%        ] auto_2.7B_128.sqlite[2/7] [=================74%        ] auto_2.7B_128.sqlite[2/7] [==================75%       ] auto_2.7B_128.sqlite[2/7] [==================76%       ] auto_2.7B_128.sqlite[2/7] [==================77%       ] auto_2.7B_128.sqlite[2/7] [==================78%       ] auto_2.7B_128.sqlite[2/7] [===================79%      ] auto_2.7B_128.sqlite[2/7] [===================80%      ] auto_2.7B_128.sqlite[2/7] [===================81%      ] auto_2.7B_128.sqlite[2/7] [===================82%      ] auto_2.7B_128.sqlite[2/7] [====================83%     ] auto_2.7B_128.sqlite[2/7] [====================84%     ] auto_2.7B_128.sqlite[2/7] [====================85%     ] auto_2.7B_128.sqlite[2/7] [=====================86%    ] auto_2.7B_128.sqlite[2/7] [=====================87%    ] auto_2.7B_128.sqlite[2/7] [=====================88%    ] auto_2.7B_128.sqlite[2/7] [=====================89%    ] auto_2.7B_128.sqlite[2/7] [======================90%   ] auto_2.7B_128.sqlite[2/7] [======================91%   ] auto_2.7B_128.sqlite[2/7] [======================92%   ] auto_2.7B_128.sqlite[2/7] [=======================93%  ] auto_2.7B_128.sqlite[2/7] [=======================94%  ] auto_2.7B_128.sqlite[2/7] [=======================95%  ] auto_2.7B_128.sqlite[2/7] [=======================96%  ] auto_2.7B_128.sqlite[2/7] [========================97% ] auto_2.7B_128.sqlite[2/7] [========================98% ] auto_2.7B_128.sqlite[2/7] [========================99% ] auto_2.7B_128.sqlite[2/7] [========================100%] auto_2.7B_128.sqlite[2/7] [========================100%] auto_2.7B_128.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  --------
    100.0       1418326826          1  1418326826.0  1418326826.0  1418326826  1418326826          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     78.7       2897383865        359  8070707.1  5561406.0      8816  24369184    9012703.0  cudaMemcpyAsync         
     10.5        388003622       7771    49929.7     6228.0      4511  63301634     977054.7  cudaLaunchKernel        
      6.4        234115621        785   298236.5   163811.0      6444   3958818     678719.7  cudaMalloc              
      2.7        100147326        277   361542.7    66503.0      2486  78132510    4692297.7  cudaFree                
      0.6         20561463        293    70175.6    88136.0      7893    103945      33009.4  cudaStreamSynchronize   
      0.4         15621162          4  3905290.5  4666649.0   1255496   5032368    1776159.8  cuLibraryLoadData       
      0.2          8415019        867     9705.9     8045.0      5347     45841       4625.7  cuLaunchKernel          
      0.2          6109824        867     7047.1     1076.0       438   4565746     155204.1  cuKernelGetFunction     
      0.1          4668926          2  2334463.0  2334463.0   1427022   3241904    1283315.4  cudaGetDeviceProperties 
      0.0          1802601        323     5580.8     4140.0      3373     28843       3134.6  cudaMemsetAsync         
      0.0          1453298        783     1856.1     1800.0       483     24956       1247.0  cudaStreamIsCapturing   
      0.0          1189562          1  1189562.0  1189562.0   1189562   1189562          0.0  cudaHostAlloc           
      0.0           198030        810      244.5      213.0       136      1457        108.8  cuGetProcAddress_v2     
      0.0            48888         36     1358.0      485.5       471     14794       2635.4  cudaEventCreateWithFlags
      0.0            32385          1    32385.0    32385.0     32385     32385          0.0  cudaMemGetInfo          
      0.0            25825         13     1986.5     1362.0       572     11274       2823.9  cuLibraryGetKernel      
      0.0             7899          3     2633.0     2595.0      2118      3186        535.0  cuInit                  
      0.0             6089          3     2029.7      237.0       187      5665       3148.4  cuModuleGetLoadingMode  
      0.0             1790          2      895.0      895.0       526      1264        521.8  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     15.1         70804629       1497   47297.7    9120.0      1536    243390      76874.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     13.5         63107355       1026   61508.1   39776.0      1728    163263      61507.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
     12.2         56886259        609   93409.3   12480.0      7136    442429     141036.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      8.8         41181959        225  183030.9   88991.0     68160    317406     109878.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      6.7         31435578         97  324078.1  337631.0    293630    340446      20452.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      6.3         29677096       1064   27892.0   11664.0      3168    159519      42727.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.2         28979436        505   57385.0   32032.0      1824    160895      59070.3  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      4.0         18823649         65  289594.6  291551.0    227551    292831      11031.6  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      3.5         16248999        150  108326.7   65807.5      2624    244831      94251.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.2         15007087        455   32982.6   16992.0      3424     98207      34036.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.5         11691751        128   91341.8   91904.0     71744     92832       3457.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_nn_align4>(T1::Params)             
      2.5         11674723        128   91208.8   91231.5     83584     92864       1262.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x3_tn_align4>(T1::Params)             
      2.4         11441858        516   22174.1   10048.0      1632     48448      18620.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      2.3         10860423         32  339388.2  339310.5    337662    341343        750.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_nn_align4>(T1::Params)             
      2.3         10560492        216   48891.2   38912.0      1632    162207      60406.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      2.3         10538216        150   70254.8   41792.0      1920    161632      61875.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      2.2         10162449        401   25342.8   18048.0      1440     72384      26809.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      0.5          2377076        128   18570.9   17951.5     13760     21760       1492.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.3          1549367         32   48417.7   48063.5     47488     50240        775.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.3          1403416         64   21928.4   21888.0     17952     23264        757.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)               
      0.3          1359483         64   21241.9   20880.0     16224     22944       1150.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_nt_align4>(T1::Params)               
      0.3          1323737         65   20365.2   20480.0     15968     20863        796.5  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.3          1276507         64   19945.4   20112.0     16704     20768        660.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_64x64_16x6_tn_align4>(T1::Params)               
      0.2           979326         64   15302.0   15328.0     11840     15968        470.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2           900220         66   13639.7   13056.0     10144     36608       3703.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.2           865084         66   13107.3   13216.0      4768     13600       1092.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2           793278         32   24789.9   24768.0     24192     25280        245.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.2           786972         33   23847.6   23712.0     23168     28672        877.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.2           786552         68   11566.9   12816.0      6368     24735       3422.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.1           594330         32   18572.8   18688.0     14432     18848        758.3  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.1           581981         64    9093.5    9040.0      6336     10464        555.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.1           575387         66    8718.0    8672.0      2880     11232        998.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           465596         64    7274.9    6576.0      4864      8608       1101.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           462333         65    7112.8    7424.0      6144     18880       1611.9  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1           361214         32   11287.9   11360.0      8768     11584        465.4  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1           319711         33    9688.2    9248.0      8928     23424       2472.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.1           265760         33    8053.3    8128.0      6560      8352        395.8  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           149760         65    2304.0    2112.0      1632      3968        427.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0           136990         65    2107.5    2144.0      1728      2176         72.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           136159         32    4255.0    4256.0      4192      4288         25.0  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0           134112         65    2063.3    1952.0      1888      2752        180.0  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0            16320          1   16320.0   16320.0     16320     16320          0.0  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0             9024          1    9024.0    9024.0      9024      9024          0.0  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0             7136          1    7136.0    7136.0      7136      7136          0.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0             5952          2    2976.0    2976.0      2912      3040         90.5  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0             4768          1    4768.0    4768.0      4768      4768          0.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0             4416          1    4416.0    4416.0      4416      4416          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0             2848          1    2848.0    2848.0      2848      2848          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0             2592          1    2592.0    2592.0      2592      2592          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0             2304          1    2304.0    2304.0      2304      2304          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0             2176          1    2176.0    2176.0      2176      2176          0.0  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0             1824          1    1824.0    1824.0      1824      1824          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
    100.0       2859482559    292  9792748.5  5445428.0      1632  24223044    8996171.4  [CUDA memcpy Host-to-Device]  
      0.0           630908     66     9559.2     7456.0      5792    149151      17452.3  [CUDA memcpy Device-to-Device]
      0.0           566686    323     1754.4     1856.0      1056      3104        364.5  [CUDA memset]                 
      0.0             3648      1     3648.0     3648.0      3648      3648          0.0  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  13627.279    292    46.669    26.214     0.010   104.858       42.616  [CUDA memcpy Host-to-Device]  
    443.187     66     6.715     5.243     5.243   102.400       11.959  [CUDA memcpy Device-to-Device]
      0.016    323     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000      1     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_128.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_128.sqlite
FAILED: 2.7B_128 (likely OOM)
Profiling model_size=2.7B context_size=256
device set to CUDA
MACHINE hpc
RUNNING SIZE 2.7B, CONTEXT_SIZE: 256
TRINING LOOP WITH:
vocab size 10000 context length 256
model initialized
optimizer ready
it_id 0
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/xb5jlady[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_111039-xb5jlady/logs[0m
Collecting data...
Generating '/tmp/nsys-report-5382.qdstrm'
[1/7] [0%                          ] auto_2.7B_256.nsys-rep[1/7] [0%                          ] auto_2.7B_256.nsys-rep[1/7] [14%                         ] auto_2.7B_256.nsys-rep[1/7] [==========47%               ] auto_2.7B_256.nsys-rep[1/7] [===========51%              ] auto_2.7B_256.nsys-rep[1/7] [===========52%              ] auto_2.7B_256.nsys-rep[1/7] [===========53%              ] auto_2.7B_256.nsys-rep[1/7] [============54%             ] auto_2.7B_256.nsys-rep[1/7] [============55%             ] auto_2.7B_256.nsys-rep[1/7] [============56%             ] auto_2.7B_256.nsys-rep[1/7] [============57%             ] auto_2.7B_256.nsys-rep[1/7] [=============58%            ] auto_2.7B_256.nsys-rep[1/7] [=============60%            ] auto_2.7B_256.nsys-rep[1/7] [==============61%           ] auto_2.7B_256.nsys-rep[1/7] [==============62%           ] auto_2.7B_256.nsys-rep[1/7] [===============66%          ] auto_2.7B_256.nsys-rep[1/7] [================70%         ] auto_2.7B_256.nsys-rep[1/7] [=================73%        ] auto_2.7B_256.nsys-rep[1/7] [==================77%       ] auto_2.7B_256.nsys-rep[1/7] [===================80%      ] auto_2.7B_256.nsys-rep[1/7] [===================81%      ] auto_2.7B_256.nsys-rep[1/7] [====================84%     ] auto_2.7B_256.nsys-rep[1/7] [========================100%] auto_2.7B_256.nsys-rep[1/7] [========================100%] auto_2.7B_256.nsys-rep
[2/7] [0%                          ] auto_2.7B_256.sqlite[2/7] [1%                          ] auto_2.7B_256.sqlite[2/7] [2%                          ] auto_2.7B_256.sqlite[2/7] [3%                          ] auto_2.7B_256.sqlite[2/7] [4%                          ] auto_2.7B_256.sqlite[2/7] [5%                          ] auto_2.7B_256.sqlite[2/7] [6%                          ] auto_2.7B_256.sqlite[2/7] [7%                          ] auto_2.7B_256.sqlite[2/7] [8%                          ] auto_2.7B_256.sqlite[2/7] [9%                          ] auto_2.7B_256.sqlite[2/7] [10%                         ] auto_2.7B_256.sqlite[2/7] [11%                         ] auto_2.7B_256.sqlite[2/7] [12%                         ] auto_2.7B_256.sqlite[2/7] [13%                         ] auto_2.7B_256.sqlite[2/7] [14%                         ] auto_2.7B_256.sqlite[2/7] [=15%                        ] auto_2.7B_256.sqlite[2/7] [=16%                        ] auto_2.7B_256.sqlite[2/7] [=17%                        ] auto_2.7B_256.sqlite[2/7] [==18%                       ] auto_2.7B_256.sqlite[2/7] [==19%                       ] auto_2.7B_256.sqlite[2/7] [==20%                       ] auto_2.7B_256.sqlite[2/7] [==21%                       ] auto_2.7B_256.sqlite[2/7] [===22%                      ] auto_2.7B_256.sqlite[2/7] [===23%                      ] auto_2.7B_256.sqlite[2/7] [===24%                      ] auto_2.7B_256.sqlite[2/7] [====25%                     ] auto_2.7B_256.sqlite[2/7] [====26%                     ] auto_2.7B_256.sqlite[2/7] [====27%                     ] auto_2.7B_256.sqlite[2/7] [====28%                     ] auto_2.7B_256.sqlite[2/7] [=====29%                    ] auto_2.7B_256.sqlite[2/7] [=====30%                    ] auto_2.7B_256.sqlite[2/7] [=====31%                    ] auto_2.7B_256.sqlite[2/7] [=====32%                    ] auto_2.7B_256.sqlite[2/7] [======33%                   ] auto_2.7B_256.sqlite[2/7] [======34%                   ] auto_2.7B_256.sqlite[2/7] [======35%                   ] auto_2.7B_256.sqlite[2/7] [=======36%                  ] auto_2.7B_256.sqlite[2/7] [=======37%                  ] auto_2.7B_256.sqlite[2/7] [=======38%                  ] auto_2.7B_256.sqlite[2/7] [=======39%                  ] auto_2.7B_256.sqlite[2/7] [========40%                 ] auto_2.7B_256.sqlite[2/7] [========41%                 ] auto_2.7B_256.sqlite[2/7] [========42%                 ] auto_2.7B_256.sqlite[2/7] [=========43%                ] auto_2.7B_256.sqlite[2/7] [=========44%                ] auto_2.7B_256.sqlite[2/7] [=========45%                ] auto_2.7B_256.sqlite[2/7] [=========46%                ] auto_2.7B_256.sqlite[2/7] [==========47%               ] auto_2.7B_256.sqlite[2/7] [==========48%               ] auto_2.7B_256.sqlite[2/7] [==========49%               ] auto_2.7B_256.sqlite[2/7] [===========50%              ] auto_2.7B_256.sqlite[2/7] [===========51%              ] auto_2.7B_256.sqlite[2/7] [===========52%              ] auto_2.7B_256.sqlite[2/7] [===========53%              ] auto_2.7B_256.sqlite[2/7] [============54%             ] auto_2.7B_256.sqlite[2/7] [============55%             ] auto_2.7B_256.sqlite[2/7] [============56%             ] auto_2.7B_256.sqlite[2/7] [============57%             ] auto_2.7B_256.sqlite[2/7] [=============58%            ] auto_2.7B_256.sqlite[2/7] [=============59%            ] auto_2.7B_256.sqlite[2/7] [=============60%            ] auto_2.7B_256.sqlite[2/7] [==============61%           ] auto_2.7B_256.sqlite[2/7] [==============62%           ] auto_2.7B_256.sqlite[2/7] [==============63%           ] auto_2.7B_256.sqlite[2/7] [==============64%           ] auto_2.7B_256.sqlite[2/7] [===============65%          ] auto_2.7B_256.sqlite[2/7] [===============66%          ] auto_2.7B_256.sqlite[2/7] [===============67%          ] auto_2.7B_256.sqlite[2/7] [================68%         ] auto_2.7B_256.sqlite[2/7] [================69%         ] auto_2.7B_256.sqlite[2/7] [================70%         ] auto_2.7B_256.sqlite[2/7] [================71%         ] auto_2.7B_256.sqlite[2/7] [=================72%        ] auto_2.7B_256.sqlite[2/7] [=================73%        ] auto_2.7B_256.sqlite[2/7] [=================74%        ] auto_2.7B_256.sqlite[2/7] [==================75%       ] auto_2.7B_256.sqlite[2/7] [==================76%       ] auto_2.7B_256.sqlite[2/7] [==================77%       ] auto_2.7B_256.sqlite[2/7] [==================78%       ] auto_2.7B_256.sqlite[2/7] [===================79%      ] auto_2.7B_256.sqlite[2/7] [===================80%      ] auto_2.7B_256.sqlite[2/7] [===================81%      ] auto_2.7B_256.sqlite[2/7] [===================82%      ] auto_2.7B_256.sqlite[2/7] [====================83%     ] auto_2.7B_256.sqlite[2/7] [====================84%     ] auto_2.7B_256.sqlite[2/7] [====================85%     ] auto_2.7B_256.sqlite[2/7] [=====================86%    ] auto_2.7B_256.sqlite[2/7] [=====================87%    ] auto_2.7B_256.sqlite[2/7] [=====================88%    ] auto_2.7B_256.sqlite[2/7] [=====================89%    ] auto_2.7B_256.sqlite[2/7] [======================90%   ] auto_2.7B_256.sqlite[2/7] [======================91%   ] auto_2.7B_256.sqlite[2/7] [======================92%   ] auto_2.7B_256.sqlite[2/7] [=======================93%  ] auto_2.7B_256.sqlite[2/7] [=======================94%  ] auto_2.7B_256.sqlite[2/7] [=======================95%  ] auto_2.7B_256.sqlite[2/7] [=======================96%  ] auto_2.7B_256.sqlite[2/7] [========================97% ] auto_2.7B_256.sqlite[2/7] [========================98% ] auto_2.7B_256.sqlite[2/7] [========================99% ] auto_2.7B_256.sqlite[2/7] [========================100%] auto_2.7B_256.sqlite[2/7] [========================100%] auto_2.7B_256.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  --------
    100.0       1463938010          1  1463938010.0  1463938010.0  1463938010  1463938010          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     77.3       2900394382        359  8079093.0  5592264.0      8849  22470116    9020136.8  cudaMemcpyAsync         
     12.0        451392574       7379    61172.6     6632.0      4796  71680885    1297925.3  cudaLaunchKernel        
      6.9        257370464        846   304220.4   158432.0      6050   8296527     871732.2  cudaMalloc              
      2.1         80424623        213   377580.4    74947.0      2839  62318066    4267665.4  cudaFree                
      0.6         20771897        293    70893.8    88858.0      9176     96875      32958.1  cudaStreamSynchronize   
      0.4         15613371          4  3903342.8  4677061.5   1240689   5018559    1783371.2  cuLibraryLoadData       
      0.3          9857737        867    11369.9     8223.0      5290    290976      19262.0  cuLaunchKernel          
      0.2          6176664        867     7124.2     1111.0       457   4577024     155591.5  cuKernelGetFunction     
      0.1          4861910          2  2430955.0  2430955.0   1437055   3424855    1405586.9  cudaGetDeviceProperties 
      0.1          1893048        356     5317.6     4115.5      3248     19191       2268.1  cudaMemsetAsync         
      0.0          1774346        844     2102.3     2038.5       439     26091       1414.6  cudaStreamIsCapturing   
      0.0          1221032          1  1221032.0  1221032.0   1221032   1221032          0.0  cudaHostAlloc           
      0.0           226862        810      280.1      210.0       136     15611        699.3  cuGetProcAddress_v2     
      0.0            49391         36     1372.0      492.5       468     14407       2615.5  cudaEventCreateWithFlags
      0.0            32987          1    32987.0    32987.0     32987     32987          0.0  cudaMemGetInfo          
      0.0            16156         13     1242.8     1433.0       546      1774        459.6  cuLibraryGetKernel      
      0.0             6890          3     2296.7     2237.0      1968      2685        362.2  cuInit                  
      0.0             4386          3     1462.0      166.0       137      4083       2269.9  cuModuleGetLoadingMode  
      0.0             1883          2      941.5      941.5       542      1341        565.0  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     13.2         75560553        225  335824.7  172895.0    169951    641661     192992.1  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
     12.0         68407433       1399   48897.4   15552.0      1440    242814      74228.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
     10.7         60913499        225  270726.7  171263.0    131839    519645     150267.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nn_align4>(T1::Params)             
      9.5         54422798        880   61844.1   39760.0      1472    162271      61991.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      9.2         52483778        609   86180.3   21248.0     12576    430622     118455.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.0         34558502       1064   32479.8   17392.0      3296    159520      41163.2  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.8         33115310         65  509466.3  466781.0    464766    603069      63027.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_nt_align4>(T1::Params)             
      4.9         27768526        481   57730.8   32032.0      1792    163775      58629.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      4.7         27149654        516   52615.6   25760.0      1504     98175      37909.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.2         18051736        455   39674.1   26240.0      3200     98623      31738.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.9         16729768        128  130701.3  120831.5    119807    156095      15757.9  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x4_nt_align4>(T1::Params)             
      2.7         15311120         32  478472.5  440222.0    439038    564029      58044.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_16x5_nt_align4>(T1::Params)             
      2.4         13788577        125  110308.6   65952.0      2592    243295      94998.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      1.6          9197646        351   26204.1   18816.0      1600     73791      26345.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      1.6          9094352        126   72177.4   42096.0      1952    161311      62378.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorItera…
      1.6          8979948        191   47015.4   37791.0      1536    160895      60260.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      1.4          7946455        128   62081.7   61984.0     55295     70496       4347.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.6          3660966         64   57202.6   60160.0     50815     61344       4417.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.6          3596781         64   56199.7   55536.0     51871     59999       1748.5  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_nn_align4>(T1::Params)              
      0.6          3352018         66   50788.2   53024.0     44703     66784       4590.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.6          3336524         68   49066.5   48159.5     46848     62240       3177.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.6          3326414         64   51975.2   54239.0     46047     57248       4037.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      0.6          3245455         64   50710.2   50559.5     49632     53088        715.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.5          3004913         32   93903.5   93904.0     92224     95327        843.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_backward_kernel_cuda(at:…
      0.3          1909848         32   59682.8   59552.0     55008     65888       2579.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_nt_align4>(T1::Params)              
      0.3          1844405         32   57637.7   57632.0     57055     58432        379.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.3          1797111         32   56159.7   55007.5     53984     60640       2227.8  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_nt_align4>(T1::Params)              
      0.3          1793460         33   54347.3   54368.0     52704     54847        355.9  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      0.3          1586203         33   48066.8   47680.0     47104     58175       1872.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      0.2           884602         66   13403.1   13583.5      4992     13824       1069.4  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.1           853980         32   26686.9   24928.0     24608     31712       2998.8  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.1           830524         65   12777.3   11840.0     11424     15552       1549.9  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<float, at::native::func_wrapp…
      0.1           757629         66   11479.2   10656.0      3648     13920       1750.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           626911         64    9795.5   10080.0      7488     12832       1758.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           520476         32   16264.9   15295.5     15071     19103       1647.8  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.1           517949         65    7968.4    7872.0      6976     34591       3388.0  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1           320988         33    9726.9    9344.0      7968     11232        868.1  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           162143         32    5067.0    5056.0      5024      5120         26.5  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0           154303         65    2373.9    2272.0      1920      2656        169.3  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0           138336         65    2128.2    2144.0      2016      2176         34.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0           137536         65    2115.9    1984.0      1760      2848        254.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.0            27456          1   27456.0   27456.0     27456     27456          0.0  void <unnamed>::indexing_backward_kernel<float, (int)4>(const long *, const long *, const T1 *, T1 …
      0.0             9280          1    9280.0    9280.0      9280      9280          0.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0             9119          1    9119.0    9119.0      9119      9119          0.0  void at_cuda_detail::cub::DeviceRadixSortSingleTileKernel<at_cuda_detail::cub::DeviceRadixSortPolic…
      0.0             8000          1    8000.0    8000.0      8000      8000          0.0  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0             6815          2    3407.5    3407.5      3360      3455         67.2  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      0.0             3008          1    3008.0    3008.0      3008      3008          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0             2656          1    2656.0    2656.0      2656      2656          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::log_kernel_cuda(at::TensorIterat…
      0.0             2144          1    2144.0    2144.0      2144      2144          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<long, long, long, …
      0.0             2080          1    2080.0    2080.0      2080      2080          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, long, …
      0.0             2080          1    2080.0    2080.0      2080      2080          0.0  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.0             1728          1    1728.0    1728.0      1728      1728          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::reciprocal_kernel_cuda(at::Tenso…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ------------------------------
     99.9       2862477547    292  9803005.3  5452530.5      1984  22308712    9000536.2  [CUDA memcpy Host-to-Device]  
      0.0          1258263     66    19064.6    16960.0     15999    151007      16497.9  [CUDA memcpy Device-to-Device]
      0.0           637117    356     1789.7     1792.0       992      2816        358.3  [CUDA memset]                 
      0.0             3872      1     3872.0     3872.0      3872      3872          0.0  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  13627.320    292    46.669    26.214     0.010   104.858       42.616  [CUDA memcpy Host-to-Device]  
    783.974     66    11.878    10.486    10.486   102.400       11.314  [CUDA memcpy Device-to-Device]
      0.027    356     0.000     0.000     0.000     0.000        0.000  [CUDA memset]                 
      0.000      1     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Host]  

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_256.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_256.sqlite
FAILED: 2.7B_256 (likely OOM)
Profiling model_size=2.7B context_size=512
device set to CUDA
MACHINE hpc
RUNNING SIZE 2.7B, CONTEXT_SIZE: 512
TRINING LOOP WITH:
vocab size 10000 context length 512
model initialized
optimizer ready
it_id 0
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/ibhgw0i7[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_111125-ibhgw0i7/logs[0m
Collecting data...
Generating '/tmp/nsys-report-97ed.qdstrm'
[1/7] [0%                          ] auto_2.7B_512.nsys-rep[1/7] [0%                          ] auto_2.7B_512.nsys-rep[1/7] [9%                          ] auto_2.7B_512.nsys-rep[1/7] [==========47%               ] auto_2.7B_512.nsys-rep[1/7] [===========51%              ] auto_2.7B_512.nsys-rep[1/7] [===========52%              ] auto_2.7B_512.nsys-rep[1/7] [===========53%              ] auto_2.7B_512.nsys-rep[1/7] [============54%             ] auto_2.7B_512.nsys-rep[1/7] [============55%             ] auto_2.7B_512.nsys-rep[1/7] [============56%             ] auto_2.7B_512.nsys-rep[1/7] [============57%             ] auto_2.7B_512.nsys-rep[1/7] [=============58%            ] auto_2.7B_512.nsys-rep[1/7] [=============59%            ] auto_2.7B_512.nsys-rep[1/7] [=============60%            ] auto_2.7B_512.nsys-rep[1/7] [==============61%           ] auto_2.7B_512.nsys-rep[1/7] [==============62%           ] auto_2.7B_512.nsys-rep[1/7] [==============63%           ] auto_2.7B_512.nsys-rep[1/7] [==============64%           ] auto_2.7B_512.nsys-rep[1/7] [================69%         ] auto_2.7B_512.nsys-rep[1/7] [=================74%        ] auto_2.7B_512.nsys-rep[1/7] [===================79%      ] auto_2.7B_512.nsys-rep[1/7] [====================84%     ] auto_2.7B_512.nsys-rep[1/7] [=====================88%    ] auto_2.7B_512.nsys-rep[1/7] [=====================89%    ] auto_2.7B_512.nsys-rep[1/7] [=======================94%  ] auto_2.7B_512.nsys-rep[1/7] [========================100%] auto_2.7B_512.nsys-rep[1/7] [========================100%] auto_2.7B_512.nsys-rep
[2/7] [0%                          ] auto_2.7B_512.sqlite[2/7] [1%                          ] auto_2.7B_512.sqlite[2/7] [2%                          ] auto_2.7B_512.sqlite[2/7] [3%                          ] auto_2.7B_512.sqlite[2/7] [4%                          ] auto_2.7B_512.sqlite[2/7] [5%                          ] auto_2.7B_512.sqlite[2/7] [6%                          ] auto_2.7B_512.sqlite[2/7] [7%                          ] auto_2.7B_512.sqlite[2/7] [8%                          ] auto_2.7B_512.sqlite[2/7] [9%                          ] auto_2.7B_512.sqlite[2/7] [10%                         ] auto_2.7B_512.sqlite[2/7] [11%                         ] auto_2.7B_512.sqlite[2/7] [12%                         ] auto_2.7B_512.sqlite[2/7] [13%                         ] auto_2.7B_512.sqlite[2/7] [14%                         ] auto_2.7B_512.sqlite[2/7] [=15%                        ] auto_2.7B_512.sqlite[2/7] [=16%                        ] auto_2.7B_512.sqlite[2/7] [=17%                        ] auto_2.7B_512.sqlite[2/7] [==18%                       ] auto_2.7B_512.sqlite[2/7] [==19%                       ] auto_2.7B_512.sqlite[2/7] [==20%                       ] auto_2.7B_512.sqlite[2/7] [==21%                       ] auto_2.7B_512.sqlite[2/7] [===22%                      ] auto_2.7B_512.sqlite[2/7] [===23%                      ] auto_2.7B_512.sqlite[2/7] [===24%                      ] auto_2.7B_512.sqlite[2/7] [====25%                     ] auto_2.7B_512.sqlite[2/7] [====26%                     ] auto_2.7B_512.sqlite[2/7] [====27%                     ] auto_2.7B_512.sqlite[2/7] [====28%                     ] auto_2.7B_512.sqlite[2/7] [=====29%                    ] auto_2.7B_512.sqlite[2/7] [=====30%                    ] auto_2.7B_512.sqlite[2/7] [=====31%                    ] auto_2.7B_512.sqlite[2/7] [=====32%                    ] auto_2.7B_512.sqlite[2/7] [======33%                   ] auto_2.7B_512.sqlite[2/7] [======34%                   ] auto_2.7B_512.sqlite[2/7] [======35%                   ] auto_2.7B_512.sqlite[2/7] [=======36%                  ] auto_2.7B_512.sqlite[2/7] [=======37%                  ] auto_2.7B_512.sqlite[2/7] [=======38%                  ] auto_2.7B_512.sqlite[2/7] [=======39%                  ] auto_2.7B_512.sqlite[2/7] [========40%                 ] auto_2.7B_512.sqlite[2/7] [========41%                 ] auto_2.7B_512.sqlite[2/7] [========42%                 ] auto_2.7B_512.sqlite[2/7] [=========43%                ] auto_2.7B_512.sqlite[2/7] [=========44%                ] auto_2.7B_512.sqlite[2/7] [=========45%                ] auto_2.7B_512.sqlite[2/7] [=========46%                ] auto_2.7B_512.sqlite[2/7] [==========47%               ] auto_2.7B_512.sqlite[2/7] [==========48%               ] auto_2.7B_512.sqlite[2/7] [==========49%               ] auto_2.7B_512.sqlite[2/7] [===========50%              ] auto_2.7B_512.sqlite[2/7] [===========51%              ] auto_2.7B_512.sqlite[2/7] [===========52%              ] auto_2.7B_512.sqlite[2/7] [===========53%              ] auto_2.7B_512.sqlite[2/7] [============54%             ] auto_2.7B_512.sqlite[2/7] [============55%             ] auto_2.7B_512.sqlite[2/7] [============56%             ] auto_2.7B_512.sqlite[2/7] [============57%             ] auto_2.7B_512.sqlite[2/7] [=============58%            ] auto_2.7B_512.sqlite[2/7] [=============59%            ] auto_2.7B_512.sqlite[2/7] [=============60%            ] auto_2.7B_512.sqlite[2/7] [==============61%           ] auto_2.7B_512.sqlite[2/7] [==============62%           ] auto_2.7B_512.sqlite[2/7] [==============63%           ] auto_2.7B_512.sqlite[2/7] [==============64%           ] auto_2.7B_512.sqlite[2/7] [===============65%          ] auto_2.7B_512.sqlite[2/7] [===============66%          ] auto_2.7B_512.sqlite[2/7] [===============67%          ] auto_2.7B_512.sqlite[2/7] [================68%         ] auto_2.7B_512.sqlite[2/7] [================69%         ] auto_2.7B_512.sqlite[2/7] [================70%         ] auto_2.7B_512.sqlite[2/7] [================71%         ] auto_2.7B_512.sqlite[2/7] [=================72%        ] auto_2.7B_512.sqlite[2/7] [=================73%        ] auto_2.7B_512.sqlite[2/7] [=================74%        ] auto_2.7B_512.sqlite[2/7] [==================75%       ] auto_2.7B_512.sqlite[2/7] [==================76%       ] auto_2.7B_512.sqlite[2/7] [==================77%       ] auto_2.7B_512.sqlite[2/7] [==================78%       ] auto_2.7B_512.sqlite[2/7] [===================79%      ] auto_2.7B_512.sqlite[2/7] [===================80%      ] auto_2.7B_512.sqlite[2/7] [===================81%      ] auto_2.7B_512.sqlite[2/7] [===================82%      ] auto_2.7B_512.sqlite[2/7] [====================83%     ] auto_2.7B_512.sqlite[2/7] [====================84%     ] auto_2.7B_512.sqlite[2/7] [====================85%     ] auto_2.7B_512.sqlite[2/7] [=====================86%    ] auto_2.7B_512.sqlite[2/7] [=====================87%    ] auto_2.7B_512.sqlite[2/7] [=====================88%    ] auto_2.7B_512.sqlite[2/7] [=====================89%    ] auto_2.7B_512.sqlite[2/7] [======================90%   ] auto_2.7B_512.sqlite[2/7] [======================91%   ] auto_2.7B_512.sqlite[2/7] [======================92%   ] auto_2.7B_512.sqlite[2/7] [=======================93%  ] auto_2.7B_512.sqlite[2/7] [=======================94%  ] auto_2.7B_512.sqlite[2/7] [=======================95%  ] auto_2.7B_512.sqlite[2/7] [=======================96%  ] auto_2.7B_512.sqlite[2/7] [========================97% ] auto_2.7B_512.sqlite[2/7] [========================98% ] auto_2.7B_512.sqlite[2/7] [========================99% ] auto_2.7B_512.sqlite[2/7] [========================100%] auto_2.7B_512.sqlite[2/7] [========================100%] auto_2.7B_512.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  --------
    100.0        774936665          1  774936665.0  774936665.0  774936665  774936665          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)            Name          
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ------------------------
     89.1       2903315113        292  9942860.0  5610282.0      9289  23388137    9054179.5  cudaMemcpyAsync         
      5.5        178804482       1477   121059.2     8613.0      5501  21975963    1164046.5  cudaLaunchKernel        
      2.8         90500346        568   159331.6   155950.0      6939   1687197      68708.7  cudaMalloc              
      1.1         35466598          4  8866649.5  1351400.0     57545  32706253   15939152.8  cudaFree                
      0.6         20607164        292    70572.5    88213.0      6960    100114      33172.0  cudaStreamSynchronize   
      0.5         15847629          4  3961907.3  4740316.0   1287918   5079079    1791235.4  cuLibraryLoadData       
      0.2          5282497        274    19279.2     1316.5       784   4651653     281002.2  cuKernelGetFunction     
      0.1          4015597          2  2007798.5  2007798.5    875249   3140348    1601666.9  cudaGetDeviceProperties 
      0.1          3731602        274    13619.0    13119.5      7347     33492       4118.3  cuLaunchKernel          
      0.0          1193797        569     2098.1     1972.0       511     18940       1242.2  cudaStreamIsCapturing   
      0.0           195584        810      241.5      208.0       137      1272        111.3  cuGetProcAddress_v2     
      0.0            30686         18     1704.8      495.0       476     14200       3284.1  cudaEventCreateWithFlags
      0.0            21769          1    21769.0    21769.0     21769     21769          0.0  cudaMemGetInfo          
      0.0            10156          8     1269.5     1125.5       643      2028        632.0  cuLibraryGetKernel      
      0.0             7351          3     2450.3     2417.0      2388      2546         84.1  cuInit                  
      0.0             4199          3     1399.7      219.0       169      3811       2088.4  cuModuleGetLoadingMode  
      0.0             2088          2     1044.0     1044.0       645      1443        564.3  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)   Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  ---------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     28.2         61863798        153  404338.5   272702.0    217983   1002075     283909.7  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x128_32x5_tn_align4>(T1::Params)             
     27.1         59355650         60  989260.8  1009162.5    808732   1011450      60335.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
      7.3         16086084        370   43475.9    47167.5     32832     49728       5122.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.1         11140291         60  185671.5   185919.0    182303    189407       2366.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.4          7410233         30  247007.8   249919.0    219711    251742       9208.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.3          7138009        184   38793.5    41600.0     27712     44576       4721.6  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.2          7042044         31  227162.7   231167.0    199135    232575      10879.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.0          6504734         31  209830.1   211327.0    197695    213727       4551.3  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.8          6075678         31  195989.6   195871.0    194655    197631        822.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      2.7          5964608         31  192406.7   192255.0    191103    196479       1021.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      2.4          5164037         31  166581.8   168479.0    153439    170912       5023.3  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      2.2          4866342         30  162211.4   163071.5    153759    164480       2894.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_nn_align4>(T1::Params)              
      2.1          4681644        184   25443.7    18336.0     17536     41600      10441.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      2.0          4406854         31  142156.6   143743.0    130079    145023       4592.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      1.6          3565835         31  115026.9   115071.0    111103    116607       1188.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      1.6          3549838         30  118327.9   118351.5    117183    119455        590.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.7          1631671         61   26748.7    26752.0     24448     31808       1052.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.6          1336473         61   21909.4    22304.0     18464     22848       1176.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.3           648734         63   10297.4     9312.0      7648     57120       6052.9  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1           183327         31    5913.8     6079.0      4864      6240        395.8  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.1           164576         61    2698.0     2752.0      2144      3392        243.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.1           154432         62    2490.8     2480.0      1920      3296        244.1  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.1           147839         61    2423.6     2496.0      1984      2496        161.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0            78591         31    2535.2     2528.0      2112      3136        198.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      0.0             6240          2    3120.0     3120.0      3104      3136         22.6  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
    100.0       2866291016    292  9816065.1  5450195.0      1632  23217060    9018308.5  [CUDA memcpy Host-to-Device]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  13627.402    292    46.669    26.214     0.010   104.858       42.616  [CUDA memcpy Host-to-Device]

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_512.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_512.sqlite
FAILED: 2.7B_512 (likely OOM)
Profiling model_size=2.7B context_size=1024
device set to CUDA
MACHINE hpc
RUNNING SIZE 2.7B, CONTEXT_SIZE: 1024
TRINING LOOP WITH:
vocab size 10000 context length 1024
model initialized
optimizer ready
it_id 0
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mnsys_profiling[0m at: [34mhttps://wandb.ai/nd3032-new-york-university/assignment-2-hpc/runs/zm4k22s8[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260224_111211-zm4k22s8/logs[0m
Collecting data...
Generating '/tmp/nsys-report-8a16.qdstrm'
[1/7] [0%                          ] auto_2.7B_1024.nsys-rep[1/7] [0%                          ] auto_2.7B_1024.nsys-rep[1/7] [7%                          ] auto_2.7B_1024.nsys-rep[1/7] [===========51%              ] auto_2.7B_1024.nsys-rep[1/7] [===========52%              ] auto_2.7B_1024.nsys-rep[1/7] [===========53%              ] auto_2.7B_1024.nsys-rep[1/7] [============54%             ] auto_2.7B_1024.nsys-rep[1/7] [============56%             ] auto_2.7B_1024.nsys-rep[1/7] [=============58%            ] auto_2.7B_1024.nsys-rep[1/7] [=============60%            ] auto_2.7B_1024.nsys-rep[1/7] [==============61%           ] auto_2.7B_1024.nsys-rep[1/7] [==============63%           ] auto_2.7B_1024.nsys-rep[1/7] [==============64%           ] auto_2.7B_1024.nsys-rep[1/7] [===============65%          ] auto_2.7B_1024.nsys-rep[1/7] [===============66%          ] auto_2.7B_1024.nsys-rep[1/7] [===============67%          ] auto_2.7B_1024.nsys-rep[1/7] [================71%         ] auto_2.7B_1024.nsys-rep[1/7] [==================76%       ] auto_2.7B_1024.nsys-rep[1/7] [===================81%      ] auto_2.7B_1024.nsys-rep[1/7] [=====================86%    ] auto_2.7B_1024.nsys-rep[1/7] [======================90%   ] auto_2.7B_1024.nsys-rep[1/7] [======================92%   ] auto_2.7B_1024.nsys-rep[1/7] [=======================96%  ] auto_2.7B_1024.nsys-rep[1/7] [========================100%] auto_2.7B_1024.nsys-rep[1/7] [========================100%] auto_2.7B_1024.nsys-rep
[2/7] [0%                          ] auto_2.7B_1024.sqlite[2/7] [1%                          ] auto_2.7B_1024.sqlite[2/7] [2%                          ] auto_2.7B_1024.sqlite[2/7] [3%                          ] auto_2.7B_1024.sqlite[2/7] [4%                          ] auto_2.7B_1024.sqlite[2/7] [5%                          ] auto_2.7B_1024.sqlite[2/7] [6%                          ] auto_2.7B_1024.sqlite[2/7] [7%                          ] auto_2.7B_1024.sqlite[2/7] [8%                          ] auto_2.7B_1024.sqlite[2/7] [9%                          ] auto_2.7B_1024.sqlite[2/7] [10%                         ] auto_2.7B_1024.sqlite[2/7] [11%                         ] auto_2.7B_1024.sqlite[2/7] [12%                         ] auto_2.7B_1024.sqlite[2/7] [13%                         ] auto_2.7B_1024.sqlite[2/7] [14%                         ] auto_2.7B_1024.sqlite[2/7] [=15%                        ] auto_2.7B_1024.sqlite[2/7] [=16%                        ] auto_2.7B_1024.sqlite[2/7] [=17%                        ] auto_2.7B_1024.sqlite[2/7] [==18%                       ] auto_2.7B_1024.sqlite[2/7] [==19%                       ] auto_2.7B_1024.sqlite[2/7] [==20%                       ] auto_2.7B_1024.sqlite[2/7] [==21%                       ] auto_2.7B_1024.sqlite[2/7] [===22%                      ] auto_2.7B_1024.sqlite[2/7] [===23%                      ] auto_2.7B_1024.sqlite[2/7] [===24%                      ] auto_2.7B_1024.sqlite[2/7] [====25%                     ] auto_2.7B_1024.sqlite[2/7] [====26%                     ] auto_2.7B_1024.sqlite[2/7] [====27%                     ] auto_2.7B_1024.sqlite[2/7] [====28%                     ] auto_2.7B_1024.sqlite[2/7] [=====29%                    ] auto_2.7B_1024.sqlite[2/7] [=====30%                    ] auto_2.7B_1024.sqlite[2/7] [=====31%                    ] auto_2.7B_1024.sqlite[2/7] [=====32%                    ] auto_2.7B_1024.sqlite[2/7] [======33%                   ] auto_2.7B_1024.sqlite[2/7] [======34%                   ] auto_2.7B_1024.sqlite[2/7] [======35%                   ] auto_2.7B_1024.sqlite[2/7] [=======36%                  ] auto_2.7B_1024.sqlite[2/7] [=======37%                  ] auto_2.7B_1024.sqlite[2/7] [=======38%                  ] auto_2.7B_1024.sqlite[2/7] [=======39%                  ] auto_2.7B_1024.sqlite[2/7] [========40%                 ] auto_2.7B_1024.sqlite[2/7] [========41%                 ] auto_2.7B_1024.sqlite[2/7] [========42%                 ] auto_2.7B_1024.sqlite[2/7] [=========43%                ] auto_2.7B_1024.sqlite[2/7] [=========44%                ] auto_2.7B_1024.sqlite[2/7] [=========45%                ] auto_2.7B_1024.sqlite[2/7] [=========46%                ] auto_2.7B_1024.sqlite[2/7] [==========47%               ] auto_2.7B_1024.sqlite[2/7] [==========48%               ] auto_2.7B_1024.sqlite[2/7] [==========49%               ] auto_2.7B_1024.sqlite[2/7] [===========50%              ] auto_2.7B_1024.sqlite[2/7] [===========51%              ] auto_2.7B_1024.sqlite[2/7] [===========52%              ] auto_2.7B_1024.sqlite[2/7] [===========53%              ] auto_2.7B_1024.sqlite[2/7] [============54%             ] auto_2.7B_1024.sqlite[2/7] [============55%             ] auto_2.7B_1024.sqlite[2/7] [============56%             ] auto_2.7B_1024.sqlite[2/7] [============57%             ] auto_2.7B_1024.sqlite[2/7] [=============58%            ] auto_2.7B_1024.sqlite[2/7] [=============59%            ] auto_2.7B_1024.sqlite[2/7] [=============60%            ] auto_2.7B_1024.sqlite[2/7] [==============61%           ] auto_2.7B_1024.sqlite[2/7] [==============62%           ] auto_2.7B_1024.sqlite[2/7] [==============63%           ] auto_2.7B_1024.sqlite[2/7] [==============64%           ] auto_2.7B_1024.sqlite[2/7] [===============65%          ] auto_2.7B_1024.sqlite[2/7] [===============66%          ] auto_2.7B_1024.sqlite[2/7] [===============67%          ] auto_2.7B_1024.sqlite[2/7] [================68%         ] auto_2.7B_1024.sqlite[2/7] [================69%         ] auto_2.7B_1024.sqlite[2/7] [================70%         ] auto_2.7B_1024.sqlite[2/7] [================71%         ] auto_2.7B_1024.sqlite[2/7] [=================72%        ] auto_2.7B_1024.sqlite[2/7] [=================73%        ] auto_2.7B_1024.sqlite[2/7] [=================74%        ] auto_2.7B_1024.sqlite[2/7] [==================75%       ] auto_2.7B_1024.sqlite[2/7] [==================76%       ] auto_2.7B_1024.sqlite[2/7] [==================77%       ] auto_2.7B_1024.sqlite[2/7] [==================78%       ] auto_2.7B_1024.sqlite[2/7] [===================79%      ] auto_2.7B_1024.sqlite[2/7] [===================80%      ] auto_2.7B_1024.sqlite[2/7] [===================81%      ] auto_2.7B_1024.sqlite[2/7] [===================82%      ] auto_2.7B_1024.sqlite[2/7] [====================83%     ] auto_2.7B_1024.sqlite[2/7] [====================84%     ] auto_2.7B_1024.sqlite[2/7] [====================85%     ] auto_2.7B_1024.sqlite[2/7] [=====================86%    ] auto_2.7B_1024.sqlite[2/7] [=====================87%    ] auto_2.7B_1024.sqlite[2/7] [=====================88%    ] auto_2.7B_1024.sqlite[2/7] [=====================89%    ] auto_2.7B_1024.sqlite[2/7] [======================90%   ] auto_2.7B_1024.sqlite[2/7] [======================91%   ] auto_2.7B_1024.sqlite[2/7] [======================92%   ] auto_2.7B_1024.sqlite[2/7] [=======================93%  ] auto_2.7B_1024.sqlite[2/7] [=======================94%  ] auto_2.7B_1024.sqlite[2/7] [=======================95%  ] auto_2.7B_1024.sqlite[2/7] [=======================96%  ] auto_2.7B_1024.sqlite[2/7] [========================97% ] auto_2.7B_1024.sqlite[2/7] [========================98% ] auto_2.7B_1024.sqlite[2/7] [========================99% ] auto_2.7B_1024.sqlite[2/7] [========================100%] auto_2.7B_1024.sqlite[2/7] [========================100%] auto_2.7B_1024.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style    Range  
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  --------
    100.0        736469139          1  736469139.0  736469139.0  736469139  736469139          0.0  PushPop  :WARM_UP

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)   Med (ns)   Min (ns)  Max (ns)   StdDev (ns)            Name          
 --------  ---------------  ---------  ----------  ---------  --------  ---------  -----------  ------------------------
     88.1       2906253656        292   9952923.5  5617970.0      8754   22938588    9057864.7  cudaMemcpyAsync         
      5.1        168378348        563    299073.4     8239.0      5338   20996248    1865678.6  cudaLaunchKernel        
      3.5        116931546          6  19488591.0    82832.5     69913  114022313   46322854.1  cudaFree                
      1.9         61366152        376    163207.9   149840.5      6151    3724493     186352.1  cudaMalloc              
      0.6         20540254        292     70343.3    88148.0      8000     101827      32994.3  cudaStreamSynchronize   
      0.5         15820099          4   3955024.8  4737276.5   1258797    5086749    1807430.8  cuLibraryLoadData       
      0.2          5040552        103     48937.4     1278.0       961    4647069     457727.5  cuKernelGetFunction     
      0.1          2298472          2   1149236.0  1149236.0    864681    1433791     402421.5  cudaGetDeviceProperties 
      0.0          1453953        103     14116.0    15129.0      8004      28134       3627.0  cuLaunchKernel          
      0.0           887150        377      2353.2     2314.0       446      25075       1918.4  cudaStreamIsCapturing   
      0.0           194981        810       240.7      203.5       135       2430        131.9  cuGetProcAddress_v2     
      0.0            26513         18      1472.9      479.0       459      12845       2939.1  cudaEventCreateWithFlags
      0.0            22744          1     22744.0    22744.0     22744      22744          0.0  cudaMemGetInfo          
      0.0             8752          8      1094.0     1126.5       531       1601        463.0  cuLibraryGetKernel      
      0.0             6872          3      2290.7     2120.0      2024       2728        381.8  cuInit                  
      0.0             4000          3      1333.3      208.0       169       3623       1983.0  cuModuleGetLoadingMode  
      0.0             1678          2       839.0      839.0       562       1116        391.7  cudaGetDriverEntryPoint 

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     34.5         67855899         69   983418.8   512253.0    467486   2000598     698387.0  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x128_32x3_tn_align4>(T1::Params)             
     10.7         21041234         11  1912839.5  1912662.0   1911126   1918614       2051.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4>(T1::Params)             
      6.0         11845090        142    83416.1    89999.5     63680     91552      10024.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.7         11165477         12   930456.4   929851.0    929243    933819       1327.4  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.5         10881734         11   989248.5   987834.0    987354    993787       2339.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      5.2         10133740         12   844478.3   843676.0    842427    849980       2270.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      4.7          9266896         12   772241.3   772332.0    769852    773980       1241.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      4.3          8429588         11   766326.2   766460.0    764924    768156        986.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::exp_kernel_cuda(at::TensorIterat…
      4.1          8034072         22   365185.1   365182.5    361694    368862       2760.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      3.6          7059803         12   588316.9   588333.0    584221    594013       2654.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4>(T1::Params)              
      3.0          5938945         11   539904.1   539869.0    537821    543453       1610.2  void cutlass::Kernel2<cutlass_80_tensorop_s1688gemm_128x64_16x6_nn_align4>(T1::Params)              
      2.9          5634401         70    80491.4    80639.0     78271     81663        737.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      2.6          5123748         12   426979.0   426669.0    426014    429661       1006.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MaxOps<flo…
      2.2          4297032         11   390639.3   390430.0    386046    393501       2015.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      2.1          4085421         70    58363.2    43904.0     43328     90496      21600.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, std::arr…
      1.3          2622131         11   238375.5   238271.0    236863    240191        886.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.7          1417046         23    61610.7    61503.0     60543     64767        900.8  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.5          1033082         23    44916.6    44992.0     42431     47424       1184.7  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      0.2           353438         25    14137.5    10528.0      9696    106111      19167.8  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.1           105568         12     8797.3     8768.0      8640      8960         90.0  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0            65952         23     2867.5     2880.0      2208      3296        193.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, st…
      0.0            63232         24     2634.7     2592.0      2272      3360        222.0  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0            61248         23     2663.0     2688.0      2240      2880        111.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      0.0            32640         12     2720.0     2560.0      2400      3424        323.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, std::array<c…
      0.0             6272          2     3136.0     3136.0      3104      3168         45.3  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
    100.0       2869274562    292  9826282.7  5458083.0      1632  22774920    9020675.7  [CUDA memcpy Host-to-Device]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  13627.566    292    46.670    26.214     0.010   104.858       42.615  [CUDA memcpy Host-to-Device]

Generated:
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_1024.nsys-rep
	/scratch/nd3032/nyu-llm-reasoners-a2/nsight_log/auto_2.7B_1024.sqlite
FAILED: 2.7B_1024 (likely OOM)
